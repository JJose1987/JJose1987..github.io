/* JavaScript */
// Clases
class COBOL {
/* Constructor donde le pasamos los datos de entrada, para ello le pasamos el nombreparametro = VALUE */
    constructor(kwargs) {
        this.kwargs = {};
// Fechas de ejecución
        var now  = new Date().toISOString();
        var yyyy = now.substring(0,4);
        var yy   = now.substring(2,4);
        var mm   = now.substring(5,7);
        var dd   = now.substring(8,10);
        var hh   = (parseInt(now.substring(13,11), 10) + 2);
        var m    = now.substring(14,16);
        var ss   = now.substring(17,19);

        this.kwargs['date'] = []
        this.kwargs['date'][0] = dd + "-" + mm + "-" + yyyy;
        this.kwargs['date'][1] = yy + mm + dd + "-" + hh + m + ss;
        this.kwargs['date'][2] = dd + "/" + mm + "/" + yyyy;
        this.kwargs['date'][3] = dd + "/" + mm + "/" + yyyy + " - " + hh + ":" + m + ":" + ss;
// Indicamos que devolver programa, jcl o boleta
        if (typeof kwargs['type'] != "undefined") {
            this.kwargs['type'] = (kwargs['type']).toLowerCase();
            if (this.kwargs['type'] != "programa" && this.kwargs['type'] != "jcl" && this.kwargs['type'] != "boleta" && this.kwargs['type'] != "rutina" && this.kwargs['type'] != "online") {
                this.kwargs['type'] = "programa";
            }
        } else {
           this.kwargs['type'] = "programa";
        }
// Tipo de particion de de la tabla
        if (typeof kwargs['type_part'] != "undefined") {
            this.kwargs['type_part'] = (kwargs['type_part']).toLowerCase();
            if (this.kwargs['type_part'] != "npt" && this.kwargs['type_part'] != "spt") {
                this.kwargs['type_part'] = "npt";
            }
        } else {
           this.kwargs['type_part'] = "npt";
        }
// Comprueba si la boleta de carga
        if (typeof kwargs['carga'] != "undefined") {
            this.kwargs['carga'] = "1";

            if (this.kwargs['table'] != "TUUAA%%%") {
                this.kwargs['carga'] = (kwargs['carga'] == "0"?"0":"1");
            }
        } else {
            this.kwargs['carga'] = "1";
        }
// Nombre de la tabla en el programa
        if (typeof kwargs['table_rut'] != "undefined") {
            this.kwargs['table_rut'] = kwargs['table_rut'];

            if (this.kwargs['table_rut'].length == 8) {
                this.kwargs['table_rut'] = kwargs['table_rut'].toUpperCase();
            } else if (this.kwargs['table_rut'].length == 5) {
                this.kwargs['table_rut'] = this.kwargs['table_rut'].substring(0,5) + "%%%";
            } else {
                this.kwargs['table_rut'] = "TUUAA%%%";
            }
        } else {
            this.kwargs['table_rut'] = "TUUAA%%%";
        }
// Nombre de la tabla
        if (typeof kwargs['table'] != "undefined") {
            this.kwargs['table'] = kwargs['table'].toUpperCase();
            if (this.kwargs['table'].length == 8) {
                if ("TEYRGOSL|TEYRGGOP|TEYRGOGE|TEYRGPER|TEYRGHOP|TEYRGHTI|TEYRGOAN|TEYRGBIN|TEYRGGGO|TEYRGNBS|TEYRGNSR".indexOf(this.kwargs['table']) >= 0) {
                    this.kwargs['type_part'] = "spt";
                }
            } else if (this.kwargs['table'].length == 5) {
                this.kwargs['table'] = this.kwargs['table'].substring(0,5) + "%%%";
            } else {
                this.kwargs['table'] = "TUUAA%%%";
            }
            if (this.kwargs['type'] == "boleta") {
                kwargs['name'] = this.kwargs['table'].substring(1,5);
            }
        } else {
            this.kwargs['table'] = "TUUAA%%%";
        }
// Incluye el codigo para generar conversor de una tabla a otra
        if (typeof kwargs['conversor'] != "undefined") {
            if (this.kwargs['carga'] == "1" && "TEYRGOSL|TEYRGGOP|TEYRGGGO|TEYRGOAN|TEYRGHOP|TEYRGOGE|TEYRGBIN".indexOf(this.kwargs['table']) >= 0) {
                this.kwargs['conversor'] = (kwargs['conversor'] == "0"?"0":"1");
            } else {
                this.kwargs['conversor'] = "1";
            }
        } else {
            this.kwargs['conversor'] = "1";
        }
// Nombre liberia de la tabla
        if ("EYRG|ERCV|OORG|OODN|".indexOf(this.kwargs['table'].substring(1,5)) >= 0) {
            this.kwargs['lib_uuaa'] = "332";
        } else if ("GRDR".indexOf(this.kwargs['table'].substring(1,5)) >= 0) {
            this.kwargs['lib_uuaa'] = "343";
        } else if ("QPIP".indexOf(this.kwargs['table'].substring(1,5)) >= 0) {
            this.kwargs['lib_uuaa'] = "318";
        } else {
            this.kwargs['lib_uuaa'] = "%%%";
        }
// Nombre del elemento
        var letters = "1234567890QWERTYUIOPASDFGHJKLZXCVBNM";
        var p0 = Math.floor(Math.random() * (letters.length - 1));
        var p1 = Math.floor(Math.random() * (letters.length - 1));
        var p2 = Math.floor(Math.random() * (letters.length - 1));
        var name = letters.substring(p0, p0 + 1)
                 + letters.substring(p1, p1 + 1)
                 + letters.substring(p2, p2 + 1);

        if (typeof kwargs['name'] != "undefined") {
            this.kwargs['name'] = (kwargs['name']).toUpperCase();

            if (this.kwargs['name'].length == 4) {
                if (this.kwargs['type'] == "programa" || this.kwargs['type'] == "jcl") {
                    this.kwargs['name'] = (kwargs['name'] + this.control_UUAA(1) + name).toUpperCase();
                } else if (this.kwargs['type'] == "rutina") {
                    this.kwargs['name'] = (kwargs['name'] + "R" + name).toUpperCase();
                } else if (this.kwargs['type'] == "online") {
                    this.kwargs['name'] = (kwargs['name'] + "G" + name).toUpperCase();
                } else if (this.kwargs['type'] == "boleta") {
                    this.kwargs['name'] = (kwargs['name'] + "P" + name).toUpperCase();
                }
            } else if (this.kwargs['name'].length == 5) {
                this.kwargs['name'] = (kwargs['name'] + name).toUpperCase();
            } else if (this.kwargs['name'].length == 8) {
                if (this.kwargs['type'] == "jcl") {
                    this.kwargs['name'] = ((kwargs['name']).toUpperCase()).substring(0, 4) + "B" + ((kwargs['name']).toUpperCase()).substring(5);
                }
            } else {
                if (this.kwargs['type'] == "programa" || this.kwargs['type'] == "jcl") {
                    this.kwargs['name'] = "UUAAB" + name;
                } else if (this.kwargs['type'] == "rutina") {
                    this.kwargs['name'] = ("UUAAR" + name).toUpperCase();
                } else if (this.kwargs['type'] == "online") {
                    this.kwargs['name'] = ("UUAAG" + name).toUpperCase();
                } else if (this.kwargs['type'] == "boleta") {
                    this.kwargs['name'] = "UUAAP" + name;
                }
            }
        } else {
            if (this.kwargs['type'] == "programa" || this.kwargs['type'] == "jcl") {
                this.kwargs['name'] = "UUAAB" + name;
            } else if (this.kwargs['type'] == "rutina") {
                this.kwargs['name'] = ("UUAAR" + name).toUpperCase();
            } else if (this.kwargs['type'] == "online") {
                this.kwargs['name'] = ("UUAAG" + name).toUpperCase();
            } else if (this.kwargs['type'] == "boleta") {
                this.kwargs['name'] = "UUAAP" + name;
            }
        }
// Descripcion del elemento
        if (typeof kwargs['desc'] != "undefined") {
            this.kwargs['desc'] = ((((((kwargs['desc']).toUpperCase()).replace(/Á/g,"A")).replace(/É/g, "E")).replace(/Í/g, "I")).replace(/Ó/g, "O")).replace(/Ú/g, "U");
            this.adjust_text();
        } else {
            this.kwargs['desc'] = "";
        }
// Numero de ficheros de entrada
        if (typeof kwargs['fe'] != "undefined") {
            this.kwargs['fe'] = parseInt(kwargs['fe'], 10);
            if (isNaN(this.kwargs['fe']) || this.kwargs['type'] == "rutina" || this.kwargs['type'] == "online") {
                this.kwargs['fe'] = 0;
            }
        } else {
            this.kwargs['fe'] = 0;
        }
// Numero de ficheros de salida
        if (typeof kwargs['fs'] != "undefined") {
            this.kwargs['fs'] = parseInt(kwargs['fs'], 10);
            if (isNaN(this.kwargs['fs']) || this.kwargs['type'] == "rutina" || this.kwargs['type'] == "online") {
                this.kwargs['fs'] = 0;
            }
        } else {
            this.kwargs['fs'] = 0;
        }
// Tipo de cruce "", "11", "N1", "1N", "NM", "MN", "111"
        if (typeof kwargs['join'] != "undefined") {
            this.kwargs['join'] = (kwargs['join']).toUpperCase();

            if (this.kwargs['join'] != "" && this.kwargs['join'] != "11" && this.kwargs['join'] != "N1" && this.kwargs['join'] != "1N" && this.kwargs['join'] != "NM" && this.kwargs['join'] != "MN" && this.kwargs['join'] != "111") {
                this.kwargs['join'] = "";
            } else if (this.kwargs['join'] == "11" || this.kwargs['join'] == "N1" || this.kwargs['join'] == "1N" || this.kwargs['join'] == "NM" || this.kwargs['join'] == "MN") {
                if (this.kwargs['fe'] < 2) {
                    this.kwargs['fe'] = 2;
                }
            } else if (this.kwargs['join'] == "111") {
                if (this.kwargs['fe'] < 3) {
                    this.kwargs['fe'] = 3;
                }
            }
        } else {
            this.kwargs['join'] = "";
        }
// Descripciones de de ficheros de entrada
        if (typeof kwargs['fe_desc'] != "undefined") {
            this.kwargs['fe_desc'] = [];

            for (var i = 0; i < this.kwargs['fe']; i++) {
                if (typeof kwargs['fe_desc'][i] != "undefined" && kwargs['fe_desc'][i] != "") {
                    this.kwargs['fe_desc'][i] = (((((((kwargs['fe_desc'][i]).toUpperCase().substring(0,22))).replace(/Á/g,"A")).replace(/É/g, "E")).replace(/Í/g, "I")).replace(/Ó/g, "O")).replace(/Ú/g, "U");
                } else {
                    this.kwargs['fe_desc'][i] = "ENTRADA " + (i + 1);
                }
            }
        } else {
            this.kwargs['fe_desc'] = [];

            for (var i = 0; i < this.kwargs['fe']; i++) {
                this.kwargs['fe_desc'][i] = "ENTRADA " + (i + 1);
            }
        }
// Descripciones de de ficheros de salida
        if (typeof kwargs['fs_desc'] != "undefined") {
            this.kwargs['fs_desc'] = [];

            for (var i = 0; i < this.kwargs['fs']; i++) {
                if (typeof kwargs['fs_desc'][i] != "undefined" && kwargs['fs_desc'][i] != "") {
                    this.kwargs['fs_desc'][i] = (((((((kwargs['fs_desc'][i]).toUpperCase().substring(0,22))).replace(/Á/g,"A")).replace(/É/g, "E")).replace(/Í/g, "I")).replace(/Ó/g, "O")).replace(/Ú/g, "U");
                } else {
                    this.kwargs['fs_desc'][i] = "SALIDA " + (i + 1);
                }
            }
        } else {
            this.kwargs['fs_desc'] = []

            for (var i = 0; i < this.kwargs['fs']; i++) {
                this.kwargs['fs_desc'][i] = "SALIDA " + (i + 1);
            }
        }
// Longitud de los ficheros de entrada
        if (typeof kwargs['fe_length'] != "undefined") {
            this.kwargs['fe_length'] = [];

            for (var i = 0; i < this.kwargs['fe']; i++) {
                if (typeof kwargs['fe_length'][i] != "undefined") {
                    this.kwargs['fe_length'][i] = parseInt(kwargs['fe_length'][i], 10);
                    if (isNaN(this.kwargs['fe_length'][i])) {
                        this.kwargs['fe_length'][i] = 0;
                    } else if (this.kwargs['fe_length'][i] > 32760) {
                        this.kwargs['fe_length'][i] = 32760;
                    }
                } else {
                    this.kwargs['fe_length'][i] = 0;
                }
            }
        } else {
            this.kwargs['fe_length'] = []

            for (var i = 0; i < this.kwargs['fe']; i++) {
                this.kwargs['fe_length'][i] = 0;
            }
        }
// Longitud de los ficheros de salida
        if (typeof kwargs['fs_length'] != "undefined") {
            this.kwargs['fs_length'] = [];

            for (var i = 0; i < this.kwargs['fs']; i++) {
                if (typeof kwargs['fs_length'][i] != "undefined") {
                    this.kwargs['fs_length'][i] = parseInt(kwargs['fs_length'][i], 10);
                    if (isNaN(this.kwargs['fs_length'][i])) {
                        this.kwargs['fs_length'][i] = 0;
                    } else if (this.kwargs['fs_length'][i] > 32760) {
                        this.kwargs['fs_length'][i] = 32760;
                    }
                } else {
                    this.kwargs['fs_length'][i] = 0;
                }
            }
        } else {
            this.kwargs['fs_length'] = [];

            for (var i = 0; i < this.kwargs['fs']; i++) {
                this.kwargs['fs_length'][i] = 0;
            }
        }
// Nombres de las copy de entrada
        if (typeof kwargs['fe_copy'] != "undefined") {
            this.kwargs['fe_copy'] = [];

            for (var i = 0; i < this.kwargs['fe']; i++) {
                if (typeof kwargs['fe_copy'][i] != "undefined" && kwargs['fe_copy'][i] != "") {
                    this.kwargs['fe_copy'][i] = (kwargs['fe_copy'][i]).toUpperCase();
                } else {
                    this.kwargs['fe_copy'][i] = "UUAAC000";
                }
            }
        } else {
            this.kwargs['fe_copy'] = [];

            for (var i = 0; i < this.kwargs['fe']; i++) {
                this.kwargs['fe_copy'][i] = "UUAAC000";
            }
        }
// Nombres de las copy de salida
        if (typeof kwargs['fs_copy'] != "undefined") {
            this.kwargs['fs_copy'] = [];

            for (var i = 0; i < this.kwargs['fs']; i++) {
                if (typeof kwargs['fs_copy'][i] != "undefined" && kwargs['fs_copy'][i] != "") {
                    this.kwargs['fs_copy'][i] = (kwargs['fs_copy'][i]).toUpperCase();
                } else {
                    this.kwargs['fs_copy'][i] = "UUAAC000";
                }
            }
        } else {
            this.kwargs['fs_copy'] = [];

            for (var i = 0; i < this.kwargs['fs']; i++) {
                this.kwargs['fs_copy'][i] = "UUAAC000";
            }
        }
// Fichero variable en entrada
        if (typeof kwargs['fe_vf'] != "undefined") {
            this.kwargs['fe_vf'] = [];

            for (var i = 0; i < this.kwargs['fe']; i++) {
                this.kwargs['fe_vf'][i] = (kwargs['fe_vf'][i] == "0"?"0":"1");
            }
        } else {
            this.kwargs['fe_vf'] = [];

            for (var i = 0; i < this.kwargs['fe']; i++) {
                this.kwargs['fe_vf'][i] = "1";
            }
        }
// Indica el tipo de programa que es
        if (typeof kwargs['jcldb2'] != "undefined") {
            this.kwargs['jcldb2'] = (kwargs['jcldb2'] == "0"?"0":"1");
        } else {
            this.kwargs['jcldb2'] = "1";
        }
// Indica si el programa acumula valores según una clave
        if (typeof kwargs['accumulate'] != "undefined") {
            this.kwargs['media'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            this.kwargs['accumulate'] = (kwargs['accumulate'] == "0"?"0":"1")
            if (this.kwargs['accumulate'] == "0") {
                if (this.kwargs['fe'] == 0) {
                   this.kwargs['fe'] = 1;
                   this.kwargs['fe_length'][0] = 0;
                   this.kwargs['fe_copy'][0] = "UUAAC000";
                   this.kwargs['fe_desc'][0] = "ENTRADA 1";
                }
                if (this.kwargs['fs'] == 0) {
                   this.kwargs['fs'] = 1;
                   this.kwargs['fs_length'][0] = 0;
                   this.kwargs['fs_copy'][0] = "UUAAC000";
                   this.kwargs['fs_desc'][0] = "SALIDA 1";
                }
                kwargs['date_day'] = "0";

                this.kwargs['media'][i++] = "\n*"
                                          + "\n    05 SW-TIPO-VARIABLE     PIC S9(20)."
                                          + "\n        88 TIPO-IMP             VALUE 0."
                                          + "\n        88 TIPO-FEC             VALUE 0."
                                          + "\n        88 TIPO-POR             VALUE 0."
                                          + "\n        88 TIPO-COD             VALUE 0."
                                          + "\n        88 TIPO-QNU             VALUE 0.";
                this.kwargs['media'][i++] = "\n*"
                                          + "\n    05 CTN-MAX-IMP  PIC S9(20)V9(09) VALUE 999999999999999,99."
                                          + "\n    05 CTN-MAX-POR  PIC S9(20)V9(09) VALUE 999,999999999."
                                          + "\n    05 CTN-MAX-COD  PIC S9(20)       VALUE 9999999999."
                                          + "\n    05 CTN-MAX-QNU  PIC S9(20)       VALUE 9999999999."
                                          + "\n    05 CTN-90S      PIC S9(20)V9(09) VALUE 909090909090,00."
                                          + "\n    05 CTN-98S      PIC S9(20)V9(09) VALUE 989898989898,00."
                                          + "\n"
                                          + "\n    05 CTN-MAX-IND  PIC S9(20)       VALUE 0.";
                this.kwargs['media'][i++] = "\n*"
                                          + "\n    05 WS-IMP-AUX               PIC S9(15)V9(2)."
                                          + "\n    05 WS-POR-AUX               PIC S9(3)V9(9)."
                                          + "\n    05 WS-COD-AUX               PIC S9(10)."
                                          + "\n    05 WS-QNU-AUX               PIC S9(9)."
                                          + "\n"
                                          + "\n    05 WS-C01S                  PIC X(3000).";
                this.kwargs['media'][i++] = "\n*----------------------------------------------------------------*"
                                          + "\n*    -> CTN-MAX-IND NUMERO DE CAMPOS QUE SE VAN A SUMAR"
                                          + "\n*----------------------------------------------------------------*"
                                          + "\n*"
                                          + "\n 01 TABLA-TABLA-ACUM."
                                          + "\n*"
                                          + "\n*   02 TB-ACUM    OCCURS [CTN-MAX-IND] TIMES."
                                          + "\n    02 TB-ACUM    OCCURS 0 TIMES."
                                          + "\n        03 WS-ACUM          PIC S9(20)V9(09)."
                                          + "\n        03 WS-REG-VALIDOS   PIC S9(20)."
                                          + "\n*---"
                                          + "\n 01 TABLA-TABLA-BASE."
                                          + "\n*"
                                          + "\n*----------------------------------------------------------------*"
                                          + "\n* COPIAR LOS CAMPOS QUE SE VAN A SUMAR EN LA ENTRADA PERO SI"
                                          + "\n*   -> SI ES NUMERICO SE CONVIERTARIA A UN S9(20)V9(9)"
                                          + "\n*   -> SI ES UNA FECHA PASARA A SER UN X(10) MAS UN FILLER DE "
                                          + "\n*          X(19)"
                                          + "\n*----------------------------------------------------------------*"
                                          + "\n    02 TB-BASE-VALUES."
                                          + "\n        03 FILLER    PIC X(29)."
                                          + "\n*---"
                                          + "\n*"
                                          + "\n    02 TB-BASE  REDEFINES TB-BASE-VALUES OCCURS [CTN-MAX-IND] TIMES."
                                          + "\n    02 TB-BASE  REDEFINES TB-BASE-VALUES OCCURS 0 TIMES."
                                          + "\n        03 WS-BASE          PIC S9(20)V9(09)."
                                          + "\n        03 WS-FEC-BASE REDEFINES WS-BASE."
                                          + "\n            04 WS-FEC       PIC X(10)."
                                          + "\n            04 FILLER       PIC X(19).";
                this.kwargs['media'][i++] = "\n*"
                                          + "\n******************************************************************"
                                          + "\n* 200001-ACUMULAR"
                                          + "\n******************************************************************"
                                          + "\n 200001-ACUMULAR."
                                          + "\n*"
                                          + "\n     PERFORM VARYING WS-IND FROM CTN-1 BY CTN-1"
                                          + "\n               UNTIL WS-IND GREATER CTN-MAX-IND"
                                          + "\n"
                                          + "\n        MOVE WS-IND     TO SW-TIPO-VARIABLE"
                                          + "\n"
                                          + "\n        EVALUATE TRUE"
                                          + "\n            WHEN TIPO-IMP"
                                          + "\n                IF WS-BASE(WS-IND) NOT EQUAL CTN-90S AND CTN-98S"
                                          + "\n                    ADD CTN-1           TO WS-REG-VALIDOS(WS-IND)"
                                          + "\n                    ADD WS-BASE(WS-IND) TO WS-ACUM(WS-IND)"
                                          + "\n                END-IF"
                                          + "\n            WHEN TIPO-FEC"
                                          + "\n                MOVE WS-FEC(WS-IND) TO WS-X10-FECHA"
                                          + "\n                PERFORM 800000-FECHA-DIAS"
                                          + "\n                IF WS-DIAS NOT EQUAL ZEROS"
                                          + "\n                    ADD CTN-1           TO WS-REG-VALIDOS(WS-IND)"
                                          + "\n                    ADD WS-DIAS         TO WS-ACUM(WS-IND)"
                                          + "\n                END-IF"
                                          + "\n"
                                          + "\n            WHEN OTHER"
                                          + "\n                ADD CTN-1           TO WS-REG-VALIDOS(WS-IND)"
                                          + "\n                ADD WS-BASE(WS-IND) TO WS-ACUM(WS-IND)"
                                          + "\n        END-EVALUATE"
                                          + "\n     END-PERFORM"
                                          + "\n     ."
                                          + "\n*"
                                          + "\n******************************************************************"
                                          + "\n* 299999-INFORMAR-SALIDA"
                                          + "\n******************************************************************"
                                          + "\n 299999-INFORMAR-SALIDA."
                                          + "\n*"
                                          + "\n*    MOVE [...]          TO WS-IND"
                                          + "\n*"
                                          + "\n     PERFORM VARYING WS-IND FROM CTN-1 BY CTN-1"
                                          + "\n               UNTIL WS-IND GREATER CTN-MAX-IND"
                                          + "\n"
                                          + "\n        MOVE WS-IND         TO SW-TIPO-VARIABLE"
                                          + "\n"
                                          + "\n        MOVE ZEROS          TO WS-NUMBER"
                                          + "\n        IF WS-REG-VALIDOS(WS-IND) GREATER ZEROS"
                                          + "\n            COMPUTE WS-NUMBER = WS-ACUM(WS-IND)"
                                          + "\n                        / WS-REG-VALIDOS(WS-IND)"
                                          + "\n        END-IF"
                                          + "\n"
                                          + "\n        EVALUATE TRUE"
                                          + "\n            WHEN TIPO-IMP"
                                          + "\n                IF WS-NUMBER GREATER CTN-MAX-IMP"
                                          + "\n                    MOVE CTN-MAX-IMP    TO WS-NUMBER"
                                          + "\n                END-IF"
                                          + "\n                MOVE WS-NUMBER          TO WS-IMP-AUX"
                                          + "\n"
                                          + "\n                STRING WS-C01S WS-IMP-AUX(1:)"
                                          + "\n                    DELIMITED BY SPACES INTO WS-C01S"
                                          + "\n"
                                          + "\n            WHEN TIPO-FEC"
                                          + "\n                MOVE WS-NUMBER      TO WS-DIAS"
                                          + "\n                PERFORM 800000-DIAS-FECHA"
                                          + "\n                MOVE CORR WS-X08-FECHA     TO WS-X10-FECHA"
                                          + "\n"
                                          + "\n                STRING WS-C01S WS-X10-FECHA"
                                          + "\n                    DELIMITED BY SPACES INTO WS-C01S"
                                          + "\n"
                                          + "\n            WHEN TIPO-COD"
                                          + "\n                IF WS-NUMBER GREATER CTN-MAX-COD"
                                          + "\n                    MOVE CTN-MAX-COD    TO WS-NUMBER"
                                          + "\n                END-IF"
                                          + "\n                MOVE WS-NUMBER          TO WS-COD-AUX"
                                          + "\n"
                                          + "\n                STRING WS-C01S WS-COD-AUX(1:)"
                                          + "\n                    DELIMITED BY SPACES INTO WS-C01S"
                                          + "\n"
                                          + "\n            WHEN TIPO-QNU"
                                          + "\n                IF WS-NUMBER GREATER CTN-MAX-QNU"
                                          + "\n                    MOVE CTN-MAX-QNU    TO WS-NUMBER"
                                          + "\n                END-IF"
                                          + "\n                MOVE WS-NUMBER          TO WS-QNU-AUX"
                                          + "\n"
                                          + "\n                STRING WS-C01S WS-QNU-AUX(1:)"
                                          + "\n                    DELIMITED BY SPACES INTO WS-C01S"
                                          + "\n"
                                          + "\n            WHEN TIPO-POR"
                                          + "\n                IF WS-NUMBER GREATER CTN-MAX-POR"
                                          + "\n                    MOVE CTN-MAX-POR    TO WS-NUMBER"
                                          + "\n                END-IF"
                                          + "\n                MOVE WS-NUMBER          TO WS-POR-AUX"
                                          + "\n"
                                          + "\n                STRING WS-C01S WS-POR-AUX(1:)"
                                          + "\n                    DELIMITED BY SPACES INTO WS-C01S"
                                          + "\n"
                                          + "\n            WHEN OTHER"
                                          + "\n                STRING WS-C01S WS-NUMBER(1:)"
                                          + "\n                    DELIMITED BY SPACES INTO WS-C01S"
                                          + "\n"
                                          + "\n        END-EVALUATE"
                                          + "\n"
                                          + "\n     END-PERFORM"
                                          + "\n"
                                          + "\n*    MOVE WS-C01S       TO [...]"
                                          + "\n     .";
            }
        } else {
            this.kwargs['accumulate'] = "1";

            this.kwargs['media'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Convierte la fecha pasada a días
        if (typeof kwargs['date_day'] != "undefined") {
            this.kwargs['date_day'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['date_day'] == "0") {
                this.kwargs['date_day'][i++] = "\n*"
                                          + "\n    05 CTN-MAX-DD   PIC S9(20) VALUE 3067671."
                                          + "\n    05 CTN-MAX-FEC  PIC 9(08)  VALUE 99991231."
                                          + "\n    05 CTN-MIN-FEC  PIC 9(08)  VALUE 16001231."
                                          + "\n    05 CTN-INI-FEC  PIC 9(08)  VALUE 00010101."
                                          + "\n    05 CTN-11111111 PIC 9(08)  VALUE 11111111."
                                          + "\n    05 CTN-11111112 PIC 9(08)  VALUE 11111112.";
                this.kwargs['date_day'][i++] = "\n*"
                                          + "\n    05 WS-DIAS                  PIC S9(20)."
                                          + "\n    05 WS-908-FECHA             PIC 9(08).\n";
                this.kwargs['date_day'][i++] = "\n*"
                                          + "\n******************************************************************"
                                          + "\n* 800000-FECHA-DIAS"
                                          + "\n******************************************************************"
                                          + "\n 800000-FECHA-DIAS."
                                          + "\n*"
                                          + "\n*    MOVE [...]                 TO WS-X10-FECHA"
                                          + "\n     MOVE ZEROS                 TO WS-DIAS"
                                          + "\n"
                                          + "\n     IF WS-X10-FECHA NOT EQUAL SPACES"
                                          + "\n        MOVE CORR WS-X10-FECHA  TO WS-X08-FECHA"
                                          + "\n"
                                          + "\n        IF (WS-X08-FECHA NOT EQUAL CTN-11111111 AND CTN-11111112)"
                                          + "\n            AND (WS-X08-FECHA IS NUMERIC)"
                                          + "\n            AND (WS-X08-FECHA GREATER CTN-MIN-FEC)"
                                          + "\n"
                                          + "\n            MOVE WS-X08-FECHA   TO WS-908-FECHA"
                                          + "\n            COMPUTE WS-DIAS ="
                                          + "\n                           FUNCTION INTEGER-OF-DATE(WS-908-FECHA)"
                                          + "\n        END-IF"
                                          + "\n     END-IF"
                                          + "\n*    MOVE WS-DIAS               TO [...]"
                                          + "\n     ."
                                          + "\n*"
                                          + "\n******************************************************************"
                                          + "\n* 800000-DIAS-FECHA"
                                          + "\n******************************************************************"
                                          + "\n 800000-DIAS-FECHA."
                                          + "\n*"
                                          + "\n*    MOVE [...]                 TO WS-DIAS"
                                          + "\n     IF WS-DIAS EQUAL ZEROS"
                                          + "\n        MOVE CTN-INI-FEC        TO WS-X08-FECHA"
                                          + "\n     ELSE"
                                          + "\n        IF WS-DIAS GREATER CTN-MAX-DD"
                                          + "\n            MOVE CTN-MAX-FEC    TO WS-X08-FECHA"
                                          + "\n        ELSE"
                                          + "\n            COMPUTE WS-908-FECHA ="
                                          + "\n                                FUNCTION DATE-OF-INTEGER(WS-DIAS)"
                                          + "\n            MOVE WS-908-FECHA   TO WS-X08-FECHA"
                                          + "\n        END-IF"
                                          + "\n     END-IF"
                                          + "\n*    MOVE WS-X08-FECHA          TO [...]"
                                          + "\n     .";
            }
        } else {
            this.kwargs['date_day'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Para realizar busquedas
        if (typeof kwargs['lookfor'] != "undefined") {
            this.kwargs['lookfor'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['lookfor'] == "0") {
                if (this.kwargs['fe'] == 0) {
                   this.kwargs['fe'] = 1;
                }
                this.kwargs['fe_copy'][parseInt(this.kwargs['fe'], 10) - 1] = "EYRGC108";
                this.kwargs['fe_length'][parseInt(this.kwargs['fe'], 10) - 1] = "92";

                this.kwargs['lookfor'][i++] = "*\n    05 SW-ENCONTRADO                 PIC X(01).\n"
                                            + "        88 SI-ENCONTRADO                        VALUE 'S'.\n"
                                            + "        88 NO-ENCONTRADO                        VALUE 'N'.\n";

                this.kwargs['lookfor'][i++] = "    05 C-REG-TABPAR00                PIC S9(09).\n"

                this.kwargs['lookfor'][i++] = "\n    05 CTA-TABPAR00                  PIC X(08) VALUE 'TABPAR00'.\n"
                                            + "    05 CTA-DESBORDA                  PIC X(35) VALUE\n"
                                            + "       'DESBORDA PARAMETRIA DE LA ETIQUETA '.\n"

                this.kwargs['lookfor'][i++] = "\n 01 TABLA-TABLES.\n"
                                            + "*\n"
                                            + "    05 TB-TABPAR00-LENGTH    PIC 9(07) VALUE 9999999.\n"
                                            + "    05 TB-TABPAR00    OCCURS 9999999 TIMES.\n"
                                            + "        10 COD-VALORRUC         PIC X(25).\n"
                                            + "        10 COD-VALSAL           PIC X(25).\n"

                this.kwargs['lookfor'][i] = "     PERFORM 130000-CARGAR-TABPAR UNTIL SI-FIN-F{}nnE\n"
                this.kwargs['lookfor'][i] = this.kwargs['lookfor'][i].replace(/{}+/g, this.control_UUAA(1) + ((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?this.kwargs['name'].substring(5):""));
                this.kwargs['lookfor'][i] = this.kwargs['lookfor'][i].replace(/nn+/g, (this.kwargs['fe'] + "").padStart(((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?2:5),"0"));

                this.kwargs['lookfor'][++i] = "\n*\n"
                                            + "******************************************************************\n"
                                            + "* 130000-CARGAR-TABPAR\n"
                                            + "******************************************************************\n"
                                            + " 130000-CARGAR-TABPAR.\n"
                                            + "*\n"
                                            + "     IF NO-FIN-F{}nnE\n"
                                            + "         EVALUATE C108-COD-TABPAR OF CnnE\n"
                                            + "             WHEN CTA-TABPAR00\n"
                                            + "                 ADD  CTN-1         TO C-REG-TABPAR00\n"
                                            + "\n"
                                            + "                 IF C-REG-TABPAR00 GREATER TB-TABPAR00-LENGTH\n"
                                            + "                     SET  ERROR-DESBORDA  TO TRUE\n"
                                            + "                     STRING CTA-DESBORDA C108-COD-TABPAR OF CnnE\n"
                                            + "                    DELIMITED BY SIZE INTO DES-SQLCA-ERR-QPIPCCAB\n"
                                            + "\n"
                                            + "                     PERFORM 999999-FIN-ERROR\n"
                                            + "                 END-IF\n"
                                            + "*\n"
                                            + "                 MOVE C108-COD-VALORRUC\n"
                                            + "                   TO COD-VALORRUC OF TB-TABPAR00(C-REG-TABPAR00)\n"
                                            + "                 MOVE C108-COD-VALSAL\n"
                                            + "                   TO COD-VALSAL   OF TB-TABPAR00(C-REG-TABPAR00)\n"
                                            + "*\n"
                                            + "             WHEN OTHER\n"
                                            + "                 CONTINUE\n"
                                            + "         END-EVALUATE\n"
                                            + "     ELSE\n"
                                            + "*\n"
                                            + "         MOVE C-REG-TABPAR00        TO TB-TABPAR00-LENGTH\n"
                                            + "*\n"
                                            + "     END-IF\n"
                                            + "     PERFORM 500000-LEER-F{}nnE\n"
                                            + "     .";
                this.kwargs['lookfor'][i] = this.kwargs['lookfor'][i].replace(/{}+/g, this.control_UUAA(1) + ((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?this.kwargs['name'].substring(5):""));
                this.kwargs['lookfor'][i] = this.kwargs['lookfor'][i].replace(/nn+/g, (this.kwargs['fe'] + "").padStart(((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?2:5),"0"));

                this.kwargs['lookfor'][++i] = "\n*\n******************************************************************\n"
                                            + "* 899999-BUSCAR-TABPAR00\n"
                                            + "******************************************************************\n"
                                            + " 899999-BUSCAR-TABPAR00.\n"
                                            + "*\n"
                                            + "     SET  NO-ENCONTRADO                TO TRUE\n"
                                            + "\n"
                                            + "     PERFORM VARYING WS-IND FROM CTN-1 BY CTN-1\n"
                                            + "               UNTIL WS-IND GREATER TB-TABPAR00-LENGTH\n"
                                            + "                  OR SI-ENCONTRADO\n"
                                            + "        IF COD-VALORRUC OF TB-TABPAR00(WS-IND) EQUAL [...]\n"
                                            + "            SET  SI-ENCONTRADO   TO TRUE\n"
                                            + "            MOVE COD-VALSAL OF TB-TABPAR00(WS-IND) TO [...]\n"
                                            + "        END-IF\n"
                                            + "     END-PERFORM\n"
                                            + "     .\n"
                                            + "*";
            }
        } else {
            this.kwargs['lookfor'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Campos del informe
        if (typeof kwargs['copy_in'] != "undefined") {
            this.kwargs['copy_in'] = ((kwargs['copy_in']).toUpperCase()).replace(/  +/g, ' ');
            this.treatment_copy();
        } else {
            this.kwargs['copy_in'] = "";
            this.kwargs['copy_out'] = "";
            this.kwargs['headboard'] = "";
        }
// Pasar de cadena de numero y de numero a cadena
        if (typeof kwargs['to_number'] != "undefined") {
            this.kwargs['to_number'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['to_number'] == "0") {
                this.kwargs['to_number'][i++] = "\n    05 WS-STRING                PIC X(31) JUST RIGHT.\n"
                                            + "    05 WS-EDITED                PIC -Z(19)9(01),9(09).\n"
                                            + "    05 WS-EDITEC REDEFINES WS-EDITED PIC X(31).\n"
                                            + "    05 WS-EDITEP REDEFINES WS-EDITEC PIC -Z(19)9(01).9(09).\n";

                this.kwargs['to_number'][i++] = "\n******************************************************************\n"
                                            + "* 899999-PASAR-A-NUMERO\n"
                                            + "******************************************************************\n"
                                            + " 899999-PASAR-A-NUMERO.\n"
                                            + "*\n"
                                            + "*    MOVE [....]                             TO WS-STRING\n"
                                            + "     MOVE CTN-1                              TO WS-NUMBER\n"
                                            + "     MOVE ZEROS                              TO WS-IND\n"
                                            + "\n"
                                            + "     INSPECT WS-STRING TALLYING WS-IND FOR ALL '-'\n"
                                            + "                       REPLACING FIRST '-'   BY ZERO\n"
                                            + "\n"
                                            + "     INSPECT WS-STRING CONVERTING SPACE      TO ZERO\n"
                                            + "     INSPECT WS-STRING CONVERTING LOW-VALUE  TO ZERO\n"
                                            + "     INSPECT WS-STRING CONVERTING HIGH-VALUE TO ZERO\n"
                                            + "     INSPECT WS-STRING CONVERTING '.'        TO ','\n"
                                            + "     INSPECT WS-STRING(31:) CONVERTING '{ABCDEFGHI}JKLMNOPQR'\n"
                                            + "                               TO '01234567890123456789'\n"
                                            + "     IF WS-IND EQUAL CTN-1\n"
                                            + "        COMPUTE WS-NUMBER = CTN-N1\n"
                                            + "     END-IF\n"
                                            + "\n"
                                            + "     COMPUTE WS-NUMBER = \n"
                                            + "         (WS-NUMBER * FUNCTION NUMVAL-C(WS-STRING))\n"
                                            + "\n"
                                            + "     MOVE SPACES                             TO WS-STRING\n"
                                            + "*    MOVE  WS-NUMBER                         TO [....]\n"
                                            + "     .\n"
                                            + "*\n"
                                            + "******************************************************************\n"
                                            + "* 899999-PASAR-A-CADENA\n"
                                            + "*-----------------------------------------------------------------\n"
                                            + "* SE PUEDE PASAR A CUALQUIER FORMATO DE EDITADO SI SE JUEGA CON \n"
                                            + "* LAS SUBCADENAS DE COBOL, ES DECIR CON (#:#).\n"
                                            + "******************************************************************\n"
                                            + " 899999-PASAR-A-CADENA.\n"
                                            + "*\n"
                                            + "*    MOVE [....]                             TO WS-EDITED\n"
                                            + "     INSPECT WS-EDITEC CONVERTING ','        TO '.'\n"
                                            + "*    MOVE WS-EDITEP                          TO [....]\n"
                                            + "     .\n"
                                            + "*";
            }
        } else {
            this.kwargs['to_number'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Troceado
        if (typeof kwargs['chopped'] != "undefined") {
            this.kwargs['chopped'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['chopped'] == "0") {
                this.kwargs['chopped'][i++] = "\n    05 WS-STARTING-POINT       PIC 9(09).\n"
                                            + "    05 WS-LINEVALUE            PIC X(2500).\n"
                                            + "    05 WS-SET-CHAR             PIC X(0001).\n";

                this.kwargs['chopped'][i++] = " 01 TABLA-TABLA."
                                            + "\n*\n    05 TB-TABLE-COPY.\n"
                                            + "         10 TB-TBCPY-LENGTH      PIC 9(07) VALUE ZEROS.\n"
                                            + "         10 TB-TBCPY    OCCURS 9999999 TIMES.\n"
                                            + "            15 CAUX-LINEVALUE     PIC X(250).\n";

                this.kwargs['chopped'][i++] = "\n*\n"
                                            + "******************************************************************\n"
                                            + "* 899999-TROCEADO\n"
                                            + "******************************************************************\n"
                                            + " 899999-TROCEADO.\n"
                                            + "*\n"
                                            + "*    MOVE [...]                        TO WS-LINEVALUE\n"
                                            + "*    MOVE [...]                        TO WS-SET-CHAR\n"
                                            + "     INITIALIZE WS-IND\n"
                                            + "                TB-TABLE-COPY\n"
                                            + "\n"
                                            + "     MOVE CTN-1                        TO WS-STARTING-POINT\n"
                                            + "\n"
                                            + "     INSPECT WS-LINEVALUE \n"
                                            + "                 TALLYING TB-TBCPY-LENGTH FOR ALL WS-SET-CHAR\n"
                                            + "\n"
                                            + "     PERFORM VARYING WS-IND FROM CTN-1 BY CTN-1\n"
                                            + "               UNTIL WS-IND GREATER TB-TBCPY-LENGTH\n"
                                            + "\n"
                                            + "        UNSTRING WS-LINEVALUE DELIMITED BY WS-SET-CHAR\n"
                                            + "            INTO TB-TBCPY(WS-IND)\n"
                                            + "            WITH POINTER WS-STARTING-POINT\n"
                                            + "        END-UNSTRING\n"
                                            + "     END-PERFORM\n"
                                            + "     .";
            }
        } else {
            this.kwargs['chopped'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Obtener la fecha de cierre de mes
        if (typeof kwargs['qpiprx36'] != "undefined") {
            this.kwargs['qpiprx36'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['qpiprx36'] == "0") {
                this.kwargs['qpiprx36'][i++] = "\n    05 CTA-QPIPRX36                  PIC X(08) VALUE 'QPIPRX36'.";
                this.kwargs['qpiprx36'][i++] = "\n    05 CTN-3                         PIC S9(1) VALUE 3.";
                this.kwargs['qpiprx36'][i++] = "\n*-- COPY PARA EL CALCULO DE LA FECHA DE FIN DE MES PREVIO"
                                             + "\n COPY QPIPCX36.\n*";
                this.kwargs['qpiprx36'][i++] = "\n******************************************************************\n"
                                            + "* 800000-FIN-MES-PREVIO\n"
                                            + "******************************************************************\n"
                                            + " 800000-FIN-MES-PREVIO.\n"
                                            + "*\n"
                                            + "     INITIALIZE RETORNO-QPIPCCAB\n"
                                            + "                R-QPIPCX36\n"
                                            + "*\n"
                                            + "*    MOVE [...]                        TO WS-X08-FECHA\n"
                                            + "     MOVE CTN-4                        TO COD-SERVICIO-QPIPCCAB\n"
                                            + "     MOVE WS-X08-FECHA                 TO FEC-ENTRADA-QPIPCX36\n"
                                            + "*\n"
                                            + "     CALL CTA-QPIPRX36 USING R-QPIPCCAB R-QPIPCX36\n"
                                            + "*\n"
                                            + "     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES\n"
                                            + "        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR\n"
                                            + "*\n"
                                            + "        PERFORM 999999-FIN-ERROR\n"
                                            + "     END-IF\n"
                                            + "*\n"
                                            + "     MOVE FEC-MES-ANT-QPIPCX36         TO WS-X08-FECHA\n"
                                            + "     .\n"
                                            + "*\n******************************************************************\n"
                                            + "* 800000-FIN-MES-ACTUAL\n"
                                            + "******************************************************************\n"
                                            + " 800000-FIN-MES-ACTUAL.\n"
                                            + "*\n"
                                            + "     INITIALIZE RETORNO-QPIPCCAB\n"
                                            + "                R-QPIPCX36\n"
                                            + "*\n"
                                            + "*    MOVE [...]                        TO WS-X08-FECHA\n"
                                            + "     MOVE CTN-3                        TO COD-SERVICIO-QPIPCCAB\n"
                                            + "     MOVE WS-X08-FECHA                 TO FEC-ENTRADA-QPIPCX36\n"
                                            + "*\n"
                                            + "     CALL CTA-QPIPRX36 USING R-QPIPCCAB R-QPIPCX36\n"
                                            + "*\n"
                                            + "     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES\n"
                                            + "        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR\n"
                                            + "*\n"
                                            + "        PERFORM 999999-FIN-ERROR\n"
                                            + "     END-IF\n"
                                            + "*\n"
                                            + "     MOVE QNU-DIAS-MES-QPIPCX36        TO WS-DD OF WS-X08-FECHA\n"
                                            + "     .\n"
                                            + "*";
            }
        } else {
            this.kwargs['qpiprx36'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Sumar N meses a una fecha
        if (typeof kwargs['qpiprx37'] != "undefined") {
            this.kwargs['qpiprx37'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['qpiprx37'] == "0") {
                this.kwargs['qpiprx37'][i++] = "\n    05 CTA-QPIPRX37                  PIC X(08) VALUE 'QPIPRX37'.";
                this.kwargs['qpiprx37'][i++] = "\n    05 CTN-8                         PIC S9(1) VALUE 8.";
                this.kwargs['qpiprx37'][i++] = "\n    05 WS-QNU-MESES             PIC S9(9).";
                this.kwargs['qpiprx37'][i++] = "\n*-- COPY PARA LA SUMAR MESES A FECHAS"
                                             + "\n COPY QPIPCX37.\n*";
                this.kwargs['qpiprx37'][i++] = "\n******************************************************************\n"
                                            + "* 800000-SUMA-N-MESES\n"
                                            + "******************************************************************\n"
                                            + " 800000-SUMA-N-MESES.\n"
                                            + "*\n"
                                            + "     INITIALIZE RETORNO-QPIPCCAB\n"
                                            + "                R-QPIPCX37\n"
                                            + "*\n"
                                            + "*    MOVE [...]                        TO WS-QNU-MESES\n"
                                            + "*    MOVE [...]                        TO WS-X08-FECHA\n"
                                            + "     MOVE CTN-8                        TO COD-SERVICIO-QPIPCCAB\n"
                                            + "     MOVE WS-QNU-MESES                 TO QNU-MESES-QPIPCX37\n"
                                            + "     MOVE WS-X08-FECHA                 TO FEC-ENTRADA-QPIPCX37\n"
                                            + "*\n"
                                            + "     CALL CTA-QPIPRX37 USING R-QPIPCCAB R-QPIPCX37\n"
                                            + "*\n"
                                            + "     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES\n"
                                            + "        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR\n"
                                            + "*\n"
                                            + "        PERFORM 999999-FIN-ERROR\n"
                                            + "     END-IF\n"
                                            + "*\n"
                                            + "     MOVE FEC-SALIDA-QPIPCX37          TO WS-X08-FECHA\n"
                                            + "     .\n"
                                            + "*";
            }
        } else {
            this.kwargs['qpiprx37'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Validar fechas
        if (typeof kwargs['qpiprx38'] != "undefined") {
            this.kwargs['qpiprx38'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['qpiprx38'] == "0") {
                this.kwargs['qpiprx38'][i++] = "\n    05 SW-FECHA-VALIDADA             PIC X(01)."
                                            + "\n        88 OK                                   VALUE 'S'."
                                            + "\n        88 KO                                   VALUE 'N'.\n*";
                this.kwargs['qpiprx38'][i++] = "\n    05 CTA-QPIPRX38                  PIC X(08) VALUE 'QPIPRX38'.";
                this.kwargs['qpiprx38'][i++] = "\n*-- COPY PARA LA VALIDACION DE LA FECHA"
                                             + "\n COPY QPIPCX38.\n*";
                this.kwargs['qpiprx38'][i++] = "\n******************************************************************\n"
                                            + "* 800000-VALIDA-FECHA\n"
                                            + "******************************************************************\n"
                                            + " 800000-VALIDA-FECHA.\n"
                                            + "*\n"
                                            + "     INITIALIZE RETORNO-QPIPCCAB\n"
                                            + "                R-QPIPCX38\n"
                                            + "*\n"
                                            + "*    MOVE [...]                        TO WS-X08-FECHA\n"
                                            + "     MOVE CTN-1                        TO COD-SERVICIO-QPIPCCAB\n"
                                            + "     MOVE WS-X08-FECHA                 TO FEC-ENTGREG-QPIPCX38\n"
                                            + "     SET  OK OF SW-FECHA-VALIDADA      TO TRUE\n"
                                            + "*\n"
                                            + "     CALL CTA-QPIPRX38 USING R-QPIPCCAB R-QPIPCX38\n"
                                            + "*\n"
                                            + "     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES\n"
                                            + "        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR\n"
                                            + "        SET  KO OF SW-FECHA-VALIDADA       TO TRUE\n"
                                            + "*\n"
                                            + "*       PERFORM 999999-FIN-ERROR\n"
                                            + "     END-IF\n"
                                            + "     .\n"
                                            + "*";
            }
        } else {
            this.kwargs['qpiprx38'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Diferencia entre fechas
        if (typeof kwargs['qpiprx35'] != "undefined") {
            this.kwargs['qpiprx35'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['qpiprx35'] == "0") {
                this.kwargs['qpiprx35'][i++] = "\n    05 CTA-QPIPRX35                  PIC X(08) VALUE 'QPIPRX35'.";
                this.kwargs['qpiprx35'][i++] = "\n    05 CTN-5                         PIC S9(1) VALUE 5."
                                             + "\n    05 CTN-6                         PIC S9(1) VALUE 6.";
                this.kwargs['qpiprx35'][i++] = "\n    05 WS-DE-DIFERENCIA."
                                             + "\n        10 WS-AAAA              PIC 9(09)."
                                             + "\n        10 WS-MM                PIC 9(09)."
                                             + "\n        10 WS-DD                PIC 9(09)."
                                             + "\n    05 WS-X08-ENTRADA1."
                                             + "\n        10 WS-AAAA              PIC 9(04)."
                                             + "\n        10 WS-MM                PIC 9(02)."
                                             + "\n        10 WS-DD                PIC 9(02)."
                                             + "\n    05 WS-X08-ENTRADA2."
                                             + "\n        10 WS-AAAA              PIC 9(04)."
                                             + "\n        10 WS-MM                PIC 9(02)."
                                             + "\n        10 WS-DD                PIC 9(02).";
                this.kwargs['qpiprx35'][i++] = "\n*-- COPY PARA LA DIFERENCIA ENTRE DOS FECHAS"
                                             + "\n COPY QPIPCX35.\n*";
                this.kwargs['qpiprx35'][i++] = "\n******************************************************************\n"
                                            + "* 800000-DIFERENCIA-FECHAS\n"
                                            + "******************************************************************\n"
                                            + " 800000-DIFERENCIA-FECHA.\n"
                                            + "*\n"
                                            + "     INITIALIZE R-QPIPCX35\n"
                                            + "*\n"
                                            + "*    MOVE [...]                        TO WS-X08-ENTRADA1\n"
                                            + "*    MOVE [...]                        TO WS-X08-ENTRADA2\n"
                                            + "     MOVE WS-X08-ENTRADA1              TO FEC-ENTRADA1-QPIPCX35\n"
                                            + "     MOVE WS-X08-ENTRADA2              TO FEC-ENTRADA2-QPIPCX35\n"
                                            + "*\n"
                                            + "*-----\n"
                                            + "     INITIALIZE RETORNO-QPIPCCAB\n"
                                            + "     MOVE CTN-4                        TO COD-SERVICIO-QPIPCCAB\n"
                                            + "*\n"
                                            + "     CALL CTA-QPIPRX35 USING R-QPIPCCAB R-QPIPCX35\n"
                                            + "*\n"
                                            + "     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES\n"
                                            + "        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR\n"
                                            + "*\n"
                                            + "        PERFORM 999999-FIN-ERROR\n"
                                            + "     END-IF\n"
                                            + "*\n"
                                            + "     MOVE QNU-ANIOS-QPIPCX35     TO WS-AAAA OF WS-DE-DIFERENCIA\n"
                                            + "*\n"
                                            + "*-----\n"
                                            + "     INITIALIZE RETORNO-QPIPCCAB\n"
                                            + "     MOVE CTN-5                        TO COD-SERVICIO-QPIPCCAB\n"
                                            + "*\n"
                                            + "     CALL CTA-QPIPRX35 USING R-QPIPCCAB R-QPIPCX35\n"
                                            + "*\n"
                                            + "     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES\n"
                                            + "        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR\n"
                                            + "*\n"
                                            + "        PERFORM 999999-FIN-ERROR\n"
                                            + "     END-IF\n"
                                            + "*\n"
                                            + "     MOVE QNU-DIAS-QPIPCX35      TO WS-DD   OF WS-DE-DIFERENCIA\n"
                                            + "*\n"
                                            + "*-----\n"
                                            + "     INITIALIZE RETORNO-QPIPCCAB\n"
                                            + "     MOVE CTN-6                        TO COD-SERVICIO-QPIPCCAB\n"
                                            + "*\n"
                                            + "     CALL CTA-QPIPRX35 USING R-QPIPCCAB R-QPIPCX35\n"
                                            + "*\n"
                                            + "     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES\n"
                                            + "        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR\n"
                                            + "*\n"
                                            + "        PERFORM 999999-FIN-ERROR\n"
                                            + "     END-IF\n"
                                            + "*\n"
                                            + "     MOVE QNU-MESES-QPIPCX35     TO WS-MM   OF WS-DE-DIFERENCIA\n"
                                            + "     .\n"
                                            + "*";
            }
        } else {
            this.kwargs['qpiprx35'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Pasar cadena de texto a valores validos
        if (typeof kwargs['cadena_valida'] != "undefined") {
            this.kwargs['cadena_valida'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['cadena_valida'] == "0") {
                this.kwargs['cadena_valida'][i++] = "\n    05 CTN-255                 PIC 9(03) VALUE 255.";
                this.kwargs['cadena_valida'][i++] = "\n    05 WS-IND0                 PIC 9(09) VALUE ZEROS."
                                                  + "\n    05 WS-INSPECT              PIC X(255)."
                                                  + "\n    05 WS-CARACTER."
                                                  + "\n        10 FILLER PIC X(62) VALUE 'ABCÇDEFGHIJKLMNÑOPQRSTUVWXYZ012"
                                                  + "\n-           '3456789.<(+&$*);^-/|,%_>?:@=·{}'.";
                this.kwargs['cadena_valida'][i++] = "\n*"
                                                  + "\n******************************************************************"
                                                  + "\n* 899999-VALIDAR-CARACTERES"
                                                  + "\n******************************************************************"
                                                  + "\n 899999-VALIDAR-CARACTERES."
                                                  + "\n*"
                                                  + "\n*    MOVE [....]            TO WS-INSPECT"
                                                  + "\n     MOVE ZEROS             TO WS-IND0"
                                                  + "\n     INSPECT WS-INSPECT CONVERTING"
                                                  + "\n               \"áàäâãÁÀÄÂÃéèëêÉÈËÊíìïîÍÌÏÎóòöôõÓÒÖÔÕúùüûÚÙÜÛÇçñ\""
                                                  + "\n            TO \"AAAAAAAAAAEEEEEEEEIIIIIIIIOOOOOOOOOOUUUUUUUUCcÑ\""
                                                  + "\n*"
                                                  + "\n     MOVE FUNCTION UPPER-CASE(WS-INSPECT) TO WS-INSPECT"
                                                  + "\n*"
                                                  + "\n     PERFORM VARYING WS-IND FROM CTN-1 BY CTN-1"
                                                  + "\n               UNTIL WS-IND GREATER CTN-255"
                                                  + "\n                  OR WS-INSPECT(WS-IND:) EQUAL SPACES"
                                                  + "\n"
                                                  + "\n         INSPECT WS-CARACTER TALLYING WS-IND0"
                                                  + "\n                          FOR ALL WS-INSPECT(WS-IND:1)"
                                                  + "\n*"
                                                  + "\n         IF   WS-IND0                  EQUAL ZEROS"
                                                  + "\n          AND WS-INSPECT(WS-IND:1) NOT EQUAL QUOTE"
                                                  + "\n            MOVE SPACE      TO WS-INSPECT(WS-IND:1)"
                                                  + "\n         END-IF"
                                                  + "\n"
                                                  + "\n         MOVE ZEROS         TO WS-IND0"
                                                  + "\n     END-PERFORM"
                                                  + "\n*    MOVE WS-INSPECT        TO [....]"
                                                  + "\n     .";
            }
        } else {
            this.kwargs['cadena_valida'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Incluir el Rearranque
        if (typeof kwargs['rearranque'] != "undefined") {
            this.kwargs['rearranque'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['rearranque'] == "0") {
                if (this.kwargs['fe'] == 0) {
                   this.kwargs['fe'] = 1;
                   this.kwargs['fe_length'][0] = 0;
                   this.kwargs['fe_copy'][0] = "UUAAC000";
                   this.kwargs['fe_desc'][0] = "ENTRADA 1";
                }

                this.kwargs['rearranque'][i++] = "0";
                this.kwargs['rearranque'][i++] = "\n    05 CTA-QPBTRXEI                  PIC X(08) VALUE 'QPBTRXEI'."
                                               + "\n    05 CTA-QPBTRXEC                  PIC X(08) VALUE 'QPBTRXEC'."
                                               + "\n    05 CTA-QPBTRXEF                  PIC X(08) VALUE 'QPBTRXEF'.";
                this.kwargs['rearranque'][i++] = "\n    05 CTA-ERR-QPBTRXEI              PIC X(50) VALUE"
                                               + "\n      'ERROR EL CAMPO QNU-FREC ES MENOR O IGUAL A CEROS'."
                                               + "\n    05 CTA-EST-QPBTRXEI              PIC X(50) VALUE"
                                               + "\n       'EL VALOR DE COD-ESTADO ES ERRONEO'.";
                this.kwargs['rearranque'][i++] = "\n*"
                                               + "\n*-- COPY DE LA RUTINA DE REARRANQUE"
                                               + "\n COPY QPBTCXEC."
                                               + "\n COPY QPIPCMOD.";
                this.kwargs['rearranque'][i++] = "\n     PERFORM 499999-REARRANQUE-INICIO";
                this.kwargs['rearranque'][i++] = "\n*"
                                               + "\n     IF COD-ESTADO-QPBTCXEC EQUAL CTA-REARRANQUE-REPOSIC"
                                               + "\n        PERFORM 500000-LEER-F{}01E"
                                               + "\n          UNTIL WS-C01R EQUAL DES-INFO1-QPBTCXEC"
                                               + "\n             OR SI-FIN-F{}01E"
                                               + "\n     END-IF";
                this.kwargs['rearranque'][i++] = "PERFORM 499999-REARRANQUE-COMMIT";
                this.kwargs['rearranque'][i++] = "\n     PERFORM 499999-REARRANQUE-FINAL";
                this.kwargs['rearranque'][i++] = "\n*"
                                               + "\n******************************************************************"
                                               + "\n* 499999-REARRANQUE-INICIO"
                                               + "\n******************************************************************"
                                               + "\n 499999-REARRANQUE-INICIO."
                                               + "\n*"
                                               + "\n     INITIALIZE RETORNO-QPIPCCAB"
                                               + "\n"
                                               + "\n     MOVE R-QPIPCCAB            TO R-QPIPCMOD"
                                               + "\n     MOVE COD-PROGRAMA-QPIPCMOD TO COD-PROGRAMA-QPBTCXEC"
                                               + "\n"
                                               + "\n     CALL CTA-QPBTRXEI USING R-QPIPCMOD R-QPBTCXEC"
                                               + "\n"
                                               + "\n     MOVE RETORNO-QPIPCMOD   TO RETORNO-QPIPCCAB"
                                               + "\n"
                                               + "\n     IF XTI-AVIERROR-QPIPCMOD NOT EQUAL SPACES"
                                               + "\n        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR"
                                               + "\n"
                                               + "\n        PERFORM 999999-FIN-ERROR"
                                               + "\n     END-IF"
                                               + "\n"
                                               + "\n     IF QNU-FREC-QPBTCXEC LESS OR EQUAL ZEROES"
                                               + "\n        PERFORM 320000-CERRAR-FICHEROS"
                                               + "\n        MOVE XTI-AVIERROR-QPIPCCAB  TO SW-TIPO-ERROR"
                                               + "\n        MOVE CTA-499999-R           TO COD-PARRAFO-ERR-QPIPCCAB"
                                               + "\n        MOVE CTA-QPBTRXEI           TO COD-MODULO-ERR-QPIPCCAB"
                                               + "\n        MOVE CTA-ERR-QPBTRXEI       TO DES-SQLCA-ERR-QPIPCCAB"
                                               + "\n"
                                               + "\n        PERFORM 999999-FIN-ERROR"
                                               + "\n     END-IF"
                                               + "\n"
                                               + "\n     IF COD-ESTADO-QPBTCXEC NOT EQUAL CTA-ARRANQUE-LEER"
                                               + "\n        AND CTA-REARRANQUE-REPOSIC"
                                               + "\n"
                                               + "\n        PERFORM 320000-CERRAR-FICHEROS"
                                               + "\n        MOVE XTI-AVIERROR-QPIPCCAB  TO SW-TIPO-ERROR"
                                               + "\n        MOVE CTA-499999-R           TO COD-PARRAFO-ERR-QPIPCCAB"
                                               + "\n        MOVE CTA-QPBTRXEI           TO COD-MODULO-ERR-QPIPCCAB"
                                               + "\n        MOVE CTA-EST-QPBTRXEI       TO DES-SQLCA-ERR-QPIPCCAB"
                                               + "\n"
                                               + "\n        PERFORM 999999-FIN-ERROR"
                                               + "\n     END-IF"
                                               + "\n"
                                               + "\n     MOVE ZEROES                 TO QNU-PROCESAD-QPBTCXEC"
                                               + "\n     ."
                                               + "\n*"
                                               + "\n******************************************************************"
                                               + "\n* 499999-REARRANQUE-COMMIT"
                                               + "\n******************************************************************"
                                               + "\n 499999-REARRANQUE-COMMIT."
                                               + "\n*"
                                               + "\n     IF QNU-PROCESAD-QPBTCXEC GREATER OR EQUAL QNU-FREC-QPBTCXEC"
                                               + "\n        MOVE WS-C01R           TO DES-INFO1-QPBTCXEC"
                                               + "\n        MOVE SPACES            TO DES-INFO2-QPBTCXEC"
                                               + "\n"
                                               + "\n        CALL CTA-QPBTRXEC USING R-QPIPCMOD R-QPBTCXEC"
                                               + "\n"
                                               + "\n        MOVE RETORNO-QPIPCMOD  TO RETORNO-QPIPCCAB"
                                               + "\n"
                                               + "\n        IF XTI-AVIERROR-QPIPCMOD NOT EQUAL SPACES"
                                               + "\n            MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR"
                                               + "\n"
                                               + "\n            PERFORM 999999-FIN-ERROR"
                                               + "\n        END-IF"
                                               + "\n"
                                               + "\n        MOVE ZEROES     TO QNU-PROCESAD-QPBTCXEC"
                                               + "\n     END-IF"
                                               + "\n"
                                               + "\n     ADD  CTN-1         TO QNU-PROCESAD-QPBTCXEC"
                                               + "\n     ."
                                               + "\n*"
                                               + "\n******************************************************************"
                                               + "\n* 499999-REARRANQUE-FINAL"
                                               + "\n******************************************************************"
                                               + "\n 499999-REARRANQUE-FINAL."
                                               + "\n*"
                                               + "\n     MOVE SPACES            TO DES-INFO1-QPBTCXEC"
                                               + "\n     MOVE SPACES            TO DES-INFO2-QPBTCXEC"
                                               + "\n"
                                               + "\n     CALL CTA-QPBTRXEF USING R-QPIPCMOD R-QPBTCXEC"
                                               + "\n"
                                               + "\n     MOVE RETORNO-QPIPCMOD  TO RETORNO-QPIPCCAB"
                                               + "\n"
                                               + "\n     IF XTI-AVIERROR-QPIPCMOD NOT EQUAL SPACES"
                                               + "\n        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR"
                                               + "\n"
                                               + "\n        PERFORM 999999-FIN-ERROR"
                                               + "\n     END-IF"
                                               + "\n     .";
                this.kwargs['rearranque'][i++] = "0182,&OJOBNAME,&OCDATE,&CTIME,L"
            }
        } else {
            this.kwargs['rearranque'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Comparar dos ficheros iguales
        if (typeof kwargs['compare_files'] != "undefined") {
            this.kwargs['compare_files'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['compare_files'] == "0") {
                if (this.kwargs['fe'] < 2) {
                   this.kwargs['fe'] = 2;
                }
                if (this.kwargs['fs'] < 1) {
                   this.kwargs['fs'] = 1;
                }
                this.kwargs['join'] = "11";

                this.kwargs['compare_files'][i++] = "\n*"
                                                + "\n    05 SW-TIP-CAMPOS    PIC 9(09)."
                                                + "\n        88 NUMERICO         VALUE 0.";
                this.kwargs['compare_files'][i++] = "\n    05 CTA-1            PIC X(05) VALUE '1    '.";
                this.kwargs['compare_files'][i++] = "\n    05 CTN-100      PIC 9(03) VALUE 100."
                                                + "\n    05 CTN-999-99   PIC 9(03)V9(2) VALUE 999,99."
                                                + "\n    05 CTN-MAX-IND  PIC 9(09) VALUE 0."
                                                + "\n    05 CTN-90S      PIC 9(03)V9(02) VALUE 909,00."
                                                + "\n    05 CTN-98S      PIC 9(03)V9(02) VALUE 989,00.";
                this.kwargs['compare_files'][i++] = "\n*"
                                                + "\n*----- [COMPARAR VALORES]"
                                                + "\n    05 WS-NUMERO-ACT            PIC S9(20)V9(09)."
                                                + "\n    05 WS-NUMERO-ANT            PIC S9(20)V9(09)."
                                                + "\n"
                                                + "\n*----------------------------------------------------------------*"
                                                + "\n* COPIAR LOS CAMPOS QUE SE VAN A COMPARAR EN LA ENTRADA PERO SI"
                                                + "\n*   -> S9(20)V9(09) MAS UN FILLER DE X(01) SI ES NUMERICO"
                                                + "\n*   -> X(30) SI NO LO ES"
                                                + "\n*----------------------------------------------------------------*"
                                                + "\n    05 WS-CAMPOS-C00E."
                                                + "\n*       10 C00E-[]              PIC X(30)."
                                                + "\n*       10 C00E-[]              PIC S9(20)V9(9)."
                                                + "\n*       10 FILLER               PIC X(01)."
                                                + "\n"
                                                + "\n*----------------------------------------------------------------*"
                                                + "\n* COPIAR LOS CAMPOS QUE SE VAN A MOSTRAR EN LA SALIDA PERO SI"
                                                + "\n*   -> S9(03)V9(02) SI ES NUMERICO"
                                                + "\n*   -> 9(01) MAS UN FILLER DE X(04) SI NO LO ES"
                                                + "\n*----------------------------------------------------------------*"
                                                + "\n    05 WS-C01S."
                                                + "\n*       10 C00S-[]              PIC 9(01)."
                                                + "\n*       10 FILLER               PIC X(04)."
                                                + "\n*       10 C00S-[]              PIC S9(03)V9(02)."
                                                + "\n*-"
                                                + "\n*--";
                this.kwargs['compare_files'][i++] = "\n 01 TABLA-COMPARAR-FICHERO."
                                                + "\n*"
                                                + "\n    02 TABLA-ACTUAL."
                                                + "\n        05 TB-ACTUAL    OCCURS 1 TIMES."
                                                + "\n            10 TB-CAMPO-ALF         PIC X(30)."
                                                + "\n            10 TB-CAMPO-NUM REDEFINES TB-CAMPO-ALF."
                                                + "\n                15 TB-CAMPO-NUMERO  PIC S9(20)V9(9)."
                                                + "\n                15 FILLER           PIC X(1)."
                                                + "\n"
                                                + "\n    02 TABLA-ANTERIOR."
                                                + "\n        05 TB-ANTERIOR  OCCURS 1 TIMES."
                                                + "\n            10 TB-CAMPO-ALF         PIC X(30)."
                                                + "\n            10 TB-CAMPO-NUM REDEFINES TB-CAMPO-ALF."
                                                + "\n                15 TB-CAMPO-NUMERO  PIC S9(20)V9(9)."
                                                + "\n                15 FILLER           PIC X(1)."
                                                + "\n"
                                                + "\n    02 TABLA-RESULTADO."
                                                + "\n        05 TB-RESULTADO  OCCURS 1 TIMES."
                                                + "\n            10 TB-CAMPO-ALF         PIC X(05)."
                                                + "\n            10 TB-CAMPO-NUM REDEFINES TB-CAMPO-ALF."
                                                + "\n                15 TB-CAMPO-NUMERO  PIC S9(03)V9(2).";
                this.kwargs['compare_files'][i++] = "\n*"
                                                + "\n******************************************************************"
                                                + "\n* 299999-COMPARAR-CAMPOS"
                                                + "\n******************************************************************"
                                                + "\n 299999-COMPARAR-CAMPOS."
                                                + "\n*"
                                                + "\n     INITIALIZE TABLA-COMPARAR-FICHERO"
                                                + "\n"
                                                + "\n     MOVE CORR C01E         TO WS-CAMPOS-C00E"
                                                + "\n     MOVE WS-CAMPOS-C00E    TO TABLA-ACTUAL"
                                                + "\n"
                                                + "\n     MOVE CORR C02E         TO WS-CAMPOS-C00E"
                                                + "\n     MOVE WS-CAMPOS-C00E    TO TABLA-ANTERIOR"
                                                + "\n"
                                                + "\n     PERFORM VARYING WS-IND FROM CTN-1 BY CTN-1"
                                                + "\n               UNTIL WS-IND GREATER CTN-MAX-IND"
                                                + "\n*"
                                                + "\n        MOVE ZEROS              TO TB-RESULTADO(WS-IND)"
                                                + "\n"
                                                + "\n        IF TB-ACTUAL(WS-IND) NOT EQUAL TB-ANTERIOR(WS-IND)"
                                                + "\n"
                                                + "\n            MOVE WS-IND         TO SW-TIP-CAMPOS"
                                                + "\n"
                                                + "\n            IF NOT NUMERICO"
                                                + "\n"
                                                + "\n                MOVE CTA-1      TO TB-RESULTADO(WS-IND)"
                                                + "\n"
                                                + "\n            ELSE"
                                                + "\n"
                                                + "\n                MOVE TB-CAMPO-NUMERO OF TB-ACTUAL(WS-IND)"
                                                + "\n                    TO WS-NUMERO-ACT"
                                                + "\n                MOVE TB-CAMPO-NUMERO OF TB-ANTERIOR(WS-IND)"
                                                + "\n                    TO WS-NUMERO-ANT"
                                                + "\n"
                                                + "\n                IF (WS-NUMERO-ACT EQUAL CTN-90S OR CTN-98S"
                                                + "\n                      OR ZEROS)"
                                                + "\n                    MOVE CTN-999-99 "
                                                + "\n                      TO TB-CAMPO-NUMERO OF TB-RESULTADO(WS-IND)"
                                                + "\n                ELSE"
                                                + "\n                    IF (WS-NUMERO-ANT EQUAL CTN-90S OR CTN-98S)"
                                                + "\n                        MOVE ZEROS TO WS-NUMERO-ANT"
                                                + "\n                    END-IF"
                                                + "\n"
                                                + "\n                    COMPUTE TB-CAMPO-NUMERO"
                                                + "\n                                        OF TB-RESULTADO(WS-IND)"
                                                + "\n                     = ((WS-NUMERO-ACT - WS-NUMERO-ANT) * CTN-100)"
                                                + "\n                       / WS-NUMERO-ACT"
                                                + "\n                END-IF"
                                                + "\n            END-IF"
                                                + "\n        END-IF"
                                                + "\n*"
                                                + "\n     END-PERFORM"
                                                + "\n"
                                                + "\n     MOVE TABLA-RESULTADO       TO WS-C01S"
                                                + "\n     MOVE CORR WS-C01S          TO C01S"
                                                + "\n     .";
            }
        } else {
            this.kwargs['compare_files'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Salida con el número de registros
        if (typeof kwargs['record_counter'] != "undefined") {
            this.kwargs['record_counter'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['record_counter'] == "0") {
                if (this.kwargs['fe'] < 1) {
                    this.kwargs['fe'] = 1;
                    this.kwargs['fe_copy'][0] = "UUAAC000";
                    this.kwargs['fe_desc'][0] = "ENTRADA 1";
                    this.kwargs['fe_length'][0] = 0;
                }

                if (this.kwargs['fs'] < 1) {
                   this.kwargs['fs'] = 1;
                }

                this.kwargs['fs_copy'][parseInt(this.kwargs['fs'], 10) - 1] = "UUAAC000";
                this.kwargs['fs_desc'][parseInt(this.kwargs['fs'], 10) - 1] = "CONTADOR REGISTROS";
                this.kwargs['fs_length'][parseInt(this.kwargs['fs'], 10) - 1] = 20;

                this.kwargs['record_counter'][i] = "\n*"
                                                + "\n     IF SI-FIN-F{}01E"
                                                + "\n        PERFORM 600000-ESCRIBIR-F{}nnS"
                                                + "\n     END-IF";
                this.kwargs['record_counter'][i] = this.kwargs['record_counter'][i].replace(/{}+/g, this.control_UUAA(1) + ((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?this.kwargs['name'].substring(5):""));
                this.kwargs['record_counter'][i] = this.kwargs['record_counter'][i].replace(/nn+/g, (this.kwargs['fs'] + "").padStart(((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?2:5),"0"));
                i++;

                this.kwargs['record_counter'][i] = "\n*"
                                                + "\n     IF SI-FIN-F{}01E"
                                                + "\n        MOVE C-REG-F{}01E TO CnnS"
                                                + "\n        PERFORM 600000-ESCRIBIR-F{}nnS"
                                                + "\n     END-IF";
                this.kwargs['record_counter'][i] = this.kwargs['record_counter'][i].replace(/{}+/g, this.control_UUAA(1) + ((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?this.kwargs['name'].substring(5):""));
                this.kwargs['record_counter'][i] = this.kwargs['record_counter'][i].replace(/nn+/g, (this.kwargs['fs'] + "").padStart(((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?2:5),"0"));
            }
        } else {
            this.kwargs['record_counter'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Rutina para obtener la descripcion de la entidad
        if (typeof kwargs['kitcc030'] != "undefined") {
            this.kwargs['kitcc030'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['kitcc030'] == "0") {
                this.kwargs['jcldb2'] = "0"

                this.kwargs['kitcc030'][i++] = "\n    05 CTA-KITCR030                  PIC X(08) VALUE 'KITCR030'.";
                this.kwargs['kitcc030'][i++] = "\n    05 CTA-FALTA    PIC X(16) VALUE 'FALTA PARAMETRIA'.";
                this.kwargs['kitcc030'][i++] = "\n    05 WS-COD-ENTALFA       PIC X(04).";
                this.kwargs['kitcc030'][i++] = "\n*"
                                             + "\n* COPYS DE RUTINA DESCRIPCIONES ENTIDAD"
                                             + "\n COPY KITCC030.";
                this.kwargs['kitcc030'][i++] = "\n*"
                                             + "\n******************************************************************"
                                             + "\n* 800000-DESCRIPCION-ENTIDAD"
                                             + "\n******************************************************************"
                                             + "\n 800000-DESCRIPCION-ENTIDAD."
                                             + "\n*"
                                             + "\n     INITIALIZE RETORNO-QPIPCCAB"
                                             + "\n                R-KITCC030"
                                             + "\n*"
                                             + "\n*    MOVE [...]            TO WS-COD-ENTALFA"
                                             + "\n     MOVE WS-COD-ENTALFA   TO M030E-COD-ENTALFA"
                                             + "\n     MOVE 'ES'             TO M030E-COD-IDIOMTRA"
                                             + "\n*"
                                             + "\n     CALL CTA-KITCR030 USING R-QPIPCCAB R-KITCC030"
                                             + "\n*"
                                             + "\n     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES"
                                             + "\n        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR"
                                             + "\n*"
                                             + "\n        PERFORM 999999-FIN-ERROR"
                                             + "\n     END-IF"
                                             + "\n*"
                                             + "\n     IF M030S-DNOMCO EQUAL SPACES"
                                             + "\n        MOVE CTA-FALTA    TO M030S-DNOMCO"
                                             + "\n     END-IF"
                                             + "\n     .";
            }
        } else {
            this.kwargs['kitcc030'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Carga de parametros sin fichero de entrada
        if (typeof kwargs['lookforoutfile'] != "undefined") {
            this.kwargs['lookforoutfile'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['lookforoutfile'] == "0") {
                this.kwargs['lookforoutfile'][i++] = "*\n    05 SW-ENCONTRADO                 PIC X(01).\n"
                                                    + "        88 SI-ENCONTRADO                        VALUE 'S'.\n"
                                                    + "        88 NO-ENCONTRADO                        VALUE 'N'.\n";
                this.kwargs['lookforoutfile'][i++] = "\n 01 TABLA-TABLES.\n"
                                                    + "*\n"
                                                    + "    02 VALUE-TABLES.\n"
                                                    + "        03 FILLER PIC X(04) VALUE '0001'.\n"
                                                    + "\n"
                                                    + "    02 TB-TABLES REDEFINES VALUE-TABLES OCCURS 1 TIMES.\n"
                                                    + "        03 COD-VALORRUC     PIC 9(02).\n"
                                                    + "        03 COD-VALSAL       PIC 9(02).\n"
                                                    + "\n"
                                                    + "    02 TB-TABLES-LENGTH    PIC 9(04) VALUE 1.\n";
                this.kwargs['lookforoutfile'][i++] = "\n*\n"
                                                    + "******************************************************************\n"
                                                    + "* 899999-BUSCAR\n"
                                                    + "******************************************************************\n"
                                                    + " 899999-BUSCAR.\n"
                                                    + "*\n"
                                                    + "     SET  NO-ENCONTRADO             TO TRUE\n"
                                                    + "\n"
                                                    + "     PERFORM VARYING WS-IND FROM CTN-1 BY CTN-1\n"
                                                    + "               UNTIL WS-IND GREATER TB-TABLES-LENGTH\n"
                                                    + "                  OR SI-ENCONTRADO\n"
                                                    + "\n"
                                                    + "        IF COD-VALORRUC(WS-IND) EQUAL [...]\n"
                                                    + "            SET  SI-ENCONTRADO   TO TRUE\n"
                                                    + "            MOVE COD-VALSAL(WS-IND) TO [...]\n"
                                                    + "        END-IF\n"
                                                    + "     END-PERFORM\n"
                                                    + "     .";
            }
        } else {
            this.kwargs['lookforoutfile'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
/***************************************************/
/***************************************************/
// EYRGBE20 --> MEJORAR E INCLUIR, COMPARAR COPYS
/***************************************************/
/***************************************************/
// Fecha de inicio de la descarga de tablas
        if (typeof kwargs['date_start'] != "undefined") {
            this.kwargs['date_start'] = (isNaN(Number(kwargs['date_start']))?yy + mm:kwargs['date_start']);
        } else {
            this.kwargs['date_start'] = yy + mm;
        }
// Fecha de fin de la descarga de tablas
        if (typeof kwargs['date_end'] != "undefined") {
            this.kwargs['date_end'] = (isNaN(Number(kwargs['date_end']))?this.kwargs['date_start']:kwargs['date_end']);

            if (this.kwargs['date_start'] < kwargs['date_end']) {
                this.kwargs['date_end'] = kwargs['date_end'];
            } else {
                this.kwargs['date_end'] = this.kwargs['date_start'];
            }
        } else {
            this.kwargs['date_end'] = this.kwargs['date_start'];
        }
// Clave de ordenacion de la tabla
/***************************************************/
//      this.kwargs['clv'] =
//      TEYRGBIN    2076,3,CH,A,2,10,CH,A,13,2,CH,A,17,4,CH,A,2015,60,CH,A,2079,1,CH,A
//      TEYRGGGO    1204,3,CH,A,1,10,CH,A,12,2,CH,A,16,4,CH,A,21,26,CH,A,47,34,CH,A,81,50,CH,A,160,26,CH,A,1142,60,CH,A
//      TEYRGGOP    1,4,CH,A,37,4,CH,A,43,26,CH,A,119,34,CH,A,11,26,CH,A,170,3,CH,A,7,4,CH,A,153,10,CH,A,41,2,CH,A,69,50,CH,A,5,2,CH,A
//      TEYRGHOP    1,3,CH,A,4,10,CH,A,14,2,CH,A,16,4,CH,A,20,26,CH,A,46,50,CH,A,96,34,CH,A
//      TEYRGHTI    1,3,CH,A,4,10,CH,A,14,2,CH,A,16,4,CH,A,20,26,CH,A
//      TEYRGNBS    1,3,CH,A,48,25,CH,A,16,4,CH,A,46,2,CH,A,84,4,CH,A,88,26,CH,A,164,34,CH,A,198,3,CH,A,4,10,CH,A,14,2,CH,A,20,26,CH,A,82,2,CH,A,114,50,CH,A
//      TEYRGNSR    508,1,CH,A,1,10,CH,A,11,4,CH,A,15,25,CH,A,42,4,CH,A,46,26,CH,A,122,34,CH,A,40,2,CH,A,72,50,CH,A
//      TEYRGOAN    1,3,CH,A,4,10,CH,A,14,2,CH,A,16,4,CH,A,20,26,CH,A,46,50,CH,A,96,34,CH,A
//      TEYRGOEA    1,10,CH,A,12,2,CH,A,16,4,CH,A,21,26,CH,A,81,50,CH,A,47,34,CH,A,188,60,CH,A,250,60,CH,A
//      TEYRGOGE    1,4,CH,A,5,2,CH,A,7,4,CH,A,87,10,CH,A,11,26,CH,A,37,50,CH,A
//      TEYRGOSL    1,4,CH,A,7,4,CH,A,11,26,CH,A,87,34,CH,A,121,10,CH,A,5,2,CH,A,37,50,CH,A
//      TEYRGPER    1,4,CH,A,17,26,CH,A,11,4,CH,A,7,2,CH,A,47,10,CH,A
//      TEYRGVIN    1,10,CH,A,13,4,CH,A,17,26,CH,A,93,34,CH,A,129,4,CH,A,133,26,CH,A,209,34,CH,A,11,2,CH,A,127,2,CH,A,43,50,CH,A,159,50,CH,A
//
//      TEYRGORE    1,4,CH,A,05,26,CH,A,31,34,CH,A,65,10,CH,A,75,1,CH,A,76,50,CH,A,126,2,CH,A,128,10,CH,A
/***************************************************/
        if (typeof kwargs['clv'] != "undefined") {
            this.kwargs['clv'] = kwargs['clv'].toUpperCase();

            if (this.kwargs['table'] == "TEYRGBIN") {
                this.kwargs['clv'] = "2076,3,CH,A,2,10,CH,A,13,2,CH,A,17,4,CH,A,2015,60,CH,A,2079,1,CH,A";
            } else if (this.kwargs['table'] == "TEYRGGGO") {
                this.kwargs['clv'] = "1204,3,CH,A,1,10,CH,A,12,2,CH,A,16,4,CH,A,21,26,CH,A,47,34,CH,A,81,50,CH,A,160,26,CH,A,1142,60,CH,A";
            } else if (this.kwargs['table'] == "TEYRGGOP") {
                this.kwargs['clv'] = "1,4,CH,A,37,4,CH,A,43,26,CH,A,119,34,CH,A,11,26,CH,A,170,3,CH,A,7,4,CH,A,153,10,CH,A,41,2,CH,A,69,50,CH,A,5,2,CH,A";
            } else if (this.kwargs['table'] == "TEYRGHOP") {
                this.kwargs['clv'] = "1,3,CH,A,4,10,CH,A,14,2,CH,A,16,4,CH,A,20,26,CH,A,46,50,CH,A,96,34,CH,A";
            } else if (this.kwargs['table'] == "TEYRGHTI") {
                this.kwargs['clv'] = "1,3,CH,A,4,10,CH,A,14,2,CH,A,16,4,CH,A,20,26,CH,A";
            } else if (this.kwargs['table'] == "TEYRGNBS") {
                this.kwargs['clv'] = "1,3,CH,A,48,25,CH,A,16,4,CH,A,46,2,CH,A,84,4,CH,A,88,26,CH,A,164,34,CH,A,198,3,CH,A,4,10,CH,A,14,2,CH,A,20,26,CH,A,82,2,CH,A,114,50,CH,A";
            } else if (this.kwargs['table'] == "TEYRGNSR") {
                this.kwargs['clv'] = "508,1,CH,A,1,10,CH,A,11,4,CH,A,15,25,CH,A,42,4,CH,A,46,26,CH,A,122,34,CH,A,40,2,CH,A,72,50,CH,A";
            } else if (this.kwargs['table'] == "TEYRGOAN") {
                this.kwargs['clv'] = "1,3,CH,A,4,10,CH,A,14,2,CH,A,16,4,CH,A,20,26,CH,A,46,50,CH,A,96,34,CH,A";
            } else if (this.kwargs['table'] == "TEYRGOEA") {
                this.kwargs['clv'] = "1,10,CH,A,12,2,CH,A,16,4,CH,A,21,26,CH,A,81,50,CH,A,47,34,CH,A,188,60,CH,A,250,60,CH,A";
            } else if (this.kwargs['table'] == "TEYRGOGE") {
                this.kwargs['clv'] = "1,4,CH,A,5,2,CH,A,7,4,CH,A,87,10,CH,A,11,26,CH,A,37,50,CH,A";
            } else if (this.kwargs['table'] == "TEYRGOSL") {
                this.kwargs['clv'] = "1,4,CH,A,7,4,CH,A,11,26,CH,A,87,34,CH,A,121,10,CH,A,5,2,CH,A,37,50,CH,A";
            } else if (this.kwargs['table'] == "TEYRGPER") {
                this.kwargs['clv'] = "1,4,CH,A,17,26,CH,A,11,4,CH,A,7,2,CH,A,47,10,CH,A";
            } else if (this.kwargs['table'] == "TEYRGVIN") {
                this.kwargs['clv'] = "1,10,CH,A,13,4,CH,A,17,26,CH,A,93,34,CH,A,129,4,CH,A,133,26,CH,A,209,34,CH,A,11,2,CH,A,127,2,CH,A,43,50,CH,A,159,50,CH,A";
            } else if (this.kwargs['table'] == "TEYRGORE") {
                this.kwargs['clv'] = "1,4,CH,A,05,26,CH,A,31,34,CH,A,65,10,CH,A,75,1,CH,A,76,50,CH,A,126,2,CH,A,128,10,CH,A";
            } else {
                if (this.kwargs['clv'] == "" || this.kwargs['clv'] == "COPY") {
                    this.kwargs['clv'] = "COPY";
                }
            } 
            
            if (this.kwargs['clv'] != "" && this.kwargs['clv'] != "COPY") {
                var words = [];

                if (this.kwargs['clv'].substring(this.kwargs['clv'].length - 1) != ",") {
                    words = this.kwargs['clv'].split(",");
                } else {
                    words = this.kwargs['clv'].substring(0, this.kwargs['clv'].length - 1).split(",");
                }
                var len_words = 0;

                var out = "";
                var point = 0;

                (words).forEach(function(word) {
                    var len_word = word.length;
                    len_words += (len_word + 1);

                    if (point == 0 || point == 1) {
                        if (isNaN(parseInt(word, 10))) {
                            out = "COPY";
                        }
                    } else if (point == 2) {
                        if (word != "CH" && word != "AQ" && word != "ZD" && word != "PD" && word != "PD0" && word != "FI" && word != "BI" && word != "FL" && word != "AC"
                            && word != "CSF" && word != "FS" && word != "UFF" && word != "SFF" && word != "CSL" && word != "LS" && word != "CST" && word != "TS" && word != "CLO"
                            && word != "OL" && word != "CTO" && word != "OT" && word != "ASL" && word != "AST" && word != "D1" && word != "Y2T" && word != "Y2U" && word != "Y2V"
                            && word != "Y2W" && word != "Y2X" && word != "Y2Y" && word != "Y2C" && word != "Y2Z" && word != "Y2P" && word != "Y2D" && word != "Y2S"
                            && word != "Y2B") {
                            out = "COPY";
                        }
                    } else if (point == 3) {
                        if (word != "A" && word != "D") {
                            out = "COPY";
                        }
                        point = -1;
                    }

                    point++;

                    if (out != "COPY") {

                        if (len_words >= 56) {
                            out += "\n               ";
                            len_words = len_word;
                        }

                        out += word + ",";
                    }
                }, this);

                if (out != "COPY") {
                    this.kwargs['clv'] = out.substring(0, out.length - 1);
                } else {
                    this.kwargs['clv'] = out;
                }
            }
        } else {
            if (this.kwargs['table'] == "TEYRGBIN") {
                this.kwargs['clv'] = "2076,3,CH,A,2,10,CH,A,13,2,CH,A,17,4,CH,A,2015,60,CH,A,2079,1,CH,A";
            } else if (this.kwargs['table'] == "TEYRGGGO") {
                this.kwargs['clv'] = "1204,3,CH,A,1,10,CH,A,12,2,CH,A,16,4,CH,A,21,26,CH,A,47,34,CH,A,81,50,CH,A,160,26,CH,A,1142,60,CH,A";
            } else if (this.kwargs['table'] == "TEYRGGOP") {
                this.kwargs['clv'] = "1,4,CH,A,37,4,CH,A,43,26,CH,A,119,34,CH,A,11,26,CH,A,170,3,CH,A,7,4,CH,A,153,10,CH,A,41,2,CH,A,69,50,CH,A,5,2,CH,A";
            } else if (this.kwargs['table'] == "TEYRGHOP") {
                this.kwargs['clv'] = "1,3,CH,A,4,10,CH,A,14,2,CH,A,16,4,CH,A,20,26,CH,A,46,50,CH,A,96,34,CH,A";
            } else if (this.kwargs['table'] == "TEYRGHTI") {
                this.kwargs['clv'] = "1,3,CH,A,4,10,CH,A,14,2,CH,A,16,4,CH,A,20,26,CH,A";
            } else if (this.kwargs['table'] == "TEYRGNBS") {
                this.kwargs['clv'] = "1,3,CH,A,48,25,CH,A,16,4,CH,A,46,2,CH,A,84,4,CH,A,88,26,CH,A,164,34,CH,A,198,3,CH,A,4,10,CH,A,14,2,CH,A,20,26,CH,A,82,2,CH,A,114,50,CH,A";
            } else if (this.kwargs['table'] == "TEYRGNSR") {
                this.kwargs['clv'] = "508,1,CH,A,1,10,CH,A,11,4,CH,A,15,25,CH,A,42,4,CH,A,46,26,CH,A,122,34,CH,A,40,2,CH,A,72,50,CH,A";
            } else if (this.kwargs['table'] == "TEYRGOAN") {
                this.kwargs['clv'] = "1,3,CH,A,4,10,CH,A,14,2,CH,A,16,4,CH,A,20,26,CH,A,46,50,CH,A,96,34,CH,A";
            } else if (this.kwargs['table'] == "TEYRGOEA") {
                this.kwargs['clv'] = "1,10,CH,A,12,2,CH,A,16,4,CH,A,21,26,CH,A,81,50,CH,A,47,34,CH,A,188,60,CH,A,250,60,CH,A";
            } else if (this.kwargs['table'] == "TEYRGOGE") {
                this.kwargs['clv'] = "1,4,CH,A,5,2,CH,A,7,4,CH,A,87,10,CH,A,11,26,CH,A,37,50,CH,A";
            } else if (this.kwargs['table'] == "TEYRGOSL") {
                this.kwargs['clv'] = "1,4,CH,A,7,4,CH,A,11,26,CH,A,87,34,CH,A,121,10,CH,A,5,2,CH,A,37,50,CH,A";
            } else if (this.kwargs['table'] == "TEYRGPER") {
                this.kwargs['clv'] = "1,4,CH,A,17,26,CH,A,11,4,CH,A,7,2,CH,A,47,10,CH,A";
            } else if (this.kwargs['table'] == "TEYRGVIN") {
                this.kwargs['clv'] = "1,10,CH,A,13,4,CH,A,17,26,CH,A,93,34,CH,A,129,4,CH,A,133,26,CH,A,209,34,CH,A,11,2,CH,A,127,2,CH,A,43,50,CH,A,159,50,CH,A";
            } else if (this.kwargs['table'] == "TEYRGORE") {
                this.kwargs['clv'] = "1,4,CH,A,05,26,CH,A,31,34,CH,A,65,10,CH,A,75,1,CH,A,76,50,CH,A,126,2,CH,A,128,10,CH,A";
            } else {
                this.kwargs['clv'] = "COPY";
            }
            
            if (this.kwargs['clv'] != "COPY") {
                var words = [];

                if (this.kwargs['clv'].substring(this.kwargs['clv'].length - 1) != ",") {
                    words = this.kwargs['clv'].split(",");
                } else {
                    words = this.kwargs['clv'].substring(0, this.kwargs['clv'].length - 1).split(",");
                }
                var len_words = 0;

                var out = "";
                var point = 0;

                (words).forEach(function(word) {
                    var len_word = word.length;
                    len_words += (len_word + 1);

                    if (point == 0 || point == 1) {
                        if (isNaN(parseInt(word, 10))) {
                            out = "COPY";
                        }
                    } else if (point == 2) {
                        if (word != "CH" && word != "AQ" && word != "ZD" && word != "PD" && word != "PD0" && word != "FI" && word != "BI" && word != "FL" && word != "AC"
                            && word != "CSF" && word != "FS" && word != "UFF" && word != "SFF" && word != "CSL" && word != "LS" && word != "CST" && word != "TS" && word != "CLO"
                            && word != "OL" && word != "CTO" && word != "OT" && word != "ASL" && word != "AST" && word != "D1" && word != "Y2T" && word != "Y2U" && word != "Y2V"
                            && word != "Y2W" && word != "Y2X" && word != "Y2Y" && word != "Y2C" && word != "Y2Z" && word != "Y2P" && word != "Y2D" && word != "Y2S"
                            && word != "Y2B") {
                            out = "COPY";
                        }
                    } else if (point == 3) {
                        if (word != "A" && word != "D") {
                            out = "COPY";
                        }
                        point = -1;
                    }

                    point++;

                    if (out != "COPY") {

                        if (len_words >= 56) {
                            out += "\n               ";
                            len_words = len_word;
                        }

                        out += word + ",";
                    }
                }, this);

                if (out != "COPY") {
                    this.kwargs['clv'] = out.substring(0, out.length - 1);
                } else {
                    this.kwargs['clv'] = out;
                }
            }

        }
// Incluir join
        if (typeof kwargs['add_join'] != "undefined") {
            this.kwargs['add_join'] = (kwargs['add_join'] == "0"?"0":"1");
        } else {
            this.kwargs['add_join'] = "1";
        }
// Incluir sort de ficheros
        if (typeof kwargs['sort'] != "undefined") {
            this.kwargs['sort'] = (kwargs['sort'] == "0"?"0":"1");
        } else {
            this.kwargs['sort'] = "1";
        }
// Incluir validacion de si el fichero existe
        if (typeof kwargs['file_exist'] != "undefined") {
            this.kwargs['file_exist'] = (kwargs['file_exist'] == "0"?"0":"1");
        } else {
            this.kwargs['file_exist'] = "1";
        }
// Incluir validacion de si el fichero esta vacio
        if (typeof kwargs['file_empty'] != "undefined") {
            this.kwargs['file_empty'] = (kwargs['file_empty'] == "0"?"0":"1");
        } else {
            this.kwargs['file_empty'] = "1";
        }
// Incluir sort para dividir un fichero en varios ficheros
        if (typeof kwargs['file_filter'] != "undefined") {
            this.kwargs['file_filter'] = (kwargs['file_filter'] == "0"?"0":"1");
        } else {
            this.kwargs['file_filter'] = "1";
        }
// Incluir sort para crear nuevo fichero
        if (typeof kwargs['file_new'] != "undefined") {
            this.kwargs['file_new'] = (kwargs['file_new'] == "0"?"0":"1");
        } else {
            this.kwargs['file_new'] = "1";
        }
// Incluir sort para las estadisticas
        if (typeof kwargs['file_statistics'] != "undefined") {
            this.kwargs['file_statistics'] = (kwargs['file_statistics'] == "0"?"0":"1");
        } else {
            this.kwargs['file_statistics'] = "1";
        }
// Incluir arrancador de Filespeed
        if (typeof kwargs['run_jcls'] != "undefined") {
            this.kwargs['run_jcls'] = (kwargs['run_jcls'] == "0"?"0":"1");
        } else {
            this.kwargs['run_jcls'] = "1";
        }
// Incluir paso con un IFTHEN
        if (typeof kwargs['ifthen'] != "undefined") {
            this.kwargs['ifthen'] = (kwargs['ifthen'] == "0"?"0":"1");
        } else {
            this.kwargs['ifthen'] = "1";
        }
// Incluir paso con cabezera y pie de fichero y de pagina
        if (typeof kwargs['header1'] != "undefined") {
            this.kwargs['header1'] = (kwargs['header1'] == "0"?"0":"1");
        } else {
            this.kwargs['header1'] = "1";
        }
// Cambiar el proceso de descarga para que se haga por trimestre
        if (typeof kwargs['trimester'] != "undefined") {
            this.kwargs['trimester'] = (kwargs['trimester'] == "0"?"0":"1");
        } else {
            this.kwargs['trimester'] = "1";
        }
// Proceso para insertar un nuevo registro
        if (typeof kwargs['insert'] != "undefined") {
            this.kwargs['insert'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['insert'] == "0") {
                this.kwargs['insert'][i++] = "\n* 10 - ALTA DE REGISTROS"
                this.kwargs['insert'][i++] = "\n    05 CTA-200001-I                  PIC X(08) VALUE '200001-I'."
                this.kwargs['insert'][i++] = "\n    05 CTN-10                        PIC 9(02) VALUE 10."
                this.kwargs['insert'][i++] = "\n         WHEN CTN-10"
                                           + "\n            PERFORM 200001-INSERT"
                this.kwargs['insert'][i++] = "\n*"
                                           + "\n******************************************************************"
                                           + "\n* 200001-INSERT"
                                           + "\n******************************************************************"
                                           + "\n 200001-INSERT."
                                           + "\n*"
                                           + "\n     PERFORM 400000-INFORMAR-DCLGEN"
                                           + "\n*"
                                           + "\n     EXEC SQL"
                                           + "\n        INSERT INTO " + this.kwargs['table_rut']
                                           + "\n            (  COD_CAMP000"
                                           + "\n            ,  AUD_USUARIO"
                                           + "\n            ,  AUD_TIMFMOD"
                                           + "\n            , [...])"
                                           + "\n     VALUE ( :" + this.kwargs['table_rut'].substring(6,3) + "-COD-CAMP000"
                                           + "\n            , :CTA-" + this.kwargs['name']
                                           + "\n            , CURRENT TIMESTAMP"
                                           + "\n            , :[...])"
                                           + "\n     END-EXEC"
                                           + "\n*"
                                           + "\n     EVALUATE SQLCODE"
                                           + "\n        WHEN CTN-DB2-OK"
                                           + "\n            CONTINUE"
                                           + "\n"
                                           + "\n        WHEN CTN-DB2-YA-EXISTE"
                                           + "\n            MOVE CTA-RUTINA-DUPLICADO TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTN-00022002         TO COD-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTA-200001-I         TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n            MOVE CTA-INSERT           TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n            PERFORM 999999-FIN-ERROR"
                                           + "\n        WHEN OTHER"
                                           + "\n            MOVE CTA-RUTINA-ERROR-GRAVE TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTN-01309201         TO COD-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTA-200001-I           TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n            MOVE CTA-INSERT             TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n            PERFORM 999999-FIN-ERROR"
                                           + "\n     END-EVALUATE"
                                           + "\n     .";
            }
        } else {
            this.kwargs['insert'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Proceso para eliminar un registro
        if (typeof kwargs['delete'] != "undefined") {
            this.kwargs['delete'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['delete'] == "0") {
                this.kwargs['delete'][i++] = "\n* 20 - BAJA DE REGISTROS"
                this.kwargs['delete'][i++] = "\n    05 CTA-200002-D                  PIC X(08) VALUE '200002-D'."
                this.kwargs['delete'][i++] = "\n    05 CTN-20                        PIC 9(02) VALUE 20."
                this.kwargs['delete'][i++] = "\n         WHEN CTN-20"
                                           + "\n            PERFORM 200002-DELETE"
                this.kwargs['delete'][i++] = "\n*"
                                           + "\n******************************************************************"
                                           + "\n* 200002-DELETE"
                                           + "\n******************************************************************"
                                           + "\n 200002-DELETE."
                                           + "\n*"
                                           + "\n     PERFORM 400000-INFORMAR-DCLGEN"
                                           + "\n*"
                                           + "\n     EXEC SQL"
                                           + "\n        DELETE FROM " + this.kwargs['table_rut']
                                           + "\n            WHERE {condicion de busqueda}"
                                           + "\n     END-EXEC"
                                           + "\n*"
                                           + "\n     EVALUATE SQLCODE"
                                           + "\n        WHEN CTN-DB2-OK"
                                           + "\n            CONTINUE"
                                           + "\n"
                                           + "\n        WHEN CTN-DB2-NO-EXISTE"
                                           + "\n            MOVE CTA-RUTINA-SIN-DATOS TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTN-01309200         TO COD-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTA-200001-D         TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n            MOVE CTA-DELETE           TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n            PERFORM 999999-FIN-ERROR"
                                           + "\n        WHEN OTHER"
                                           + "\n            MOVE CTA-RUTINA-ERROR-GRAVE TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTN-01309201         TO COD-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTA-200001-D         TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n            MOVE CTA-DELETE           TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n            PERFORM 999999-FIN-ERROR"
                                           + "\n     END-EVALUATE"
                                           + "\n     .";

            }
        } else {
            this.kwargs['delete'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Proceso para actualizar un registro
        if (typeof kwargs['update'] != "undefined") {
            this.kwargs['update'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['update'] == "0") {
                this.kwargs['update'][i++] = "\n* 30 - MODIFICACION DE REGISTROS"
                this.kwargs['update'][i++] = "\n    05 CTA-200003-U                  PIC X(08) VALUE '200003-U'."
                this.kwargs['update'][i++] = "\n    05 CTN-30                        PIC 9(02) VALUE 20."
                this.kwargs['update'][i++] = "\n         WHEN CTN-30"
                                           + "\n            PERFORM 200003-UPDATE"
                this.kwargs['update'][i++] = "\n*"
                                           + "\n******************************************************************"
                                           + "\n* 200003-UPDATE"
                                           + "\n******************************************************************"
                                           + "\n 200003-UPDATE."
                                           + "\n*"
                                           + "\n     PERFORM 400000-INFORMAR-DCLGEN"
                                           + "\n*"
                                           + "\n     EXEC SQL"
                                           + "\n        UPDATE " + this.kwargs['table_rut']
                                           + "\n           SET COD_CAMP000 = :" + this.kwargs['table_rut'].substring(6,3) + "-COD-CAMP000"
                                           + "\n             , AUD_USUARIO = :CTA-" + this.kwargs['name']
                                           + "\n             , AUD_TIMFMOD = CURRENT TIMESTAMP"
                                           + "\n             , [...] = :[...]"
                                           + "\n            WHERE {condicion de busqueda}"
                                           + "\n     END-EXEC"
                                           + "\n*"
                                           + "\n     EVALUATE SQLCODE"
                                           + "\n        WHEN CTN-DB2-OK"
                                           + "\n            CONTINUE"
                                           + "\n"
                                           + "\n        WHEN CTN-DB2-NO-EXISTE"
                                           + "\n            MOVE CTA-RUTINA-SIN-DATOS TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTN-01309200         TO COD-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTA-200001-U         TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n            MOVE CTA-UPDATE           TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n            PERFORM 999999-FIN-ERROR"
                                           + "\n        WHEN OTHER"
                                           + "\n            MOVE CTA-RUTINA-ERROR-GRAVE TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTN-01309201         TO COD-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTA-200001-U         TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n            MOVE CTA-UPDATE           TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n            PERFORM 999999-FIN-ERROR"
                                           + "\n     END-EVALUATE"
                                           + "\n     .";

            }
        } else {
            this.kwargs['update'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
// Proceso para buscar un registro
        if (typeof kwargs['select'] != "undefined") {
            this.kwargs['select'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['select'] == "0") {
                this.kwargs['select'][i++] = "\n* 40 - BUSCAR UN REGISTRO"
                this.kwargs['select'][i++] = "\n    05 CTA-200004-S                  PIC X(08) VALUE '200004-S'."
                this.kwargs['select'][i++] = "\n    05 CTN-40                        PIC 9(02) VALUE 40."
                this.kwargs['select'][i++] = "\n         WHEN CTN-40"
                                           + "\n            PERFORM 200004-SELECT"
                this.kwargs['select'][i++] = "\n*"
                                           + "\n******************************************************************"
                                           + "\n* 200004-SELECT"
                                           + "\n******************************************************************"
                                           + "\n 200004-SELECT."
                                           + "\n*"
                                           + "\n     PERFORM 400000-INFORMAR-DCLGEN"
                                           + "\n*"
                                           + "\n     EXEC SQL"
                                           + "\n        SELECT COD_CAMP000"
                                           + "\n             , AUD_USUARIO"
                                           + "\n             , AUD_TIMFMOD"
                                           + "\n             , [...]"
                                           + "\n         INTO   :" + this.kwargs['table_rut'].substring(6,3) + "-COD-CAMP000"
                                           + "\n              , :" + this.kwargs['table_rut'].substring(6,3) + "-AUD-USUARIO"
                                           + "\n              , :" + this.kwargs['table_rut'].substring(6,3) + "-AUD-TIMFMOD"
                                           + "\n              , :[...]"
                                           + "\n          FROM " + this.kwargs['table_rut']
                                           + "\n         WHERE {condicion de busqueda}"
                                           + "\n     END-EXEC"
                                           + "\n*"
                                           + "\n     EVALUATE SQLCODE"
                                           + "\n        WHEN CTN-DB2-OK"
                                           + "\n            PERFORM 500000-RETORNAR-CONSULTA"
                                           + "\n"
                                           + "\n        WHEN CTN-DB2-NO-EXISTE"
                                           + "\n            MOVE CTA-RUTINA-SIN-DATOS TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTN-01309200         TO COD-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTA-200001-S         TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n            MOVE CTA-SELECT           TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n            PERFORM 999999-FIN-ERROR"
                                           + "\n        WHEN OTHER"
                                           + "\n            MOVE CTA-RUTINA-ERROR-GRAVE TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTN-01309201         TO COD-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTA-200001-S         TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n            MOVE CTA-SELECT           TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n            PERFORM 999999-FIN-ERROR"
                                           + "\n     END-EVALUATE"
                                           + "\n     .";

            }
        } else {
            this.kwargs['select'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }

        if (typeof kwargs['cursor'] != "undefined") {
            this.kwargs['cursor'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;

            if (kwargs['cursor'] == "0") {
                this.kwargs['cursor'][i++] = "\n* 41 - BUSCAR UN LISTADO DE REGISTROS"
                this.kwargs['cursor'][i++] = "\n    05 CTA-204101-O                  PIC X(08) VALUE '204101-O'."
                                           + "\n    05 CTA-204102-F                  PIC X(08) VALUE '204102-F'."
                                           + "\n    05 CTA-204103-C                  PIC X(08) VALUE '204103-C'."
                this.kwargs['cursor'][i++] = "\n    05 CTN-41                        PIC 9(02) VALUE 41."
                                           + "\n    05 CTN-51                        PIC 9(02) VALUE 51."
                this.kwargs['cursor'][i++] = "\n     EXEC SQL"
                                           + "\n        DECLARE ######## CURSOR FOR"
                                           + "\n        SELECT COD_CAMP000"
                                           + "\n             , AUD_USUARIO"
                                           + "\n             , AUD_TIMFMOD"
                                           + "\n             , [...]"
                                           + "\n          FROM " + this.kwargs['table_rut']
                                           + "\n         WHERE {condicion de busqueda}"
                                           + "\n        FETCH FIRST 51 ROWS ONLY"
                                           + "\n     END-EXEC";
                this.kwargs['cursor'][i++] = "\n         WHEN CTN-41"
                                           + "\n            PERFORM 204100-CURSOR"
                this.kwargs['cursor'][i++] = "\n*"
                                           + "\n******************************************************************"
                                           + "\n* 204100-CURSOR"
                                           + "\n******************************************************************"
                                           + "\n 200001-CURSOR."
                                           + "\n*"
                                           + "\n     PERFORM 400000-INFORMAR-DCLGEN"
                                           + "\n*"
                                           + "\n     SET NO-FIN-CURSOR TO TRUE"
                                           + "\n"
                                           + "\n     IF QNU-FILAS-QPIPCCAB EQUAL ZEROES OR"
                                           + "\n        QNU-FILAS-QPIPCCAB GREATER CTN-51"
                                           + "\n"
                                           + "\n        MOVE CTN-51    TO QNU-FILAS-QPIPCCAB"
                                           + "\n     END-IF"
                                           + "\n"
                                           + "\n     IF XSN-PRIMERO-QPIPCCAB EQUAL CTA-S"
                                           + "\n*--"
                                           + "\n        CONTINUE"
                                           + "\n*--"
                                           + "\n     END-IF"
                                           + "\n"
                                           + "\n     PERFORM 204101-OPEN-CURSOR"
                                           + "\n"
                                           + "\n     IF SQLCODE EQUAL CTN-DB2-OK"
                                           + "\n        PERFORM 204102-FETCH-CURSOR"
                                           + "\n            UNTIL WS-IND EQUAL QNU-FILAS-QPIPCCAB"
                                           + "\n               OR SI-FIN-CURSOR"
                                           + "\n     END-IF"
                                           + "\n"
                                           + "\n     PERFORM 204103-CLOSE-CURSOR"
                                           + "\n"
                                           + "\n     MOVE SW-FIN-CURSOR TO XSN-MASDATOS-QPIPCCAB"
                                           + "\n     MOVE WS-IND        TO QNU-FILENV-QPIPCCAB"
                                           + "\n*"
                                           + "\n     ."
                                           + "\n*"
                                           + "\n******************************************************************"
                                           + "\n* 204101-OPEN-CURSOR"
                                           + "\n******************************************************************"
                                           + "\n 204101-OPEN-CURSOR."
                                           + "\n*"
                                           + "\n     EXEC SQL"
                                           + "\n         OPEN ########"
                                           + "\n     END-EXEC"
                                           + "\n*"
                                           + "\n     EVALUATE SQLCODE"
                                           + "\n        WHEN CTN-DB2-OK"
                                           + "\n            CONTINUE"
                                           + "\n"
                                           + "\n        WHEN OTHER"
                                           + "\n            MOVE CTA-RUTINA-ERROR-GRAVE TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTN-01309201         TO COD-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTA-204101-O         TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n            MOVE CTA-OPEN             TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n            PERFORM 999999-FIN-ERROR"
                                           + "\n     END-EVALUATE"
                                           + "\n     ."
                                           + "\n*"
                                           + "\n******************************************************************"
                                           + "\n* 204102-FETCH-CURSOR"
                                           + "\n******************************************************************"
                                           + "\n 204102-FETCH-CURSOR."
                                           + "\n*"
                                           + "\n     EXEC SQL"
                                           + "\n        FETCH ########"
                                           + "\n         INTO   :" + this.kwargs['table_rut'].substring(6,3) + "-COD-CAMP000"
                                           + "\n              , :" + this.kwargs['table_rut'].substring(6,3) + "-AUD-USUARIO"
                                           + "\n              , :" + this.kwargs['table_rut'].substring(6,3) + "-AUD-TIMFMOD"
                                           + "\n              , :[...]"
                                           + "\n     END-EXEC"
                                           + "\n*"
                                           + "\n     EVALUATE SQLCODE"
                                           + "\n        WHEN CTN-DB2-OK"
                                           + "\n            PERFORM 500000-RETORNAR-CONSULTA"
                                           + "\n"
                                           + "\n        WHEN CTN-DB2-NO-EXISTE"
                                           + "\n            SET SI-FIN-CURSOR TO TRUE"
                                           + "\n"
                                           + "\n            IF WS-IND EQUAL ZEROS"
                                           + "\n                MOVE CTA-RUTINA-SIN-DATOS "
                                           + "\n                                    TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n                MOVE CTN-01309200   TO COD-AVIERROR-QPIPCCAB"
                                           + "\n                MOVE CTA-204102-C   TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n                MOVE CTA-FETCH      TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n                PERFORM 999999-FIN-ERROR"
                                           + "\n            END-IF"
                                           + "\n"
                                           + "\n        WHEN OTHER"
                                           + "\n            MOVE CTA-RUTINA-ERROR-GRAVE TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTN-01309201         TO COD-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTA-204102-C         TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n            MOVE CTA-FETCH            TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n            PERFORM 999999-FIN-ERROR"
                                           + "\n     END-EVALUATE"
                                           + "\n     ."
                                           + "\n*"
                                           + "\n******************************************************************"
                                           + "\n* 204103-CLOSE-CURSOR"
                                           + "\n******************************************************************"
                                           + "\n 204103-CLOSE-CURSOR."
                                           + "\n*"
                                           + "\n     EXEC SQL"
                                           + "\n         CLOSE ########"
                                           + "\n     END-EXEC"
                                           + "\n*"
                                           + "\n     EVALUATE SQLCODE"
                                           + "\n        WHEN CTN-DB2-OK"
                                           + "\n            CONTINUE"
                                           + "\n"
                                           + "\n        WHEN OTHER"
                                           + "\n            MOVE CTA-RUTINA-ERROR-GRAVE TO XTI-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTN-01309201         TO COD-AVIERROR-QPIPCCAB"
                                           + "\n            MOVE CTA-204103-C         TO COD-PARRAFO-ERR-QPIPCCAB"
                                           + "\n            MOVE CTA-CLOSE            TO COD-ACCESO-ERR-QPIPCCAB"
                                           + "\n"
                                           + "\n            PERFORM 999999-FIN-ERROR"
                                           + "\n     END-EVALUATE"
                                           + "\n     .";

            }
        } else {
            this.kwargs['cursor'] = ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""];
            var i = 0;
        }
    }
/* Ajustar el texto en la descripcion */
    adjust_text() {
        var len_words = 0;
        var line = (this.kwargs['type'] == "programa"?45:68);

        var out = "";

        (this.kwargs['desc'].split(" ")).forEach(function(word) {
            var len_word = word.length;
            len_words += (len_word + 1);

            if (len_words >= line) {
                out += (this.kwargs['type'] == "programa"?"\n* ":"\n//* ");
                len_words = len_word;
                line = 64;
            }

            out += word + " ";
        }, this);

        this.kwargs['desc'] = out
    }
/* Genera la copy del informe */
    treatment_copy() {
        this.kwargs['headboard'] = "";
        this.kwargs['copy_out'] = "";
        this.kwargs['lvl_l'] = [false, 0];

        var lengthIn = 0;
        var lengthOut = 0;
        var lengthHead = 0;

        var lineCopy = (this.kwargs['copy_in']).split("\n");

        var i = 0;

        while (true) {
            if (typeof lineCopy[i] != "undefined") {
                // Identificamos si la linea es un comentario
                if (lineCopy[i].substring(0,1) != "*") {
                    // Devolvemos el nivel del campo
                    var nivel = this.getInfoLinea(lineCopy[i], 0);

                    if (nivel == "01") {
                        this.kwargs['lvl_l'] = [true, i];
                    } else {
                        // Generamos la cabecera
                        var name = this.getInfoLinea(lineCopy[i], 1);
                        // Generamos la longitud del campo de salida
                        var pic = this.getInfoLinea(lineCopy[i], 3);
                        pic = pic.substring(0,(pic.substring(pic.length - 1) == "."?pic.length - 1:pic.length))
                        if (pic != "") {
                            var nsig  = (pic.substring(0, 1) != "-"?0:1);
                            var ncoma = ((pic.indexOf(",") > 0 || pic.indexOf(".") > 0)?1:0);
                            
                            pic = (((pic.replace("9.9", "9,9")).replace(").9(", "),9(")).replace(")V9(", "),9(")).replace("S9", "-9");

                            var ns = (pic.substring(0, 1) != "-"?0:1);

                            var _nd = pic.split(",");

                            var ne = 0;
                            if (_nd[0].indexOf("(") > 0) {
                                ne = parseInt(_nd[0].substring(_nd[0].indexOf("(") + 1, _nd[0].indexOf(")")))
                            } else {
                                ne = _nd[0].length - ns;
                            }

                            var nd = 0;
                            if (_nd.length == 2) {
                                if (_nd[1].indexOf("(") > 0) {
                                    nd = parseInt(_nd[1].substring(_nd[1].indexOf("(") + 1, _nd[1].indexOf(")")))
                                } else {
                                    nd = _nd[1].length;
                                }
                            }
                            // Calculamos la longitud del campo en la entrada
                            var add = 0;
                            var comp = this.getInfoLinea(lineCopy[i], 4);
                            comp = comp.substring(0,(comp.substring(comp.length - 1) == "."?comp.length - 1:comp.length));

                            if (comp != "" && comp != "undefined" && comp != "VALUE") {
                                if (comp.indexOf("COMP-3") == 0) {
                                    add = Math.trunc(((ne + (nd - 1))) / 2) + 1;
                                } else if (comp = "COMP") {
                                    add = Math.trunc(((ne + nd)) / 2);
                                }

                            } else {
                                add = (nsig + ne + ncoma + nd);
                            }

                            lengthIn += add;
                            lengthOut += 1 + ns + ne + nd;
                        }
                        if (name != "FILLER" && pic != "") {
                            this.kwargs['headboard'] += "\t10 FILLER PIC X(" + (name.length - 4) + ") VALUE '" + name.substring(5) + ";'.\n";
                            this.kwargs['copy_out'] += "\t05 " + name + " PIC " + pic + "." + ((pic != "")?"\n\t05 FILLER\tPIC X(1) VALUE ';'.\n":"");
                            lengthHead += (name.length - 4);
                        }
                    }
                }
            } else {
                break;
            }
            i++;
        }

        if (lengthIn > 0) {
            if (this.kwargs['fe'] < 1) {
                this.kwargs['fe'] = 1;
                this.kwargs['fe_length'][0] = lengthIn;
                this.kwargs['fe_desc'][0] = "ENTRADA 1";
            }
            if (this.kwargs['fe_length'][0] <  lengthIn) {
                this.kwargs['fe_length'][0] = lengthIn;
            }

            if (this.kwargs['lvl_l'][0] == true) {
                var aux = this.getInfoLinea(lineCopy[this.kwargs['lvl_l'][1]], 1);
                aux = aux.substring(0,(aux.substring(aux.length - 1) == "."?aux.length - 1:aux.length));
                aux = aux.substring(aux.length - 8)
                this.kwargs['fe_copy'][0] = aux;
            } else {
                this.kwargs['fe_copy'][0] = "UUAAC000";
            }
        }

        this.kwargs['yhead'] = lengthHead;
        this.kwargs['nhead'] = lengthOut;

        if (lengthOut > 0 || lengthHead > 0) {
            if (this.kwargs['fs'] < 1) {
               this.kwargs['fs'] = 1;

               this.kwargs['fs_length'][0] = (lengthOut > lengthHead?lengthOut:lengthHead);
               this.kwargs['fs_copy'][0] = "UUAAC000";
               this.kwargs['fs_desc'][0] = "SALIDA 1";
            }
            if (this.kwargs['fs_length'][0] < (lengthOut > lengthHead?lengthOut:lengthHead)) {
                this.kwargs['fs_length'][0] = (lengthOut > lengthHead?lengthOut:lengthHead);
            }
        }
    }
/* Obtener nivel o nombre */
    getInfoLinea(value, end) {
        var out = "";
        var i = 0;

        (value.split(" ")).forEach(function(index) {
            if (index.length > 1) {
                if (i == end) {
                    out = index;
                }
                i++;
            }
        }, this);

        return out;
    }
/* Generar texto descarga */
    upart(month) {
        var out = "";

        var y = parseInt(month.substring(1,2));
        var m = parseInt(month.substring(2));

        if ("TEYRGOSL|TEYRGGOP|TEYRGOGE".indexOf(this.kwargs['table']) >= 0) {
            if (y % 2 == 1) {
                out += ((m + 11) + "1").padStart(3,"0") + ":" + ((m + 12) + "0").padStart(3,"0");
            } else {
                out += ((m -  1) + "1").padStart(3,"0") + ":" + ((m     ) + "0").padStart(3,"0");
            }

        } else if ("TEYRGPER".indexOf(this.kwargs['table']) >= 0) {
            out += (((((y * 12) + m) * 5) - 4) + "").padStart(3,"0")
                + "," + (((((y * 12) + m) * 5) - 3) + "").padStart(3,"0")
                + "," + (((((y * 12) + m) * 5) - 2) + "").padStart(3,"0")
                + "," + (((((y * 12) + m) * 5) - 1) + "").padStart(3,"0")
                + "," + (((((y * 12) + m) * 5) - 0) + "").padStart(3,"0");

        } else if ("TEYRGNBS".indexOf(this.kwargs['table']) >= 0) {
            out += ((((y % 5) * 12) + m) + "").padStart(2,"0");

        } else if ("TEYRGHOP|TEYRGHTI|TEYRGOAN|TEYRGBIN|TEYRGGGO".indexOf(this.kwargs['table']) >= 0) {
            if (y % 2 == 1) {
                out += ((m     ) + "").padStart(2,"0");
            } else {
                out += ((m + 12) + "").padStart(2,"0");
            }
        } else if ("TEYRGNSR".indexOf(this.kwargs['table']) >= 0) {
            out += (parseInt(month.substring(0,2)) % 3) + 1
        }

        return out;
    }
/* Generar texto carga */
    part(month) {
        var out = "";

        var y = parseInt(month.substring(1,2));
        var m = parseInt(month.substring(2));

        if ("TEYRGOSL|TEYRGGOP|TEYRGOGE".indexOf(this.kwargs['table']) >= 0) {
            if (y % 2 == 1) {
                for (var i = 1; i < 11; i++) {
                    out += (((m + 11) * 10) + i + "").padStart(3,"0") + (i != 5 && i != 10?", ":";");
                }
            } else {
                for (var i = 1; i < 11; i++) {
                    out += (((m -  1) * 10) + i + "").padStart(3,"0") + (i != 5 && i != 10?", ":";");
                }
            }

        } else if ("TEYRGPER".indexOf(this.kwargs['table']) >= 0) {
            out += (((((y * 12) + m) * 5) - 4) + "").padStart(3,"0")
                + "," + (((((y * 12) + m) * 5) - 3) + "").padStart(3,"0")
                + "," + (((((y * 12) + m) * 5) - 2) + "").padStart(3,"0")
                + "," + (((((y * 12) + m) * 5) - 1) + "").padStart(3,"0")
                + "," + (((((y * 12) + m) * 5) - 0) + "").padStart(3,"0");

        } else if ("TEYRGNBS".indexOf(this.kwargs['table']) >= 0) {
            out += ((((y % 5) * 12) + m) + "").padStart(2,"0");

        } else if ("TEYRGHOP|TEYRGHTI|TEYRGOAN|TEYRGBIN|TEYRGGGO".indexOf(this.kwargs['table']) >= 0) {
            if (y % 2 == 1) {
                out += ((m     ) + "").padStart(2,"0");
            } else {
                out += ((m + 12) + "").padStart(2,"0");
            }
        } else if ("TEYRGNSR".indexOf(this.kwargs['table']) >= 0) {
            out += (parseInt(month.substring(0,2)) % 3) + 1
        }

        return out;
    }
/* Repetir un texto indicado tantas veces como nos haga falta */
    repeat_text(value, fe = NaN, fs = NaN) {
        var out = "";

        if (this.kwargs['type'] == "programa" || this.kwargs['type'] == "jcl") {
            var aux = "";
            var triple_barra = "";
            var zfill = 5;

            if ((this.kwargs['fe'] < 100) && (this.kwargs['fs'] < 100)) {
                value = value.replace(/B000+/g, "B" + this.kwargs['name'].substring(5));
                value = value.replace(/U000+/g, "U" + this.kwargs['name'].substring(5));
                zfill = 2
            } else {
                value = value.replace(/B000+/g, "B");
                value = value.replace(/U000+/g, "U");
            }
            // Entrada
            triple_barra = "INPUT";
            for (var i = 0; i < (isNaN(fe)?this.kwargs['fe']:fe); i++) {
                aux = value.replace(/{desc}+/g, this.kwargs['fe_desc'][i]);
                aux = aux.replace(/{length}+/g, this.kwargs['fe_length'][i]);
                aux = aux.replace(/{copy}+/g, this.kwargs['fe_copy'][i]);
                aux = aux.replace(/UUAA+/g, this.kwargs['name'].substring(0, 4));
                aux = aux.replace(/___+/g, triple_barra);
                aux = aux.replace(/__+/g, "ENTRADA");

                if (this.kwargs['join'] == "11" || this.kwargs['join'] == "N1" || this.kwargs['join'] == "1N" || this.kwargs['join'] == "NM"  || this.kwargs['join'] == "MN") {
                    aux = aux.replace(/{}+/g, (i < 2?"MOVE HIGH-VALUES          TO WS-CnnE":""));
                    aux = aux.replace(/{clv}+/g, (i < 2?"MOVE CORR CnnE            TO WS-CnnE":""));
                }
                
                if (this.kwargs['join'] == "111") {
                    aux = aux.replace(/{}+/g, (i < 3?"MOVE HIGH-VALUES          TO WS-CnnE":""));
                    aux = aux.replace(/{clv}+/g, (i < 3?"MOVE CORR CnnE            TO WS-CnnE":""));
                }

                if (this.kwargs['accumulate'] == "0") {
                    aux = aux.replace(/{}+/g, (i < 1?"MOVE HIGH-VALUES          TO WS-CnnE":""));
                    aux = aux.replace(/{clv}+/g, (i < 1?"MOVE CORR CnnE            TO WS-CnnE":""));
                }
                if (this.kwargs['rearranque'][0] == "0") {
                    aux = aux.replace(/{rea0}+/g, (i < 1?"MOVE HIGH-VALUES          TO WS-CnnR":""));
                    aux = aux.replace(/{rea1}+/g, (i < 1?"MOVE CORR CnnE            TO WS-CnnR":""));
                }

                aux = aux.replace(/{}+/g, "");
                aux = aux.replace(/{clv}+/g, "");
                aux = aux.replace(/{rea0}+/g, "");
                aux = aux.replace(/{rea1}+/g, "");

                aux = aux.replace(/{vf}+/g, (this.kwargs['fe_vf'][i] == "0"?"     RECORD CONTAINS 0 CHARACTERS\n":""));
                out += (aux.replace(/_+/g, "E")).replace(/nn+/g,(i + 1 + "").padStart(zfill,"0")) + "\n";
                triple_barra = "               ";
            }
            // Salida
            triple_barra = "OUTPUT";
            for (var i = 0; i < (isNaN(fs)?this.kwargs['fs']:fs); i++) {
                aux = value.replace(/{desc}+/g, this.kwargs['fs_desc'][i]);
                aux = aux.replace(/{length}+/g, this.kwargs['fs_length'][i]);
                aux = aux.replace(/{copy}+/g, this.kwargs['fs_copy'][i]);
                aux = aux.replace(/UUAA+/g, this.kwargs['name'].substring(0, 4));
                aux = aux.replace(/___+/g, triple_barra);
                aux = aux.replace(/__+/g, "SALIDA");
                aux = aux.replace(/{vf}+/g, "");
                out += (aux.replace(/_+/g, "S")).replace(/nn+/g,(i + 1 + "").padStart(zfill,"0")) + "\n";
                triple_barra = "                ";
            }

        } else if (this.kwargs['type'] == "boleta") {
            var i = this.kwargs['date_start'];
            var sortin = "SORTIN   ";
            var or = "";

            do {
                var y = i.substring(0,2);
                var m = parseInt(i.substring(2)) + 1;
                
                if ((m == 13) || ("TEYRGNSR" == this.kwargs['table'])) {
                    y = parseInt(i.substring(0,2)) + 1;
                    m = "01";
                }

                if (((this.kwargs['trimester'] == "0") && (parseInt(i.substring(2)) % 3 == 0)) 
                    || (this.kwargs['trimester'] != "0")) {

                    var aux = value;
                    aux = aux.replace(/UUAA+/g, this.kwargs['name'].substring(0, 4));
                    aux = aux.replace(/{name}+/g, this.kwargs['name']);
                    aux = aux.replace(/{table}+/g, this.kwargs['table']);
                    aux = aux.replace(/{tbl3}+/g, this.kwargs['table'].substring(5));
                    aux = aux.replace(/{tbl2}+/g, this.kwargs['table'].substring(5,7));
                    aux = aux.replace(/{upart}+/g, this.upart(i));
                    aux = aux.replace(/{sortin}+/g, sortin);
                    aux = aux.replace(/{clv}+/g, this.kwargs['clv']);
                    aux = aux.replace(/{or}+/g, or);
                    aux = aux.replace(/{yyyymmdd}+/g, "20" + i.substring(0,2) + (i.substring(2)).padStart(2,"0") + new Date("20" + i.substring(0,2), i.substring(2), 0).getDate());
                    aux = aux.replace(/yymm+/g, i);
                    aux = aux.replace(/{yyyy-mm-dd}+/g, "20" + i.substring(0,2) + "-" + (i.substring(2)).padStart(2,"0") + "-" + new Date("20" + i.substring(0,2), i.substring(2), 0).getDate());

                    if ("TEYRGOSL|TEYRGGOP|TEYRGOGE".indexOf(this.kwargs['table']) >= 0) {
                        aux = aux.replace(/{part0}+/g, this.part(i).split(";")[0]);
                        aux = aux.replace(/{part1}+/g, this.part(i).split(";")[1]);
                    } else {
                        aux = aux.replace(/{part}+/g, this.part(i));
                    }

                    sortin = "         ";
                    or = "                              OR,";

                    out += aux + "\n";
                }

                i = y + (m + "").padStart(2,"0");
            } while (i <= this.kwargs['date_end']);
        }

        return out;
    }
/* Devolver el valor solicitado en base a la UUAA */
    control_UUAA(ind) {
        var out = ["3"
            , "B"
            , "EBP" + this.kwargs['name'].substring(0,4) + ".INPXD05X."
            , this.kwargs['name'].substring(0,4) + "B000"
            , "[revisar]"];

        if (this.kwargs['name'].substring(0,4) == "EBEF") {
            out = ["3"
                , "B"
                , "EBPEBEF.INPXD05X."
                , "EBEFBDIV"
                , "EBPEXPR.PDSB111Z.TRN.AC"];
        } else if (this.kwargs['name'].substring(0,4) == "ERCV") {
            out = ["3"
                , "B"
                , "EBPERCV.INPXD05X."
                , "ERCVR000"
                , "EBPEXPR.PDSB111Z.TRN.PS"];
        } else if (this.kwargs['name'].substring(0,4) == "EYRG") {
            out = ["3"
                , "B"
                , "EBPEYRG.INPXD05X."
                , "EYRGB001"
                , "EBPEXPR.PDSB111Z.TRN.TZ"];
        } else if (this.kwargs['name'].substring(0,4) == "GRDR") {
            out = ["3"
                , "U"
                , "GR.DRINP100."
                , "GRDRU101"
                , "EX.EXPDS111.TRN.GR"];
        }  else if (this.kwargs['name'].substring(0,4) == "OODN") {
            out = ["Y"
                , "U"
                , "OO.DNAPL110."
                , "OODNO000"
                , "EX.EXPDS111.TRN.OO"];
        } else if (this.kwargs['name'].substring(0,4) == "OORG") {
            out = ["1"
                , "U"
                , "OO.RGINP100."
                , "OORGU600"
                , "EX.EXPDS111.TRN.OO"];
        }

        return out[ind];
    }
/* Genera el programa con los datos pasados */
    program() {
        var out = "";

        out += "******************************************************************"
            + "\n*                   DESCRIPCION DEL PROGRAMA"
            + "\n*                   ------------------------"
            + "\n*     PROGRAMA    : " + this.kwargs['name']
            + "\n*     FECHA       : " + this.kwargs['date'][0]
            + "\n*     AUTOR       : ACCENTURE"
            + "\n*     ENTORNO     : BATCH"
            + "\n*     LENGUAJE    : ENTERPRISE COBOL"
            + "\n*     DESCRIPCION : " + this.kwargs['desc']
            + "\n******************************************************************"
            + "\n* LOG DE MODIFICACIONES DE SOFTWARE"
            + "\n******************************************************************"
            + "\n* L-0001 USUARIO:AXXXXXX FECHA: dd-mm-aaaa"
            + "\n* (Descripcion de la modificacion. En el programa se debe marcar"
            + "\n* aquello que se ha modificado entre L-0001-INI y L-0001-FIN)"
            + "\n*"
            + "\n* (0001 es el numero de incidencia asociado a la modificacion)"
            + "\n*"
            + "\n* (Para programas nuevos se marcar  como L-0000 y su descripcion"
            + "\n* ser  NUEVO PROGRAMA)"
            + "\n* L-0000 USUARIO:XE00000 FECHA: " + this.kwargs['date'][0]
            + "\n* PROGRAMA NUEVO "
            + "\n*----"
            + "\n******************************************************************"
            + "\n* IDENTIFICATION DIVISION"
            + "\n******************************************************************"
            + "\n IDENTIFICATION DIVISION."
            + "\n PROGRAM-ID. " + this.kwargs['name']
            + "\n AUTHOR.     ACCENTURE."
            + "\n DATE-WRITTEN.  " + this.kwargs['date'][0]
            + "\n******************************************************************"
            + "\n* ENVIRONMENT DIVISION"
            + "\n******************************************************************"
            + "\n ENVIRONMENT DIVISION."
            + "\n CONFIGURATION  SECTION."
            + "\n******************************************************************"
            + "\n SPECIAL-NAMES."
            + "\n     DECIMAL-POINT IS COMMA."
            + "\n SOURCE-COMPUTER.     IBM-3090."
            + "\n OBJECT-COMPUTER.     IBM-3090."
            + "\n INPUT-OUTPUT SECTION."
            + "\n******************************************************************"
            + "\n FILE-CONTROL.\n"
            + this.repeat_text("*\n"
                          + "*-- FICHERO CON FORMATO DE {desc}\n"
                          + "     SELECT F" + this.control_UUAA(1) + "000nn_\n"
                          + "            ASSIGN TO F" + this.control_UUAA(1) + "000nn_\n"
                          + "            ORGANIZATION IS SEQUENTIAL\n"
                          + "            ACCESS MODE IS SEQUENTIAL\n"
                          + "       FILE STATUS IS FS-F" + this.control_UUAA(1) + "000nn_.")
            + "*"
            + "\n******************************************************************"
            + "\n* DATA DIVISION"
            + "\n******************************************************************"
            + "\n DATA DIVISION."
            + "\n FILE SECTION."
            + "\n******************************************************************\n"
            + this.repeat_text("*\n"
                          + "*-- FICHERO DE __ F" + this.control_UUAA(1) + "000nn_\n"
                          + " FD  F" + this.control_UUAA(1) + "000nn_\n"
                          + "     RECORDING F\n"
                          + "{vf}"
                          + "     BLOCK CONTAINS 0 RECORDS\n"
                          + "     LABEL RECORDS STANDARD.\n"
                          + " 01 RG-F" + this.control_UUAA(1) + "000nn_                      PIC X({length}).")
            + "******************************************************************"
            + "\n* WORKING-STORAGE SECTION"
            + "\n******************************************************************"
            + "\n  WORKING-STORAGE SECTION."
            + "\n*INC AUDIT. NO BORRAR DESDE AQUI HASTA FIN INCLUDE"
            + "\n 77 AUDIT-TRAIL PIC X(60) VALUE"
            + "\n     '[** AUDIT ** " + this.kwargs['name'] + "-XE00000-" + this.kwargs['date'][1] + "-             ]'."
            + "\n*FIN INC AUDIT."
            + "\n******************************************************************"
            + "\n******************************************************************"
            + "\n* CONTROL DE FICHEROS"
            + "\n******************************************************************"
            + "\n 01 FS-FILESTATUS.\n"
            + this.repeat_text("    05 FS-F" + this.control_UUAA(1) + "000nn_                   PIC X(02) VALUE SPACES.")
            + "*"
            + "\n******************************************************************"
            + "\n* SWITCHES"
            + "\n******************************************************************"
            + "\n 01 SWITCHES."
            + "\n*"
            + "\n    05 SW-TIPO-ERROR                 PIC X(01)."
            + "\n        88 ERROR-FILE                           VALUE 'F'."
            + "\n        88 ERROR-MOD                            VALUE 'M'."
            + "\n        88 ERROR-DESBORDA                       VALUE 'E'."
            + "\n*"
            + "\n    05 SW-FIN-CURSOR        PIC X(01)."
            + "\n        88 SI-FIN-CURSOR        VALUE 'S'."
            + "\n        88 NO-FIN-CURSOR        VALUE 'N'."
            + "\n*"
            + this.repeat_text("*\n"
                          + "    05 SW-FIN-F" + this.control_UUAA(1) + "000nn_               PIC X(01).\n"
                          + "        88 SI-FIN-F" + this.control_UUAA(1) + "000nn_                      VALUE 'S'.\n"
                          + "        88 NO-FIN-F" + this.control_UUAA(1) + "000nn_                      VALUE 'N'.", NaN, 0)
            + (this.kwargs['lookfor'][0]!=""?this.kwargs['lookfor'][0]:this.kwargs['lookforoutfile'][0])
            + this.kwargs['qpiprx38'][0]
            + this.kwargs['compare_files'][0]
            + this.kwargs['media'][0]
            + "\n******************************************************************"
            + "\n* CONTADORES"
            + "\n******************************************************************"
            + "\n 01 CONTADORES.\n"
            + this.repeat_text("    05 C-REG-F" + this.control_UUAA(1) + "000nn_                PIC S9(09).")
            + this.kwargs['lookfor'][1]
            + "\n*\n******************************************************************"
            + "\n* CONSTANTES"
            + "\n******************************************************************"
            + "\n 01 CTA-CONSTANTES."
            + "\n*ALFANUMERICAS."
            + "\n    05 CTA-F                         PIC X(01) VALUE 'F'."
            + "\n    05 CTA-M                         PIC X(01) VALUE 'M'."
            + "\n    05 CTA-S                         PIC X(01) VALUE 'S'."
            + "\n    05 CTA-" + this.kwargs['name'].substring(0, 4) + "                      PIC X(04) VALUE '" + this.kwargs['name'].substring(0, 4) + "'."
            + "\n    05 CTA-VALIDA                    PIC X(06) VALUE 'VALIDA'."
            + "\n    05 CTA-INSERT                    PIC X(06) VALUE 'INSERT'."
            + "\n    05 CTA-UPDATE                    PIC X(06) VALUE 'UPDATE'."
            + "\n    05 CTA-SELECT                    PIC X(06) VALUE 'SELECT'."
            + "\n    05 CTA-DELETE                    PIC X(06) VALUE 'DELETE'."
            + "\n    05 CTA-FETCH                     PIC X(06) VALUE 'FETCH'."
            + "\n    05 CTA-OPEN                      PIC X(06) VALUE 'OPEN'."
            + "\n    05 CTA-READ                      PIC X(06) VALUE 'READ'."
            + "\n    05 CTA-WRITE                     PIC X(06) VALUE 'WRITE'."
            + "\n    05 CTA-CLOSE                     PIC X(06) VALUE 'CLOSE'."
            + "\n    05 CTA-CALL                      PIC X(06) VALUE 'CALL'."
            + "\n*"
            + "\n    05 CTA-QPIPRX28                  PIC X(08) VALUE 'QPIPRX28'."
            + "\n    05 CTA-QPIPRX30                  PIC X(08) VALUE 'QPIPRX30'."
            + "\n    05 CTA-QPBTRXRR                  PIC X(08) VALUE 'QPBTRXRR'."
            + "\n    05 CTA-QPBTRXTA                  PIC X(08) VALUE 'QPBTRXTA'."
            + this.kwargs['qpiprx36'][0]
            + this.kwargs['qpiprx37'][0]
            + this.kwargs['qpiprx38'][1]
            + this.kwargs['qpiprx35'][0]
            + this.kwargs['rearranque'][1]
            + this.kwargs['kitcc030'][0]
            + (this.kwargs['jcldb2'] == "0"?"\n    05 CTA-UUAAR000                  PIC X(08) VALUE 'UUAAR000'.":"")
            + "\n*\n"
            + this.repeat_text("    05 CTA-F" + this.control_UUAA(1) + "000nn_                  PIC X(08) VALUE 'F" + this.control_UUAA(1) + "000nn_'.")
            + "\n    05 CTA-" + this.kwargs['name'] + "                  PIC X(08) VALUE '" + this.kwargs['name'] + "'."
            + (((this.kwargs['table_rut']).indexOf("%") >= 0) ? "":"\n    05 CTA-" + this.kwargs['table_rut'] + "                  PIC X(08) VALUE '" + this.kwargs['table_rut'] + "'.")
            + "\n*"
            + "\n    05 CTA-120000-A                  PIC X(08) VALUE '120000-A'."
            + "\n    05 CTA-320000-C                  PIC X(08) VALUE '320000-C'."
            + "\n    05 CTA-499999-R                  PIC X(08) VALUE '499999-R'."
            + "\n    05 CTA-500000-L                  PIC X(08) VALUE '500000-L'."
            + "\n    05 CTA-600000-E                  PIC X(08) VALUE '600000-E'."
            + this.kwargs['insert'][1]
            + this.kwargs['delete'][1]
            + this.kwargs['update'][1]
            + this.kwargs['select'][1]
            + this.kwargs['cursor'][1]
            + "\n*\n"
            + this.repeat_text("    05 CTA-DES-F" + this.control_UUAA(1) + "000nn_              PIC X(30) VALUE\n"
                          + "       'FICH DE {desc}'.")
            + "*----- [CONSTANTES ALFANUMERICAS NUEVAS]"
            + this.kwargs['lookfor'][2]
            + this.kwargs['rearranque'][2]
            + this.kwargs['compare_files'][1]
            + this.kwargs['kitcc030'][1]
            + "\n*-"
            + "\n* NUMERICAS."
            + "\n    05 CTN-10                        PIC 9(02) VALUE 10."
            + "\n    05 CTN-4                         PIC 9(01) VALUE 4."
            + "\n    05 CTN-N1                        PIC S9(1) VALUE -1.";


        if (this.kwargs['insert'][4] != ""
            || this.kwargs['delete'][4] != ""
            || this.kwargs['update'][4] != ""
            || this.kwargs['select'][4] != ""
            || this.kwargs['cursor'][5] != "") {

            out += "\n*----- [CONSTANTES NUMERICAS NUEVAS]"
                + "\n*-"
                + "\n*----- [CONSTANTES NUMERICAS DE ERROR]"
                + "\n* -> ERROR VALIDAR COD-FUNCION"
                + "\n    05 CTN-01309051                  PIC 9(08) VALUE 01309051."
                + "\n* -> ERROR VALIDAR FECHA"
                + "\n    05 CTN-01309049                  PIC 9(08) VALUE 01309049."
                + "\n* -> ERROR DB2"
                + "\n    05 CTN-01309201                  PIC 9(08) VALUE 01309201."
                + "\n    05 CTN-01309200                  PIC 9(08) VALUE 01309200."
                + "\n    05 CTN-00022002                  PIC 9(08) VALUE 00022002.";
        }

        out += "\n*----- [CONSTANTES NUMERICAS NUEVAS]"
            + "\n*-"
            + this.kwargs['cadena_valida'][0]
            + this.kwargs['qpiprx36'][1]
            + this.kwargs['qpiprx35'][1]
            + this.kwargs['qpiprx37'][1]
            + this.kwargs['compare_files'][2]
            + this.kwargs['date_day'][0];

        if (this.kwargs['accumulate'] == "0") {
            out += this.kwargs['media'][1];
        }
        out += "\n*-"
            + "\n*-"
            + "\n******************************************************************"
            + "\n* VARIABLES"
            + "\n******************************************************************"
            + "\n 01 WS-VARIABLES."
            + "\n*"
            + "\n    05 WS-PARRAFO              PIC X(08)."
            + "\n    05 WS-DES-SQLCA."
            + "\n       10 FILLER               PIC X(12) VALUE 'ERROR EN EL '."
            + "\n       10 WS-ACCESO            PIC X(08)."
            + "\n       10 FILLER               PIC X(13) VALUE ' DEL FICHERO '."
            + "\n       10 WS-TABLA             PIC X(08)."
            + "\n       10 FILLER               PIC X(16) VALUE '. FILE-STATUS : '."
            + "\n       10 WS-FILE-STATUS       PIC 9(02)."
            + "\n"
            + "\n    05 WS-IND                  PIC 9(09)."
            + "\n    05 WS-NUMBER               PIC S9(20)V9(9)."
            + "\n    05 WS-SYSIN                PIC X(80)."
            + "\n*"
            + "\n    05 WS-X08-FECHA."
            + "\n        10 WS-AAAA             PIC 9(04)."
            + "\n        10 WS-MM               PIC 9(02)."
            + "\n        10 WS-DD               PIC 9(02)."
            + "\n"
            + "\n    05 WS-X10-HORA."
            + "\n        10 WS-HH               PIC 9(02)."
            + "\n        10 WS-MIN              PIC 9(02)."
            + "\n        10 WS-SS               PIC 9(02)."
            + "\n        10 WS-MMMM             PIC 9(06)."
            + "\n"
            + "\n    05 WS-X26-FECHAHORA."
            + "\n        10 WS-X10-FECHA."
            + "\n            15 WS-AAAA         PIC 9(04)."
            + "\n            15 FILLER          PIC X(01) VALUE '-'."
            + "\n            15 WS-MM           PIC 9(02)."
            + "\n            15 FILLER          PIC X(01) VALUE '-'."
            + "\n            15 WS-DD           PIC 9(02)."
            + "\n        10 FILLER              PIC X(01) VALUE '-'."
            + "\n        10 WS-X13-HORA."
            + "\n            15 WS-HH           PIC 9(02)."
            + "\n            15 FILLER          PIC X(01) VALUE '.'."
            + "\n            15 WS-MIN          PIC 9(02)."
            + "\n            15 FILLER          PIC X(01) VALUE '.'."
            + "\n            15 WS-SS           PIC 9(02)."
            + "\n            15 FILLER          PIC X(01) VALUE '.'."
            + "\n            15 WS-MMMM         PIC 9(06)."
            + "\n"
            + "\n    05 WS-ACTUAL-FECHAHORA     PIC X(26)."
            + "\n*----- [VARIABLES NUEVAS]"
            + this.kwargs['cadena_valida'][1]
            + this.kwargs['qpiprx35'][2]
            + this.kwargs['qpiprx37'][2]
            + this.kwargs['to_number'][0]
            + this.kwargs['chopped'][0]
            + this.kwargs['compare_files'][3]
            + this.kwargs['date_day'][1]
            + this.kwargs['kitcc030'][2];

        if (this.kwargs['join'] != "") {
            out += "\n    05 WS-C01E.\n\n"
                + "    05 WS-C02E.\n\n";

            if (this.kwargs['join'] == "NM") {
                out += "    05 WS-C02T.\n\n"
                    +  "    05 WS-C02A.\n\n";
            } else if (this.kwargs['join'] == "MN") {
                out += "    05 WS-C01T.\n\n"
                    +  "    05 WS-C01A.\n\n";
            } else if (this.kwargs['join'] == "111") {
                out += "    05 WS-C03E.\n\n";
            }

            if (this.kwargs['accumulate'] == "0") {
                if (this.kwargs['join'] != "MN") {
                    out += "    05 WS-C01A.\n\n";
                }

                out += "    05 WS-ACUM.\n"
                    + "*       10 WS-[...]         PIC S9(20)V9(09).\n";

            }
        } else {
            if (this.kwargs['accumulate'] == "0") {
                out += "\n    05 WS-C01E.\n\n"
                    + "    05 WS-C01A.\n\n"
                    + "    05 WS-ACUM.\n"
                    + "*       10 WS-[...]         PIC S9(20)V9(09).\n\n"
                    + this.kwargs['media'][2];
            }
        }

        if (this.kwargs['rearranque'][0] == "0") {
            out += "\n    05 WS-C01R.\n\n";
        }

        if (this.kwargs['headboard'] != "") {
            out += "\n*-\n"
                + "*----------------------------------------------------------------*\n"
                + "*- NOMBRE DE LOS CAMPOS, ESTO MIDE " + this.kwargs['yhead'] + "\n"
                + "*----------------------------------------------------------------*\n"
                + "    05 WS-CAMP-NAME.\n"
                + "*       10 FILLER PIC X(29) VALUE '                             '.\n"
                +  this.kwargs['headboard']
                + "*-\n"
                + "*----------------------------------------------------------------*\n"
                + "* COPIAR LA COPY DE ENTRADA PERO PONIENDO ENTRE CAMPO Y CAMPO UN\n"
                + "* ';' Y SUSTITUYENDO LOS NUMERICOS:\n"
                + "*   -> -9(20),9(09) SI ES COMPRIMIDO.\n"
                + "*   -> ')V9(' POR '),9(' SI NO LO ES.\n"
                + "*----------------------------------------------------------------*\n"
                + "* ESTO MIDE " + this.kwargs['nhead'] + "\n"
                + "*----------------------------------------------------------------*\n"
                + " 01 WS-C01S.\n"
                + "*   06 FILLER               PIC X(1) VALUE ';'.\n"
                +  this.kwargs['copy_out'];
        }
        out += "\n*-"
            + "\n******************************************************************"
            + "\n* TABLAS AUXILIAR"
            + "\n******************************************************************"
            + "\n*"
            + this.kwargs['chopped'][1]
            + this.kwargs['lookfor'][3]
            + this.kwargs['lookforoutfile'][1]
            + this.kwargs['compare_files'][4]
            + this.kwargs['media'][3];

        var nm_mn = "";
        if (this.kwargs['join'] == "NM") {

            nm_mn = "\n 01 TABLA-F{}02E."
                + "\n*"
                + "\n    02 TB-F{}02E-LENGTH     PIC 9(07) VALUE ZEROS."
                + "\n    02 TB-F{}02E    OCCURS 9999999 TIMES."
                + "\n*-- COPY DEL FICHERO DE ENTRADA F{}02E"
                + "\n*03 T02E."
                + "\n        COPY " + this.kwargs['fe_copy'][1] + " REPLACING C000-" + this.kwargs['fe_copy'][1] + " BY T02E"
                + "\n*                      ==(##)== BY ==(##)=="
                + "\n*                      == ## == BY == 04 =="
                + "\n                       ==(01)== BY ==(01)=="
                + "\n                       == 01 == BY == 03 ==.";

        } else if (this.kwargs['join'] == "MN") {

            nm_mn = "\n 01 TABLA-F{}01E."
                + "\n*"
                + "\n    02 TB-F{}01E-LENGTH     PIC 9(07) VALUE ZEROS."
                + "\n    02 TB-F{}01E    OCCURS 9999999 TIMES."
                + "\n*-- COPY DEL FICHERO DE ENTRADA F{}01E"
                + "\n*03 T01E."
                + "\n        COPY " + this.kwargs['fe_copy'][0] + " REPLACING C000-" + this.kwargs['fe_copy'][0] + " BY T01E"
                + "\n*                      ==(##)== BY ==(##)=="
                + "\n*                      == ## == BY == 04 =="
                + "\n                       ==(01)== BY ==(01)=="
                + "\n                       == 01 == BY == 03 ==.";
        }

        if ((this.kwargs['fe'] < 100) && (this.kwargs['fs'] < 100)) {
            nm_mn = nm_mn.replace(/{}+/g, this.control_UUAA(1) + this.kwargs['name'].substring(5));
        } else {
            nm_mn = nm_mn.replace(/{}+/g, this.control_UUAA(1) + "000");
        }

        out += nm_mn + "\n******************************************************************"
            + "\n* COPYS"
            + "\n******************************************************************\n"

        var zfill = 5;
        if ((this.kwargs['fe'] < 100) && (this.kwargs['fs'] < 100)) {
            zfill = 2
        }

        if (this.kwargs['copy_in'] == "") {

            out += this.repeat_text("*\n"
                + "*-- COPY DEL FICHERO DE __ F" + this.control_UUAA(1) + "000nn_\n"
                + "*01 Cnn_.\n"
                + " COPY {copy} REPLACING C000-{copy} BY Cnn_.\n"
                + "*                      ==(01)== BY ==(01)==\n"
                + "*                      == 01 == BY == 02 ==.", NaN, (this.kwargs['record_counter'][0] != ""?this.kwargs['fs'] - 1:NaN));
        } else {
            var aux_copy = "\n*\n"
                + "*-- COPY DEL FICHERO DE __ F" + this.control_UUAA(1) + "000nn_\n"
                + " COPY {copy} REPLACING C000-{copy} BY Cnn_.\n"
                + "*                      ==(01)== BY ==(01)==\n"
                + "*                      == 01 == BY == 02 ==.";


            if ((this.kwargs['fe'] < 100) && (this.kwargs['fs'] < 100)) {
                aux_copy = aux_copy.replace(/B000+/g, "B" + this.kwargs['name'].substring(5));
            } else {
                aux_copy = aux_copy.replace(/B000+/g, "B");
            }

            out += "\n*"
                + "\n*-- COPY DEL FICHERO DE ENTRADA F{}01E".replace(/{}+/g, this.control_UUAA(1) + ((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?this.kwargs['name'].substring(5):""))
                + "\n*COPY EYRGC000 REPLACING C000-EYRGC000 BY C01E.";

            if (this.kwargs['lvl_l'][0] == true) {
                out += "\n COPY " + this.kwargs['fe_copy'][0] + " REPLACING C000-" + this.kwargs['fe_copy'][0] + " BY C01E.\n"
                    + "*                      ==(01)== BY ==(01)==\n"
                    + "*                      == 01 == BY == 02 ==.".replace(/nn+/g,(1 + "").padStart(zfill,"0"));
            } else {
                out += "\n 01 CnnE.\n".replace(/nn+/g,(1 + "").padStart(zfill,"0"))
                    + this.kwargs['copy_in'];
            }

            for (var i = 1; i < this.kwargs['fe']; i++) {
                out += (((aux_copy.replace(/{copy}+/g, this.kwargs['fe_copy'][i])).replace(/__+/g, "ENTRADA")).replace(/_+/g, "E")).replace(/nn+/g,(i + 1 + "").padStart(zfill,"0")) + "\n";
            }

            out += "\n*----------------------------------------------------------------*"
                + "\n*"
                + "\n*-- COPY DEL FICHERO DE SALIDA F{}01S".replace(/{}+/g, this.control_UUAA(1) + ((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?this.kwargs['name'].substring(5):""))
                + "\n 01 C01S."
                + "\n    05 FILLER                    PIC X(" + this.kwargs['fs_length'][0] + ").\n";

            for (var i = 1; i < this.kwargs['fs']; i++) {
                out += (((aux_copy.replace(/{copy}+/g, this.kwargs['fs_copy'][i])).replace(/__+/g, "SALIDA")).replace(/_+/g, "S")).replace(/nn+/g,(i + 1 + "").padStart(zfill,"0")) + "\n";
            }
        }

        if (this.kwargs['record_counter'][0] != "") {
            out += "\n*"
                 + "\n*-- COPY DEL FICHERO DE SALIDA F{}nnS"
                        .replace(/{}+/g, this.control_UUAA(1) + ((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?this.kwargs['name'].substring(5):""))
                        .replace(/nn+/g, (this.kwargs['fs'] + "").padStart(zfill,"0"))
                 + "\n 01 CnnS     PIC 9(20).".replace(/nn+/g, (this.kwargs['fs'] + "").padStart(zfill,"0"));
        }

        out += "\n*"
            + "\n*-- COPY DE ENTRADA/SALIDA"
            + "\n COPY QPIPCCAB."
            + "\n*"
            + "\n*-- COPY QUE UTILIZA EL MODULO DE ERRORES"
            + "\n COPY QPBTCXRR."
            + "\n*"
            + "\n*-- COPY QUE UTILIZA EL MODULO DE ESTADISTICAS"
            + "\n COPY QPBTCXTA."
            + "\n*"
            + "\n*-- COPY QUE UTILIZA EL MODULO DE FECHAS ESTANDAR"
            + "\n COPY QPIPCX30."
            + "\n*"
            + "\n*-- COPY DEL MODULO QUE OBTIENE EL CONTEXTO BATCH."
            + "\n COPY QPIPCX28."
            + "\n*"
            + this.kwargs['qpiprx36'][2]
            + this.kwargs['qpiprx35'][3]
            + this.kwargs['qpiprx37'][3]
            + this.kwargs['qpiprx38'][2]
            + this.kwargs['rearranque'][3]
            + this.kwargs['kitcc030'][3]
            + "\n*"
            + "\n*-- COPY DE CONSTANTES"
            + "\n COPY QPIPCCTE."
            + "\n*"
            + (this.kwargs['jcldb2'] == "0"?"\n*-- COPY DE LA RUTINA A LLAMAR":"")
            + (this.kwargs['jcldb2'] == "0"?"\n COPY UUAAC000.":"")
            + "\n******************************************************************"
            + "\n* INCLUDES DE TABLAS"
            + "\n******************************************************************"
            + "\n*";

        if (!((this.kwargs['table_rut']).indexOf("%") >= 0)) {

            out += "\n*"
            + "\n   EXEC SQL INCLUDE SQLCA END-EXEC."
            + "\n*"
            + "\n   EXEC SQL INCLUDE " + this.kwargs['table_rut'] + " END-EXEC.";

            if (this.kwargs['cursor'][5] != "") {
                out += "\n*\n******************************************************************"
                    + "\n* DECLARAR CURSORES DE TABLAS"
                    + "\n******************************************************************"
                    + "\n*"
                    + this.kwargs['cursor'][3];
            }

        }

        out += "\n*"
            + "\n******************************************************************"
            + "\n* PROCEDURE DIVISION"
            + "\n******************************************************************"
            + "\n PROCEDURE DIVISION."
            + "\n*"
            + "\n     PERFORM 100000-INICIO"
            + "\n*"
            + "\n     PERFORM 200000-PROCESO";

        var end_perform = "\n       UNTIL SI-FIN-F{}01E";
        if (this.kwargs['join'] == "11" || this.kwargs['join'] == "N1" || this.kwargs['join'] == "1N" || this.kwargs['join'] == "NM" || this.kwargs['join'] == "MN" || this.kwargs['join'] == "111") {
            end_perform = "\n       UNTIL SI-FIN-F{}01E\n         AND SI-FIN-F{}02E";
        }
        if (this.kwargs['join'] == "111") {
            end_perform += "\n         AND SI-FIN-F{}03E";
        }
        if (this.kwargs['fe'] > 0) {
            if ((this.kwargs['fe'] < 100) && (this.kwargs['fs'] < 100)) {
                end_perform = end_perform.replace(/{}+/g, this.control_UUAA(1) + this.kwargs['name'].substring(5));
            } else {
                end_perform = end_perform.replace(/{}+/g, this.control_UUAA(1) + "000");
            }
        } else {
            end_perform = "";
        }

        out += end_perform
            + "\n*"
            + "\n     PERFORM 300000-FIN"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 100000-INICIO"
            + "\n******************************************************************"
            + "\n 100000-INICIO."
            + "\n*"
            + "\n     INITIALIZE RETORNO-QPIPCCAB"
            + "\n                R-QPBTCXRR"
            + "\n                R-QPBTCXTA"
            + "\n                WS-VARIABLES"
            + "\n                CONTADORES\n"
            + this.repeat_text("                Cnn_")
            + "*"
            + "\n     MOVE ZEROES       TO WS-IND"
            + "\n*\n"
            + this.repeat_text("     SET NO-FIN-F" + this.control_UUAA(1) + "000nn_        TO TRUE", NaN, 0)
            + "*"
            + "\n     PERFORM 110000-DATOS-CONTEXTO-BATCH"
            + "\n     PERFORM 120000-ABRIR-FICHEROS"
            + this.kwargs['rearranque'][4]
            + "\n*\n*    ACCEPT WS-SYSIN        FROM SYSIN"
            + "\n"
            + this.repeat_text("     PERFORM 500000-LEER-F" + this.control_UUAA(1) + "000nn_", NaN, 0)
            + this.kwargs['lookfor'][4];

        if (this.kwargs['accumulate'] == "0" || this.kwargs['join'] == "MN") {
            out += "     MOVE WS-C01E       TO WS-C01A\n"
        }

        if (this.kwargs['join'] == "NM") {
            out += "     MOVE WS-C02E       TO WS-C02A\n"
        }

        if ((this.kwargs['fe'] < 100) && (this.kwargs['fs'] < 100)) {
            out += "     " + this.kwargs['rearranque'][6].replace(/{}+/g, this.control_UUAA(1) + this.kwargs['name'].substring(5));
        } else {
            out += "     " + this.kwargs['rearranque'][6].replace(/{}+/g, this.control_UUAA(1) + "000");
        }

        if (this.kwargs['copy_in'] != "") {
            out += "     MOVE WS-CAMP-NAME TO C01S"
                +  "\n     " + this.repeat_text("PERFORM 600000-ESCRIBIR-F" + this.control_UUAA(1) + "000nn_", 0, 1);
        }

        out += this.kwargs['record_counter'][0]
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 110000-DATOS-CONTEXTO-BATCH"
            + "\n******************************************************************"
            + "\n 110000-DATOS-CONTEXTO-BATCH."
            + "\n*"
            + "\n     PERFORM 110100-RECUPERAR-CONTEXTO"
            + "\n     PERFORM 800000-FECHA-SISTEMA"
            + "\n     MOVE WS-X26-FECHAHORA          TO WS-ACTUAL-FECHAHORA"
            + "\n     PERFORM 110200-MOVER-DATOS-ESTRUCTURA"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 110100-RECUPERAR-CONTEXTO"
            + "\n******************************************************************"
            + "\n 110100-RECUPERAR-CONTEXTO."
            + "\n*"
            + "\n     INITIALIZE RETORNO-QPIPCCAB"
            + "\n                R-QPIPCX28"
            + "\n*"
            + "\n     MOVE CTN-1                      TO COD-SERVICIO-QPIPCCAB"
            + "\n*"
            + "\n     CALL CTA-QPIPRX28 USING R-QPIPCCAB R-QPIPCX28"
            + "\n*"
            + "\n     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES"
            + "\n        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR"
            + "\n*"
            + "\n        PERFORM 999999-FIN-ERROR"
            + "\n     END-IF"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 110200-MOVER-DATOS-ESTRUCTURA"
            + "\n******************************************************************"
            + "\n 110200-MOVER-DATOS-ESTRUCTURA."
            + "\n*"
            + "\n     INITIALIZE RETORNO-QPIPCCAB"
            + "\n                R-QPBTCXTA"
            + "\n*"
            + "\n     MOVE COD-PGMBATCH-QPIPCX28     TO COD-PROGRAMA-QPIPCCAB"
            + "\n     MOVE COD-PGMBATCH-QPIPCX28     TO COD-APLICACI-QPIPCCAB"
            + "\n     MOVE WS-X08-FECHA              TO FEC-CONTABLE-QPIPCCAB"
            + "\n     MOVE WS-X08-FECHA              TO FEC-PROCESO-QPIPCCAB"
            + "\n     MOVE WS-X10-HORA               TO HMS-PROCESO-QPIPCCAB"
            + "\n     MOVE COD-PAISOALF-QPIPCX28     TO COD-PAIS-QPIPCCAB"
            + "\n     MOVE COD-ENTIALFA-QPIPCX28     TO COD-BANCO-QPIPCCAB"
            + "\n     MOVE COD-MAQUINA-QPIPCX28      TO COD-PUESTO-QPIPCCAB"
            + "\n     MOVE COD-IDISOALF-QPIPCX28     TO COD-IDIOMA-QPIPCCAB"
            + "\n     MOVE COD-JOBNAME-QPIPCX28      TO COD-USUARIO-QPIPCCAB"
            + "\n     MOVE COD-ENTIALFA-QPIPCX28     TO COD-BANCO-OPER-QPIPCCAB"
            + "\n     MOVE CTA-S                     TO XSN-BATCH-QPIPCCAB"
            + "\n*"
            + "\n     MOVE COD-PAISOALF-QPIPCX28     TO COD-PAIS-QPBTCXTA"
            + "\n     MOVE COD-ENTIALFA-QPIPCX28     TO COD-ENTIDAD-QPBTCXTA"
            + "\n     MOVE COD-PGMBATCH-QPIPCX28     TO COD-APLICACI-QPBTCXTA"
            + "\n     MOVE COD-JOBNAME-QPIPCX28      TO COD-JOBNAME-QPBTCXTA"
            + "\n     MOVE COD-PGMBATCH-QPIPCX28     TO COD-PROGRAMA-QPBTCXTA"
            + "\n     MOVE WS-X10-HORA               TO HMS-HORAINI-QPBTCXTA"
            + "\n     MOVE WS-X08-FECHA              TO FEC-FECHAINI-QPBTCXTA"
            + "\n*"
            + "\n     MOVE ZEROS                 TO WS-IND";

        var num_fe = parseInt(this.kwargs['fe'], 10);
        var num_fs = parseInt(this.kwargs['fs'], 10);
        if (num_fe >= 10) {
            num_fe = 10;
            num_fs = 0;
        } else {
            if ((num_fe + num_fs) >= 10) {
                num_fs = 10 - num_fe;
            }
        }

        out += this.repeat_text("\n     ADD  CTN-1                 TO WS-IND\n"
            + "     MOVE CTA-__            TO XTI-ENTSAL-QPBTCXTA(WS-IND)\n"
            + "     MOVE CTA-F" + this.control_UUAA(1) + "000nn_          TO COD-ORIGEN-QPBTCXTA(WS-IND)\n"
            + "     MOVE CTA-DES-F" + this.control_UUAA(1) + "000nn_      TO DES-ORIGEN-QPBTCXTA(WS-IND)", num_fe, num_fs)
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 120000-ABRIR-FICHEROS"
            + "\n******************************************************************"
            + "\n 120000-ABRIR-FICHEROS."
            + "\n*\n";

        if (this.kwargs['fe'] >= 1) {
            out += "     OPEN " + this.repeat_text("___  F" + this.control_UUAA(1) + "000nn_", NaN, 0);
        }
        if (this.kwargs['fs'] >= 1) {
            if (this.kwargs['fe'] >= 1) {
                out += "          " + this.repeat_text("___ F" + this.control_UUAA(1) + "000nn_", 0, NaN);
            } else {
                out += "     OPEN " + this.repeat_text("___ F" + this.control_UUAA(1) + "000nn_", 0, NaN);
            }
        }

        out += this.repeat_text("\n     IF FS-F" + this.control_UUAA(1) + "000nn_ NOT EQUAL ZEROS\n"
            + "        MOVE CTA-120000-A            TO WS-PARRAFO\n"
            + "        MOVE CTA-OPEN                TO WS-ACCESO\n"
            + "        MOVE CTA-F" + this.control_UUAA(1) + "000nn_            TO WS-TABLA\n"
            + "        MOVE FS-F" + this.control_UUAA(1) + "000nn_             TO WS-FILE-STATUS\n"
            + "*\n"
            + "        SET ERROR-FILE               TO TRUE\n"
            + "*\n"
            + "        PERFORM 999999-FIN-ERROR\n"
            + "     END-IF");

        if (this.kwargs['fe'] == 0 && this.kwargs['fs'] == 0)
            out += "\n     CONTINUE\n";

        out += "     ."
            + this.kwargs['lookfor'][5]
            + "\n*"
            + "\n******************************************************************"
            + "\n* 200000-PROCESO"
            + "\n******************************************************************"
            + "\n 200000-PROCESO."
            + "\n*\n";

        if (this.kwargs['jcldb2'] == "0") {
            out += "\n     INITIALIZE RETORNO-QPIPCCAB"
                +  "\n                C000-UUAAC000"
                +  "\n* [... MOVES]"
                +  "\n"
                +  "\n* [... MOVES]"
                +  "\n     CALL 'UUAAR000' USING R-QPIPCCAB C000-UUAAC000 "
                +  "\n*"
                +  "\n     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES"
                +  "\n        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR"
                +  "\n*"
                +  "\n        PERFORM 999999-FIN-ERROR"
                +  "\n     END-IF";
        }

        if (this.kwargs['copy_in'] != "") {
            out += "     MOVE CORR C01E TO WS-C01S"
                +  "\n     MOVE WS-C01S   TO C01S"
                +  "\n     " + this.repeat_text("PERFORM 600000-ESCRIBIR-F" + this.control_UUAA(1) + "000nn_", 0, 1);
        }
        if (this.kwargs['accumulate'] == "0") {
            out += "*    ADD C01E           TO [...] OF WS-ACUM";
        }

        var proceso_perform = "";
        if (this.kwargs['join'] == "11") {
            proceso_perform = "\n     IF WS-C01E EQUAL WS-C02E"
                            + "\n*-"
                            + "\n*-"
                            + "\n        " + this.kwargs['rearranque'][6]
                            + "\n        PERFORM 500000-LEER-F{}01E"
                            + "\n        PERFORM 500000-LEER-F{}02E"
                            + "\n     ELSE"
                            + "\n        IF WS-C01E LESS WS-C02E"
                            + "\n*-"
                            + "\n*-"
                            + "\n            " + this.kwargs['rearranque'][6]
                            + "\n            PERFORM 500000-LEER-F{}01E"
                            + "\n        ELSE"
                            + "\n*-"
                            + "\n*-"
                            + "\n            PERFORM 500000-LEER-F{}02E"
                            + "\n        END-IF"
                            + "\n     END-IF";
        } else if (this.kwargs['join'] == "N1") {
            proceso_perform = "\n     IF WS-C01E EQUAL WS-C02E"
                            + "\n        PERFORM UNTIL (WS-C01E NOT EQUAL WS-C02E)"
                            + "\n                   OR (SI-FIN-F{}01E)"
                            + "\n*-"
                            + "\n*-"
                            + "\n            " + this.kwargs['rearranque'][6]
                            + "\n            PERFORM 500000-LEER-F{}01E"
                            + "\n        END-PERFORM"
                            + "\n*-"
                            + "\n*-"
                            + "\n        PERFORM 500000-LEER-F{}02E"
                            + "\n     ELSE"
                            + "\n        IF WS-C01E LESS WS-C02E"
                            + "\n*-"
                            + "\n*-"
                            + "\n            " + this.kwargs['rearranque'][6]
                            + "\n            PERFORM 500000-LEER-F{}01E"
                            + "\n        ELSE"
                            + "\n*-"
                            + "\n*-"
                            + "\n            PERFORM 500000-LEER-F{}02E"
                            + "\n        END-IF"
                            + "\n     END-IF";
        } else if (this.kwargs['join'] == "1N") {
            proceso_perform = "\n     IF WS-C01E EQUAL WS-C02E"
                            + "\n        PERFORM UNTIL (WS-C01E NOT EQUAL WS-C02E)"
                            + "\n                   OR (SI-FIN-F{}02E)"
                            + "\n*-"
                            + "\n*-"
                            + "\n            PERFORM 500000-LEER-F{}02E"
                            + "\n        END-PERFORM"
                            + "\n*-"
                            + "\n*-"
                            + "\n        " + this.kwargs['rearranque'][6]
                            + "\n        PERFORM 500000-LEER-F{}01E"
                            + "\n     ELSE"
                            + "\n        IF WS-C01E LESS WS-C02E"
                            + "\n*-"
                            + "\n*-"
                            + "\n            PERFORM 500000-LEER-F{}01E"
                            + "\n        ELSE"
                            + "\n*-"
                            + "\n*-"
                            + "\n            PERFORM 500000-LEER-F{}02E"
                            + "\n        END-IF"
                            + "\n     END-IF";
        } else if (this.kwargs['join'] == "NM") {
            proceso_perform = "\n     IF WS-C01E EQUAL WS-C02E"
                            + "\n*"
                            + "\n        PERFORM UNTIL (WS-C02E NOT EQUAL WS-C02A)"
                            + "\n                   OR (SI-FIN-F{}02E)"
                            + "\n"
                            + "\n            ADD  CTN-1  TO TB-F{}02E-LENGTH"
                            + "\n            MOVE C02E   TO T02E(TB-F{}02E-LENGTH)"
                            + "\n            PERFORM 500000-LEER-F{}02E"
                            + "\n"
                            + "\n        END-PERFORM"
                            + "\n"
                            + "\n        MOVE CORR T02E(CTN-1)  TO WS-C02T"
                            + "\n"
                            + "\n        PERFORM UNTIL (WS-C01E NOT EQUAL WS-C02T)"
                            + "\n                OR (SI-FIN-F{}01E)"
                            + "\n"
                            + "\n            PERFORM VARYING WS-IND FROM CTN-1 BY CTN-1"
                            + "\n                      UNTIL WS-IND GREATER TB-F{}02E-LENGTH"
                            + "\n"
                            + "\n                MOVE CORR T02E(WS-IND)  TO WS-C02T"
                            + "\n*-"
                            + "\n*-"
                            + "\n            END-PERFORM"
                            + "\n"
                            + "\n            " + this.kwargs['rearranque'][6]
                            + "\n            PERFORM 500000-LEER-F{}01E"
                            + "\n        END-PERFORM"
                            + "\n*-"
                            + "\n*-"
                            + "\n        INITIALIZE TABLA-F{}02E"
                            + "\n        MOVE WS-C02E    TO WS-C02A"
                            + "\n     ELSE"
                            + "\n        IF WS-C01E LESS WS-C02E"
                            + "\n*-"
                            + "\n*-"
                            + "\n            " + this.kwargs['rearranque'][6]
                            + "\n            PERFORM 500000-LEER-F{}01E"
                            + "\n        ELSE"
                            + "\n*-"
                            + "\n*-"
                            + "\n            PERFORM 500000-LEER-F{}02E"
                            + "\n            MOVE WS-C02E    TO WS-C02A"
                            + "\n        END-IF"
                            + "\n     END-IF";
        } else if (this.kwargs['join'] == "MN") {
            proceso_perform = "\n     IF WS-C01E EQUAL WS-C02E"
                            + "\n*"
                            + "\n        PERFORM UNTIL (WS-C01E NOT EQUAL WS-C01A)"
                            + "\n                   OR (SI-FIN-F{}01E)"
                            + "\n"
                            + "\n            ADD  CTN-1  TO TB-F{}01E-LENGTH"
                            + "\n            MOVE C01E   TO T01E(TB-F{}01E-LENGTH)"
                            + "\n            " + this.kwargs['rearranque'][6]
                            + "\n            PERFORM 500000-LEER-F{}01E"
                            + "\n"
                            + "\n        END-PERFORM"
                            + "\n"
                            + "\n        MOVE CORR T01E(CTN-1)  TO WS-C01T"
                            + "\n"
                            + "\n        PERFORM UNTIL (WS-C01T NOT EQUAL WS-C02E)"
                            + "\n                   OR (SI-FIN-F{}02E)"
                            + "\n"
                            + "\n            PERFORM VARYING WS-IND FROM CTN-1 BY CTN-1"
                            + "\n                      UNTIL WS-IND GREATER TB-F{}01E-LENGTH"
                            + "\n"
                            + "\n                MOVE CORR T01E(WS-IND)  TO WS-C01T"
                            + "\n*-"
                            + "\n*-"
                            + "\n            END-PERFORM"
                            + "\n"
                            + "\n            PERFORM 500000-LEER-F{}02E"
                            + "\n        END-PERFORM"
                            + "\n*-"
                            + "\n*-"
                            + "\n        INITIALIZE TABLA-F{}01E"
                            + "\n        MOVE WS-C01E    TO WS-C01A"
                            + "\n     ELSE"
                            + "\n        IF WS-C01E LESS WS-C02E"
                            + "\n*-"
                            + "\n*-"
                            + "\n            " + this.kwargs['rearranque'][6]
                            + "\n            PERFORM 500000-LEER-F{}01E"
                            + "\n            MOVE WS-C01E    TO WS-C01A"
                            + "\n        ELSE"
                            + "\n*-"
                            + "\n*-"
                            + "\n            PERFORM 500000-LEER-F{}02E"
                            + "\n        END-IF"
                            + "\n     END-IF";
        } else if (this.kwargs['join'] == "111") {
            proceso_perform = "\n        EVALUATE TRUE"
                            + "\n            WHEN (WS-C01E EQUAL WS-C02E)"
                            + "\n             AND (WS-C02E EQUAL WS-C03E)"
                            + "\n*-"
                            + "\n*-"
                            + "\n                " + this.kwargs['rearranque'][6]
                            + "\n                PERFORM 500000-LEER-F{}01E"
                            + "\n                PERFORM 500000-LEER-F{}02E"
                            + "\n                PERFORM 500000-LEER-F{}03E"
                            + "\n            WHEN WS-C01E LESS WS-C02E"
                            + "\n*-"
                            + "\n*-"
                            + "\n                " + this.kwargs['rearranque'][6]
                            + "\n                PERFORM 500000-LEER-F{}01E"
                            + "\n            WHEN WS-C03E LESS WS-C02E"
                            + "\n*-"
                            + "\n*-"
                            + "\n                PERFORM 500000-LEER-F{}03E"
                            + "\n            WHEN WS-C01E GREATER WS-C02E"
                            + "\n*-"
                            + "\n*-"
                            + "\n                " + this.kwargs['rearranque'][6]
                            + "\n                PERFORM 500000-LEER-F{}01E"
                            + "\n                PERFORM 500000-LEER-F{}02E"
                            + "\n            WHEN WS-C03E GREATER WS-C02E"
                            + "\n*-"
                            + "\n*-"
                            + "\n                PERFORM 500000-LEER-F{}02E"
                            + "\n                PERFORM 500000-LEER-F{}03E"
                            + "\n        END-EVALUATE";
        } else {
            if (this.kwargs['fe'] >= 1) {
                proceso_perform = "\n     " + this.kwargs['rearranque'][6] + "\n     PERFORM 500000-LEER-F{}01E";
            }
        }

        if ((this.kwargs['fe'] < 100) && (this.kwargs['fs'] < 100)) {
            proceso_perform = proceso_perform.replace(/{}+/g, this.control_UUAA(1) + this.kwargs['name'].substring(5));
        } else {
            proceso_perform = proceso_perform.replace(/{}+/g, this.control_UUAA(1) + "000");
        }

        out += proceso_perform;

        if (this.kwargs['accumulate'] == "0") {
            out += "\n*    IF WS-C01E NOT EQUAL WS-C01A"
                + "\n*       PERFORM 600000-ESCRIBIR-F{}01S".replace(/{}+/g, this.control_UUAA(1) + ((this.kwargs['fe'] < 100 && this.kwargs['fs'] < 100)?this.kwargs['name'].substring(5):""))
                + "\n*       MOVE WS-C01E    TO WS-C01A"
                + "\n*       INITIALIZE WS-ACUM"
                + "\n*    END-IF";
        }

        out += this.kwargs['record_counter'][1]
            + "\n     ."
            + this.kwargs['media'][4]
            + this.kwargs['compare_files'][5]
            + "\n*"
            + "\n******************************************************************"
            + "\n* 300000-FIN"
            + "\n******************************************************************"
            + "\n 300000-FIN."
            + "\n*"
            + this.kwargs['rearranque'][7]
            + "\n     PERFORM 310000-ESTADISTICAS"
            + "\n     PERFORM 320000-CERRAR-FICHEROS"
            + "\n*"
            + "\n     STOP RUN"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 310000-ESTADISTICAS"
            + "\n******************************************************************"
            + "\n 310000-ESTADISTICAS."
            + "\n*"
            + "\n     PERFORM 800000-FECHA-SISTEMA"
            + "\n*"
            + "\n     MOVE WS-X10-HORA      TO HMS-HORAFIN-QPBTCXTA"
            + "\n     MOVE WS-X08-FECHA     TO FEC-FECHAFIN-QPBTCXTA"
            + "\n*"
            + "\n     MOVE ZEROS                 TO WS-IND\n";

        var num_fe = parseInt(this.kwargs['fe'], 10);
        var num_fs = parseInt(this.kwargs['fs'], 10);
        if (num_fe >= 10) {
            num_fe = 10;
            num_fs = 0;
        } else {
            if ((num_fe + num_fs) >= 10) {
                num_fs = 10 - num_fe;
            }
        }

        out += this.repeat_text("     ADD  CTN-1                 TO WS-IND\n"
            + "     MOVE C-REG-F" + this.control_UUAA(1) + "000nn_        TO QNU-PROCES-QPBTCXTA(WS-IND)", num_fe, num_fs)
            + "*"
            + "\n     CALL CTA-QPBTRXTA USING R-QPIPCCAB R-QPBTCXTA"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 320000-CERRAR-FICHEROS"
            + "\n******************************************************************"
            + "\n 320000-CERRAR-FICHEROS."
            + "\n*";

        if (this.kwargs['fe'] == 0 && this.kwargs['fs'] == 0) {
            out += "\n     CONTINUE\n";
        } else {
            out += "\n     CLOSE " + this.repeat_text("           F" + this.control_UUAA(1) + "000nn_").substring(11)
                + this.repeat_text("\n     IF FS-F" + this.control_UUAA(1) + "000nn_ NOT EQUAL ZEROS\n"
                + "        MOVE CTA-320000-C            TO WS-PARRAFO\n"
                + "        MOVE CTA-CLOSE               TO WS-ACCESO\n"
                + "        MOVE CTA-F" + this.control_UUAA(1) + "000nn_            TO WS-TABLA\n"
                + "        MOVE FS-F" + this.control_UUAA(1) + "000nn_             TO WS-FILE-STATUS\n"
                + "*\n"
                + "        SET ERROR-FILE               TO TRUE\n"
                + "*\n"
                + "        PERFORM 999999-FIN-ERROR\n"
                + "     END-IF");
        }


        out += "     ."
            + this.kwargs['rearranque'][8] + "\n";

        if (!((this.kwargs['table_rut']).indexOf("%") >= 0)) {

            out += "\n*"
                + "\n******************************************************************"
                + "\n* 400000-INFORMAR-DCLGEN"
                + "\n******************************************************************"
                + "\n 400000-INFORMAR-DCLGEN."
                + "\n*"
                + "\n     ."
                + "\n******************************************************************"
                + "\n* 500000-RETORNAR-CONSULTA"
                + "\n******************************************************************"
                + "\n 500000-RETORNAR-CONSULTA."
                + "\n*"
                + "\n     ADD  CTN-1                        TO WS-IND"
                + "\n*"
                + "\n     ."
                + this.kwargs['insert'][4]
                + this.kwargs['delete'][4]
                + this.kwargs['update'][4]
                + this.kwargs['select'][4]
                + this.kwargs['cursor'][5];
        }

        out += this.repeat_text("*\n"
            + "******************************************************************\n"
            + "* 500000-LEER-F" + this.control_UUAA(1) + "000nn_\n"
            + "******************************************************************\n"
            + " 500000-LEER-F" + this.control_UUAA(1) + "000nn_.\n"
            + "*\n"
            + "     INITIALIZE Cnn_\n"
            + "*\n"
            + "     READ F" + this.control_UUAA(1) + "000nn_ INTO Cnn_\n"
            + "        AT END\n"
            + "            SET SI-FIN-F" + this.control_UUAA(1) + "000nn_       TO TRUE\n"
            + "*-\n"
            + "            {}\n"
            + "            {rea0}\n"
            + "*-\n"
            + "        NOT AT END\n"
            + "            IF FS-F" + this.control_UUAA(1) + "000nn_ EQUAL ZEROS\n"
            + "                ADD CTN-1            TO C-REG-F" + this.control_UUAA(1) + "000nn_\n"
            + "*-\n"
            + "                {clv}\n"
            + "                {rea1}\n"
            + "*-\n"
            + "            ELSE\n"
            + "                MOVE CTA-500000-L    TO WS-PARRAFO\n"
            + "                MOVE CTA-READ        TO WS-ACCESO\n"
            + "                MOVE CTA-F" + this.control_UUAA(1) + "000nn_    TO WS-TABLA\n"
            + "                MOVE FS-F" + this.control_UUAA(1) + "000nn_     TO WS-FILE-STATUS\n"
            + "*\n"
            + "                SET ERROR-FILE       TO TRUE\n"
            + "*\n"
            + "                PERFORM 999999-FIN-ERROR\n"
            + "            END-IF\n"
            + "     END-READ\n"
            + "     .", NaN, 0)
            + this.repeat_text("*\n"
            + "******************************************************************\n"
            + "* 600000-ESCRIBIR-F" + this.control_UUAA(1) + "000nn_\n"
            + "******************************************************************\n"
            + " 600000-ESCRIBIR-F" + this.control_UUAA(1) + "000nn_.\n"
            + "*\n"
            + "     WRITE RG-F" + this.control_UUAA(1) + "000nn_ FROM Cnn_\n"
            + "*\n"
            + "     IF FS-F" + this.control_UUAA(1) + "000nn_ EQUAL ZEROS\n"
            + "        ADD CTN-1                    TO C-REG-F" + this.control_UUAA(1) + "000nn_\n"
            + "        INITIALIZE Cnn_\n"
            + "*\n"
            + "     ELSE\n"
            + "        MOVE CTA-600000-E            TO WS-PARRAFO\n"
            + "        MOVE CTA-WRITE               TO WS-ACCESO\n"
            + "        MOVE CTA-F" + this.control_UUAA(1) + "000nn_            TO WS-TABLA\n"
            + "        MOVE FS-F" + this.control_UUAA(1) + "000nn_             TO WS-FILE-STATUS\n"
            + "*\n"
            + "        SET ERROR-FILE               TO TRUE\n"
            + "*\n"
            + "        PERFORM 999999-FIN-ERROR\n"
            + "     END-IF\n"
            + "     .", 0, NaN)
            + "*"
            + "\n******************************************************************"
            + "\n* 800000-FECHA-SISTEMA"
            + "\n******************************************************************"
            + "\n 800000-FECHA-SISTEMA."
            + "\n*"
            + "\n     INITIALIZE RETORNO-QPIPCCAB"
            + "\n                R-QPIPCX30"
            + "\n*"
            + "\n     MOVE CTN-4                        TO COD-SERVICIO-QPIPCCAB"
            + "\n*"
            + "\n     CALL CTA-QPIPRX30 USING R-QPIPCCAB R-QPIPCX30"
            + "\n*"
            + "\n     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES"
            + "\n        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR"
            + "\n*"
            + "\n        PERFORM 999999-FIN-ERROR"
            + "\n     END-IF"
            + "\n"
            + "\n     MOVE FEC-SIS4-QPIPCX30         TO WS-X26-FECHAHORA"
            + "\n     MOVE CORR WS-X10-FECHA         TO WS-X08-FECHA"
            + "\n     MOVE CORR WS-X13-HORA          TO WS-X10-HORA"
            + "\n     ."
            + "\n*"
            + this.kwargs['qpiprx36'][3]
            + this.kwargs['qpiprx37'][4]
            + this.kwargs['qpiprx38'][3]
            + this.kwargs['qpiprx35'][4]
            + this.kwargs['to_number'][1]
            + this.kwargs['chopped'][2]
            + this.kwargs['lookfor'][6]
            + this.kwargs['lookforoutfile'][2]
            + this.kwargs['cadena_valida'][2]
            + this.kwargs['date_day'][2]
            + this.kwargs['kitcc030'][4]
            + "\n*"
            + "\n******************************************************************"
            + "\n* 900000-INFORMAR-ERROR-FILE"
            + "\n******************************************************************"
            + "\n 900000-INFORMAR-ERROR-FILE."
            + "\n*"
            + "\n     MOVE CTA-F                      TO XTI-AVIERROR-QPIPCCAB"
            + "\n     MOVE WS-FILE-STATUS             TO COD-AVIERROR-QPIPCCAB"
            + "\n     MOVE WS-ACCESO                  TO COD-ACCESO-ERR-QPIPCCAB"
            + "\n     MOVE WS-TABLA                   TO COD-TABLA-ERR-QPIPCCAB"
            + "\n     MOVE WS-DES-SQLCA               TO DES-SQLCA-ERR-QPIPCCAB"
            + "\n     MOVE WS-PARRAFO                 TO COD-PARRAFO-ERR-QPIPCCAB"
            + "\n     MOVE CTA-" + this.kwargs['name'] + "               TO COD-MODULO-ERR-QPIPCCAB"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 910000-INFORMAR-ERROR"
            + "\n******************************************************************"
            + "\n 910000-INFORMAR-ERROR."
            + "\n*"
            + "\n     PERFORM VARYING WS-IND FROM CTN-1 BY CTN-1"
            + "\n               UNTIL WS-IND GREATER CTN-10"
            + "\n                  OR XTI-ENTSAL-QPBTCXRR(WS-IND) EQUAL SPACES"
            + "\n        MOVE DATOS-QPBTCXTA(WS-IND) TO ESTADO-QPBTCXRR(WS-IND)"
            + "\n     END-PERFORM"
            + "\n*"
            + "\n     MOVE ZEROS                 TO WS-IND\n";

        var num_fe = parseInt(this.kwargs['fe'], 10);
        var num_fs = parseInt(this.kwargs['fs'], 10);
        if (num_fe >= 10) {
            num_fe = 10;
            num_fs = 0;
        } else {
            if ((num_fe + num_fs) >= 10) {
                num_fs = 10 - num_fe;
            }
        }

        out += this.repeat_text("     ADD  CTN-1                 TO WS-IND\n"
            + "     MOVE C-REG-F" + this.control_UUAA(1) + "000nn_        TO QNU-PROCES-QPBTCXRR(WS-IND)", num_fe, num_fs)
            + "     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 999999-FIN-ERROR"
            + "\n******************************************************************"
            + "\n 999999-FIN-ERROR."
            + "\n*"
            + "\n     INITIALIZE R-QPBTCXRR"
            + "\n*"
            + "\n     MOVE CTA-" + this.kwargs['name'] + "                 TO COD-PROGRAMA-QPIPCCAB"
            + "\n     MOVE CTA-" + this.kwargs['name'].substring(0,4) + "                     TO COD-APLICACI-QPIPCCAB"
            + "\n*"
            + "\n     IF ERROR-FILE AND COD-AVIERROR-QPIPCCAB LESS 100"
            + "\n        PERFORM 900000-INFORMAR-ERROR-FILE"
            + "\n     ELSE"
            + "\n        MOVE SW-TIPO-ERROR             TO XTI-AVIERROR-QPIPCCAB"
            + "\n     END-IF"
            + "\n*";

        if (!((this.kwargs['table_rut']).indexOf("%") >= 0)) {

            out += "\n     IF SQLCODE NOT EQUAL ZEROS"
                + "\n        MOVE CTA-" + this.kwargs['name'] + " TO COD-MODULO-ERR-QPIPCCAB"
                + "\n        MOVE CTA-" + this.kwargs['table_rut'] + " TO COD-TABLA-ERR-QPIPCCAB"
                + "\n        MOVE SQLCODE      TO QNU-SQLCODE-ERR-QPIPCCAB"
                + "\n        MOVE SQLCA        TO DES-SQLCA-ERR-QPIPCCAB"
                + "\n     END-IF";

        }

        out += "\n     PERFORM 910000-INFORMAR-ERROR"
            + "\n*"
            + "\n     CALL CTA-QPBTRXRR USING R-QPIPCCAB R-QPBTCXRR"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n*                       FIN DEL PROGRAMA"
            + "\n******************************************************************";

        return out;
    }
/* Genera el jcl con los datos pasados */
    jcl() {
        var out = "";

        out += "//" + this.kwargs['name'].substring(0,4) + "J000 JOB (OPC0,001),'" + this.kwargs['name'].substring(0,4) + "J000',REGION=0M,TIME=1440,"
            + "\n//         CLASS=" + this.control_UUAA(0) + ",MSGCLASS=J,MSGLEVEL=(1,1),COND=(4,LT),"
            + "\n//         PERFORM=11"
            + "\n//*PROJCL [" + this.kwargs['date'][3] + " - XE000000]"
            + "\n//*PAQUETE ZMF " + this.kwargs['name'].substring(0,4) + "000000"
            + "\n//*OBPARM S=TC02"
            + "\n//*"
            + "\n//LIBPROC  JCLLIB ORDER=('EBPEXPR.PDSB111Z.PROCLIB','EX.PROCLIB',"
            + "\n//            'EX.EXPDS111.PROCLIB')"
            + "\n//*"
            + "\n//*"
            + "\n//*%OPC SCAN"
            + "\n//*%OPC SETFORM OCFRSTC=(CCYYMMDD)"
            + "\n//*%OPC SETFORM CTIME=(HHMM00)"
            + "\n//*%OPC SETVAR TFECHA=(OCFRSTC - 1CD),PHASE=SETUP"
            + "\n//*%OPC SETFORM OCDATE=(CCYYMMDD)"
            + "\n//*"
            + "\n//INCLUDE1 INCLUDE MEMBER=BLIJDS0E"
            + "\n//INCLUDE1 INCLUDE MEMBER=DDNOONLE"
            + "\n//*--------------------------------------------------------------------*"
            + "\n//**********************************************************************"
            + "\n//*               DESCRIPCION DEL JCL"
            + "\n//*               -------------------"
            + "\n//*   FECHA       : " + this.kwargs['date'][2]
            + "\n//*   COMENTARIOS :"
            + "\n//*"
            + "\n//**********************************************************************"
            + "\n//**********************************************************************"
            + "\n//* BORRAR FICHEROS DEL PROCESO"
            + "\n//**********************************************************************"
            + "\n//BORRAR   EXEC PROC=EXPRP21P"
            + "\n//SYSPRINT DD SYSOUT=*"
            + "\n//SYSIN    DD *"
            + "\n\n  DELETE " + this.control_UUAA(2) + this.kwargs['name'].substring(0,4) + "J000.** MASK"
            + "\n\n  SET MAXCC = 0"
            + "\n/*\n";

        if (this.kwargs['join'] != "" && this.kwargs['join'] != "111" && this.kwargs['accumulate'] != "0") {
            out += this.repeat_text("//**********************************************************************"
                + "\n//* ORDENACION DE {desc}. PGM: " + this.kwargs['name'] + ", COPY: {copy}"
                + "\n//**********************************************************************"
                + "\n//SORT000 EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                + "\n//SORTIN   DD DSN=%%%%%%%%,DISP=SHR"
                + "\n//SORTOUT  DD DSN=" + this.control_UUAA(2) + this.kwargs['name'].substring(0,4) + "J000.F" + this.control_UUAA(1) + "000nnE,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL={length})"
                + "\n//SYSOUT   DD SYSOUT=*"
                + "\n//SYSIN    DD *"
                + "\n  SORT FIELDS=(0,0,CH,A)"
                + "\n/*", 2, 0);
        }
        
        if (this.kwargs['join'] == "111" && this.kwargs['accumulate'] != "0") {
            out += this.repeat_text("//**********************************************************************"
                + "\n//* ORDENACION DE {desc}. PGM: " + this.kwargs['name'] + ", COPY: {copy}"
                + "\n//**********************************************************************"
                + "\n//SORT000 EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                + "\n//SORTIN   DD DSN=%%%%%%%%,DISP=SHR"
                + "\n//SORTOUT  DD DSN=" + this.control_UUAA(2) + this.kwargs['name'].substring(0,4) + "J000.F" + this.control_UUAA(1) + "000nnE,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL={length})"
                + "\n//SYSOUT   DD SYSOUT=*"
                + "\n//SYSIN    DD *"
                + "\n  SORT FIELDS=(0,0,CH,A)"
                + "\n/*", 3, 0);
        }

        if (this.kwargs['join'] == "" && this.kwargs['accumulate'] == "0") {
            out += this.repeat_text("//**********************************************************************"
                + "\n//* ORDENACION DE {desc}. PGM: " + this.kwargs['name'] + ", COPY: {copy}"
                + "\n//**********************************************************************"
                + "\n//SORT000 EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                + "\n//SORTIN   DD DSN=%%%%%%%%,DISP=SHR"
                + "\n//SORTOUT  DD DSN=" + this.control_UUAA(2) + this.kwargs['name'].substring(0,4) + "J000.F" + this.control_UUAA(1) + "000nnE,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL={length})"
                + "\n//SYSOUT   DD SYSOUT=*"
                + "\n//SYSIN    DD *"
                + "\n  SORT FIELDS=(0,0,CH,A)"
                + "\n/*", 1, 0);
        }

        out += "//**********************************************************************"
            + "\n//* " + this.kwargs['desc']
            + "\n//**********************************************************************"
            + "\n//" + this.kwargs['name'] + " EXEC PROC=EXPRP0" + (this.kwargs['jcldb2'] == "0"?"2P,SSID='DS0E'":"1P,PRG=" + this.kwargs['name'])
            + "\n" + this.repeat_text("//F" + this.control_UUAA(1) + "000nn_ DD DSN=" + this.control_UUAA(2) + this.kwargs['name'].substring(0,4) + "J000.F" + this.control_UUAA(1) + "000nn_,DISP=SHR", NaN, 0)
            + this.repeat_text("//F" + this.control_UUAA(1) + "000nn_ DD DSN=" + this.control_UUAA(2) + this.kwargs['name'].substring(0,4) + "J000.F" + this.control_UUAA(1) + "000nn_,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=F" + this.control_UUAA(1) + ",BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL={length})", 0, NaN)
            + "//SYSPRINT DD SYSOUT=*"
            + "\n//SYSOUT   DD SYSOUT=*"
            + "\n//SYSABOUT DD SYSOUT=4,DEST=JESTC3"
            + "\n//SYSDBOUT DD SYSOUT=4,DEST=JESTC3"
            + "\n//CEEDUMP  DD SYSOUT=4,DEST=JESTC3"
            + "\n//SYSTSPRT DD SYSOUT=*"
            + "\n//SYSIN    DD *"
            + "\n"
            + this.kwargs['rearranque'][9]
            + "\n//SYSTSIN  DD *"
            + (this.kwargs['jcldb2'] == "0"?"\n  DSN SYSTEM(DS0E)\n    RUN PROGRAM(" + this.kwargs['name'] + ") PLAN(" + this.control_UUAA(3) + ")\n  END":"")
            + "\n/*";

        return out;
    }
/* Genera la boleta con los datos pasados */
    boleta() {
        var out = "";

        out += "//" + this.kwargs['name'] + " JOB (OPC0,001),'" + this.kwargs['name'] + "',MSGCLASS=J,TIME=1440,"
            + "\n//         MSGLEVEL=(1,1),CLASS=Z,REGION=0M,COND=(4,LT),"
            + "\n//         PERFORM=11"
            + "\n//*OBPARM S=TC02"
            + "\n//*"
            + "\n//LIBPROC  JCLLIB ORDER=('EBPEXPR.PDSB111Z.PROCLIB','EX.PROCLIB',"
            + "\n//         'EX.EXPDS111.PROCLIB')"
            + "\n//*"
            + "\n//*"
            + "\n//*%OPC SCAN"
            + "\n//*%OPC SETFORM OCFRSTC=(CCYYMMDD)"
            + "\n//*%OPC SETFORM CTIME=(HHMM00)"
            + "\n//*%OPC SETVAR TFECHA=(OCFRSTC - 1CD),PHASE=SETUP"
            + "\n//*%OPC SETFORM OCDATE=(CCYYMMDD)"
            + "\n//*"
            + "\n//INCLUDE1 INCLUDE MEMBER=BLIJDS0E"
            + "\n//INCLUDE1 INCLUDE MEMBER=DDNOONLE"
            + "\n//*--------------------------------------------------------------------*"
            + "\n//**********************************************************************"
            + "\n//* BORRADO FICHEROS TEMPORALES                                        *"
            + "\n//**********************************************************************"
            + "\n//BORRAR   EXEC PROC=EXPRP21P"
            + "\n//SYSPRINT DD SYSOUT=*"
            + "\n//SYSIN    DD *"
            + "\n\n  DELETE " + this.control_UUAA(2) + this.kwargs['name'] + ".** MASK"
            + "\n\n  SET MAXCC = 0"
            + "\n/*";

        if (this.kwargs['table'] != "TUUAA%%%") {

            if (this.kwargs['type_part'] == "npt") {
                out += "\n//**********************************************************************"
                    + "\n//* DESCARGA LA TABLA " + this.kwargs['table']
                    + "\n//**********************************************************************"
                    + "\n//UNLOAD   EXEC PROC=EXPRP42P,JOB='" + this.kwargs['name'] + "',QUIESCE=Y,SSID='DS0E'"
                    + "\n//SYSREC   DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + "." + this.kwargs['table'] + ","
                    + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                    + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)"
                    + "\n//SYSIN1 DD *"
                    + "\n  SELECT * FROM P" + this.kwargs['lib_uuaa'] + "." + this.kwargs['table']
                    + "\n/*";

                if (this.kwargs['carga'] == "0") {
                    out += "\n//**********************************************************************"
                         + "\n//** FUSIONA TODOS LOS FICHEROS DE GENERADOS ANTERIORMENTE"
                         + "\n//**********************************************************************"
                         + "\n//SORT001  EXEC PROC=EXPRP23P,EQUAL='EQUAL',VAR='256'"
                         + "\n//SORTIN   DD DSN=%%%%%%%%,DISP=SHR"
                         + "\n//         DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + "." + this.kwargs['table'] + ",DISP=SHR"
                         + "\n//SORTOUT  DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".L" + this.kwargs['table'].substring(1) + ","
                         + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                         + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)"
                         + "\n//SYSOUT   DD SYSOUT=*"
                         + "\n//SYSIN    DD *"
                         + "\n  SORT FIELDS=(" + this.kwargs['clv'] + ")"
                         + "\n  SUM FIELDS=NONE"
                         + "\n/*"
                         + "\n//**********************************************************************"
                         + "\n//** COMPRUEBA SI EL FICHERO GENERADO ESTA VACIO"
                         + "\n//**********************************************************************"
                         + "\n//PASO01   EXEC PROC=EXPRP20P"
                         + "\n//IN       DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".L" + this.kwargs['table'].substring(1) + ",DISP=SHR"
                         + "\n//P20.SYSIN DD *"
                         + "\n PRINT INFILE(IN) CHARACTER COUNT(1)"
                         + "\n IF LASTCC = 0  THEN SET MAXCC = 0"
                         + "\n IF LASTCC = 4  THEN SET MAXCC = 4"
                         + "\n/*"
                         + "\n//**********************************************************************"
                         + "\n//ACTUALIZ IF (PASO01.P20.RC = 0) THEN"
                         + "\n//**********************************************************************"
                         + "\n//* CARGA DE LA TABLA " + this.kwargs['table'] + ""
                         + "\n//**********************************************************************"
                         + "\n//CARGA" + this.kwargs['table'].substring(5) + " EXEC PROC=EXPRP43P,SSID='DS0E',JOB='" + this.kwargs['name'] + "',TB='" + this.kwargs['table'] + "'"
                         + "\n//P43.SYSREC   DD DSN=EBPUUAA.INPXD05X." + this.kwargs['name'] + ".L" + this.kwargs['table'].substring(1) + ","
                         + "\n//         DISP=SHR"
                         + "\n/*"
                         + "\n//ACTUALIZ ENDIF"
                         + "\n/*"
                         + "\n//**********************************************************************";
                }

            } else if (this.kwargs['type_part'] == "spt") {

                out += "\n//**********************************************************************"
                    + "\n//* OBTIENE LA PARTICION Y LA SETENCIA SQL"
                    + "\n//**********************************************************************"
                    + "\n//SORT000  EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                    + "\n//SORTIN   DD *"
                    + "\n"
                    + "\n//SORTO00  DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".SELCT" + this.kwargs['table'].substring(5) + ","
                    + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                    + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                    + "\n//            LRECL=80)"
                    + "\n" + this.repeat_text("//UNLyymm  DD DSN=" + this.control_UUAA(2) + "{name}.UNLOyymm,\n"
                        + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                        + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                        + "//            LRECL=80)");
                if (this.kwargs['carga'] == "0") {
                    if ("TEYRGOSL|TEYRGGOP|TEYRGOGE".indexOf(this.kwargs['table']) >= 0) {
                        out += this.repeat_text("//LO0yymm  DD DSN=" + this.control_UUAA(2) + "{name}.LOA0yymm,\n"
                            + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                            + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                            + "//            LRECL=80)\n"
                            + "//LO1yymm  DD DSN=" + this.control_UUAA(2) + "{name}.LOA1yymm,\n"
                            + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                            + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                            + "//            LRECL=80)");
                    } else {
                        out += this.repeat_text("//LOAyymm  DD DSN=" + this.control_UUAA(2) + "{name}.LOADyymm,\n"
                            + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                            + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                            + "//            LRECL=80)");
                    }
                }
                out += "//SORTOUT  DD SYSOUT=*"
                    + "\n//SYSOUT   DD SYSOUT=*"
                    + "\n//SYSIN    DD *"
                    + "\n  SORT FIELDS=COPY"
                    + "\n  OUTFIL FNAMES=SORTO00,OVERLAY=(C'SELECT * FROM P" + this.kwargs['lib_uuaa'] + "." + this.kwargs['table'] + "')"
                    + "\n" + this.repeat_text("  OUTFIL FNAMES=UNLyymm,OVERLAY=(C'UNLOAD PART {upart}')");

                if (this.kwargs['carga'] == "0") {
                    if ("TEYRGOSL|TEYRGGOP|TEYRGOGE".indexOf(this.kwargs['table']) >= 0) {
                        out += this.repeat_text("  OUTFIL FNAMES=LO0yymm,OVERLAY=(C'PART {part0}')\n"
                            + "  OUTFIL FNAMES=LO1yymm,OVERLAY=(C'PART {part1}')");
                    } else {
                        out += this.repeat_text("  OUTFIL FNAMES=LOAyymm,OVERLAY=(C'PART {part}')");
                    }
                }

                out += "/*\n" + this.repeat_text("//**********************************************************************\n"
                    + "//* DESCARGA LAS PARTICION yymm DE LA TABLA {table}\n"
                    + "//**********************************************************************\n"
                    + "//UNLOyymm EXEC PROC=EXPRP42P,JOB='{name}',QUIESCE=Y,SSID='DS0E'\n"
                    + "//SYSIN    DD DSN=" + this.control_UUAA(2) + "{name}.UNLOyymm,DISP=SHR\n"
                    + "//         DD DSN=" + this.control_UUAA(2) + "{name}.SELCT{tbl3},DISP=SHR\n"
                    + "//SYSREC   DD DSN=" + this.control_UUAA(2) + "{name}.T{tbl3}yymm,\n"
                    + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                    + "//            DATACLAS=EXTCOMPS,DCB=(BLKSIZE=0,BUFNO=5)\n"
                    + "//SYSCNTL  DD DUMMY\n"
                    + "//SYSPRINT DD SYSOUT=*\n"
                    + "/*");

                if (this.kwargs['carga'] == "0") {
                    if ("TEYRGOSL|TEYRGGOP|TEYRGOGE".indexOf(this.kwargs['table']) >= 0) {
                        out += this.repeat_text("//*---------------------------------------------------------------------\n"
                            + "//**********************************************************************\n"
                            + "//* GENERA LA CARGA DEL yymm DE LA TABLA {table}\n"
                            + "//**********************************************************************\n"
                            + "//L{tbl3}yymm EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUAL'\n"
                            + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.UUAAP000.FP0yymmS,DISP=SHR\n"
                            + "//         DD DSN=EBPUUAA.INPXD05X.{name}.T{tbl3}yymm,DISP=SHR\n"
                            + "//SORTO01  DD DSN=EBPUUAA.INPXD05X.{name}.L{tbl2}0yymm,\n"
                            + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                            + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                            + "//SORTO02  DD DSN=EBPUUAA.INPXD05X.{name}.L{tbl2}1yymm,\n"
                            + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                            + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                            + "//SYSOUT   DD SYSOUT=*\n"
                            + "//SYSIN    DD *\n"
                            + "  SORT FIELDS=({clv})\n"
                            + "  SUM FIELDS=NONE\n"
                            + "  OUTFIL FNAMES=SORTO01,INCLUDE=(4,1,CH,LE,C'4')\n"
                            + "  OUTFIL FNAMES=SORTO02,INCLUDE=(4,1,CH,GE,C'5')\n"
                            + "/*\n"
                            + "//**********************************************************************\n"
                            + "//* COMPRUEBA SI EL FICHERO DE LA CARGA DEL yymm DE LA TABLA {table}\n"
                            + "//* ESTA VACIO\n"
                            + "//**********************************************************************\n"
                            + "//PAS0yymm   EXEC PROC=EXPRP20P\n"
                            + "//IN       DD DSN=EBPUUAA.INPXD05X.{name}.L{tbl2}0yymm,DISP=SHR\n"
                            + "//P20.SYSIN DD *\n"
                            + " PRINT INFILE(IN) CHARACTER COUNT(1)\n"
                            + " IF LASTCC = 0  THEN SET MAXCC = 0\n"
                            + "/*\n"
                            + "//**********************************************************************\n"
                            + "//ACT0yymm IF (PAS0yymm.P20.RC = 0) THEN\n"
                            + "//**********************************************************************\n"
                            + "//* CARGA 0 DEL yymm DE LA TABLA {table}\n"
                            + "//**********************************************************************\n"
                            + "//CARG{tbl2}0 EXEC PROC=EXPRP51P,JOB='{name}',SSID='DS0E',TB='{table}'\n"
                            + "//**********************************************************************\n"
                            + "//* UT\n"
                            + "//**********************************************************************\n"
                            + "//P51UT.STARTUT DD *\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(EUUAA{tbl3}) ACCESS(UT)\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl3}) ACCESS(UT)\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl2}1) ACCESS(UT)\n"
                            + "//P51.NUMPART DD DSN=EBPUUAA.INPXD05X.{name}.LOA0yymm,DISP=SHR\n"
                            + "//P51.SYSREC DD DSN=EBPUUAA.INPXD05X.{name}.L{tbl2}0yymm,DISP=SHR\n"
                            + "//**********************************************************************\n"
                            + "//* RW\n"
                            + "//**********************************************************************\n"
                            + "//P51RW.STARTRW DD *\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(EUUAA{tbl3}) ACCESS(RW)\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl3}) ACCESS(RW)\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl2}1) ACCESS(RW)\n"
                            + "//**********************************************************************\n"
                            + "//ACT0yymm ENDIF\n"
                            + "//**********************************************************************\n"
                            + "//**********************************************************************\n"
                            + "//** COMPRUEBA SI EL FICHERO GENERADO ESTA VACIO\n"
                            + "//**********************************************************************\n"
                            + "//PAS1yymm   EXEC PROC=EXPRP20P\n"
                            + "//IN       DD DSN=EBPUUAA.INPXD05X.{name}.L{tbl2}1yymm,DISP=SHR\n"
                            + "//P20.SYSIN DD *\n"
                            + " PRINT INFILE(IN) CHARACTER COUNT(1)\n"
                            + " IF LASTCC = 0  THEN SET MAXCC = 0\n"
                            + "/*\n"
                            + "//**********************************************************************\n"
                            + "//ACT1yymm IF (PAS1yymm.P20.RC = 0) THEN\n"
                            + "//**********************************************************************\n"
                            + "//* CARGA 1 DEL yymm DE LA TABLA {table}\n"
                            + "//**********************************************************************\n"
                            + "//CARG{tbl2}1 EXEC PROC=EXPRP51P,JOB='{name}',SSID='DS0E',TB='{table}'\n"
                            + "//**********************************************************************\n"
                            + "//* UT\n"
                            + "//**********************************************************************\n"
                            + "//P51UT.STARTUT DD *\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(EUUAA{tbl3}) ACCESS(UT)\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl3}) ACCESS(UT)\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl2}1) ACCESS(UT)\n"
                            + "//P51.NUMPART DD DSN=EBPUUAA.INPXD05X.{name}.LOA1yymm,DISP=SHR\n"
                            + "//P51.SYSREC DD DSN=EBPUUAA.INPXD05X.{name}.L{tbl2}1yymm,DISP=SHR\n"
                            + "//**********************************************************************\n"
                            + "//* RW\n"
                            + "//**********************************************************************\n"
                            + "//P51RW.STARTRW DD *\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(EUUAA{tbl3}) ACCESS(RW)\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl3}) ACCESS(RW)\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl2}1) ACCESS(RW)\n"
                            + "//**********************************************************************\n"
                            + "//ACT1yymm ENDIF\n"
                            + "//**********************************************************************\n"
                            + "//*---------------------------------------------------------------------");
                    } else {
                        out += this.repeat_text("//*---------------------------------------------------------------------\n"
                            + "//**********************************************************************\n"
                            + "//* GENERA LA CARGA DEL yymm DE LA TABLA {table}\n"
                            + "//**********************************************************************\n"
                            + "//L{tbl3}yymm EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUAL'\n"
                            + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.UUAAP000.FP0yymmS,DISP=SHR\n"
                            + "//         DD DSN=EBPUUAA.INPXD05X.{name}.T{tbl3}yymm,DISP=SHR\n"
                            + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.L{tbl3}yymm,\n"
                            + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                            + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                            + "//SYSOUT   DD SYSOUT=*\n"
                            + "//SYSIN    DD *\n"
                            + "  SORT FIELDS=({clv})\n"
                            + "  SUM FIELDS=NONE\n"
                            + "/*\n"
                            + "//**********************************************************************\n"
                            + "//* COMPRUEBA SI EL FICHERO DE LA CARGA DEL yymm DE LA TABLA {table}\n"
                            + "//* ESTA VACIO\n"
                            + "//**********************************************************************\n"
                            + "//PASOyymm EXEC PROC=EXPRP20P\n"
                            + "//IN       DD DSN=EBPUUAA.INPXD05X.{name}.L{tbl3}yymm,DISP=SHR\n"
                            + "//P20.SYSIN DD *\n"
                            + " PRINT INFILE(IN) CHARACTER COUNT(1)\n"
                            + " IF LASTCC = 0  THEN SET MAXCC = 0\n"
                            + "/*\n"
                            + "//**********************************************************************\n"
                            + "//ACTUyymm IF (PASOyymm.P20.RC = 0) THEN\n"
                            + "//**********************************************************************\n"
                            + "//* CARGA DEL yymm DE LA TABLA {table}\n"
                            + "//**********************************************************************\n"
                            + "//CARGyymm EXEC PROC=EXPRP51P,JOB='{name}',SSID='DS0E',TB='{table}'\n"
                            + "//**********************************************************************\n"
                            + "//* UT\n"
                            + "//**********************************************************************\n"
                            + "//P51UT.STARTUT DD *\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(EUUAA{tbl3}) ACCESS(UT)\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl3}) ACCESS(UT)\n"
                            + ("TEYRGNSR".indexOf(this.kwargs['table']) >= 0?"":"  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl2}1) ACCESS(UT)\n")
                            + "//P51.NUMPART DD DSN=EBPUUAA.INPXD05X.{name}.LOADyymm,DISP=SHR\n"
                            + "//P51.SYSREC DD DSN=EBPUUAA.INPXD05X.{name}.L{tbl3}yymm,DISP=SHR\n"
                            + "//**********************************************************************\n"
                            + "//* RW\n"
                            + "//**********************************************************************\n"
                            + "//P51RW.STARTRW DD *\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(EUUAA{tbl3})  ACCESS(RW)\n"
                            + "  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl3})  ACCESS(RW)\n"
                            + ("TEYRGNSR".indexOf(this.kwargs['table']) >= 0?"":"  -START DATABASE(BUUAA{tbl3}) SPACENAM(IUUAA{tbl2}1) ACCESS(RW)\n")
                            + "//**********************************************************************\n"
                            + "//ACTUyymm ENDIF\n"
                            + "//**********************************************************************\n"
                            + "//*---------------------------------------------------------------------");
                    }
                } else {
                    if (this.kwargs['conversor'] == "0") {
                        if (this.kwargs['table'] == "TEYRGOSL") {
                            out += "//*---------------------------------------------------------------------\n"
                                + "//*---------------------------------------------------------------------\n"
                                + "//**********************************************************************"
                                + "\n//* FUSIONA LOS FICHEROS PARA QUEDARNOS CON AQUELLOS QUE ESTAN VIVOS"
                                + "\n//**********************************************************************"
                                + "\n//SORT001  EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                                + "\n" + this.repeat_text("//{sortin}DD DSN=EBPUUAA.INPXD05X.{name}.T{tbl3}yymm,DISP=SHR")
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X." + this.kwargs['name'] + ".F0ORE01E,"
                                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)"
                                + "\n//SYSOUT   DD SYSOUT=*"
                                + "\n//SYSIN    DD *"
                                + "\n  SORT FIELDS=COPY"
                                + "\n  INCLUDE COND=(((617,1,CH,EQ,C'A',AND,622,1,SS,EQ,C'S,A,V'),";

                            var text_fechas = this.repeat_text("{or}121,10,CH,EQ,C'{yyyy-mm-dd}',");

                            out += "\n      OR,(617,1,CH,EQ,C'M')),AND,(" + text_fechas.substring(0,text_fechas.length - 2) + "))"
                                + "\n/*"
                                + "\n//**********************************************************************"
                                + "\n//* EJECUCION DEL PROCESO PARA CONVERTIR LA TABLA TEYRGOSL POR TEYRGORE"
                                + "\n//**********************************************************************"
                                + "\n//EYRGBORE EXEC PROC=EXPRP01P,PRG=EYRGBORE"
                                + "\n//F0ORE01E DD DSN=EBPUUAA.INPXD05X." + this.kwargs['name'] + ".F0ORE01E,DISP=SHR"
                                + "\n//F0ORE01S DD DSN=EBPUUAA.INPXD05X." + this.kwargs['name'] + ".F0ORE01S,"
                                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)"
                                + "\n//SYSPRINT DD SYSOUT=*"
                                + "\n//SYSOUT   DD SYSOUT=*"
                                + "\n//SYSABOUT DD SYSOUT=4,DEST=JESTC3"
                                + "\n//SYSDBOUT DD SYSOUT=4,DEST=JESTC3"
                                + "\n//CEEDUMP  DD SYSOUT=4,DEST=JESTC3"
                                + "\n//SYSTSPRT DD SYSOUT=*"
                                + "\n//SYSIN    DD *"
                                + "\n//SYSTSIN  DD *"
                                + "\n/*"
                                + "\n//**********************************************************************"
                                + "\n//* ACTUALIZAR PARA GENERAR LA RECTIFICACION"
                                + "\n//**********************************************************************"
                                + "\n//SORT002  EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                                + "\n//SORTIN   DD DSN=EBPUUAA.INPXD05X." + this.kwargs['name'] + ".F0ORE01S,DISP=SHR"
                                + "\n//SORTOUT  DD DSN=EBPUUAA.INPXD05X." + this.kwargs['name'] + ".FP" + this.kwargs['name'].substring(5) + "01S,"
                                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)"
                                + "\n//SYSOUT   DD SYSOUT=*"
                                + "\n//SYSIN    DD *"
                                + "\n  SORT FIELDS=COPY"
                                + "\n  OUTREC OVERLAY=(537:DATE5)"
                                + "\n/*"
                                + "\n//**********************************************************************";
                        } else if (this.kwargs['table'] == "TEYRGGOP") {
                            out += "//*---------------------------------------------------------------------"
                                + "\n//*---------------------------------------------------------------------"
                                + "\n//**********************************************************************"
                                + "\n//* FUSIONA LOS FICHEROS PARA QUEDARNOS CON AQUELLOS QUE ESTAN VIVOS"
                                + "\n//**********************************************************************"
                                + "\n//SORT001  EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                                + "\n" + this.repeat_text("//{sortin}DD DSN=EBPUUAA.INPXD05X.{name}.T{tbl3}yymm,DISP=SHR")
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X." + this.kwargs['name'] + ".SORT001S,"
                                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)"
                                + "\n//SYSOUT   DD SYSOUT=*"
                                + "\n//SYSIN    DD *"
                                + "\n  SORT FIELDS=COPY"
                                + "\n  INCLUDE COND=((785,1,CH,EQ,C'A',AND,193,1,SS,EQ,C'S,A,V'),";

                            var text_fechas = this.repeat_text("{or}153,10,CH,EQ,C'{yyyy-mm-dd}',");

                            out += "\n      OR,(785,1,CH,EQ,C'M'),AND,(" + text_fechas.substring(0,text_fechas.length - 2) + "))"
                                + "\n/*"
                                + "\n//**********************************************************************"
                                + "\n//* EJECUCION DEL PROCESO PARA CONVERTIR LA TABLA TEYRGGOP POR TEYRGRGO"
                                + "\n//**********************************************************************"
                                + "\n//SORT002  EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                                + "\n//SORTIN   DD DSN=EBPUUAA.INPXD05X." + this.kwargs['name'] + ".SORT001S,DISP=SHR"
                                + "\n//SORTOUT  DD DSN=EBPUUAA.INPXD05X." + this.kwargs['name'] + ".FP" + this.kwargs['name'].substring(5) + "01S,"
                                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                                + "\n//            LRECL=794)"
                                + "\n//SYSOUT   DD SYSOUT=*"
                                + "\n//SYSIN    DD *"
                                + "\n  SORT FIELDS=COPY"
                                + "\n  OUTREC BUILD=(037,004,041,002,043,026,069,050,119,034,153,010,"
                                + "\n    005,002,007,004,011,026,170,003,C'2',791,010,C'M ',"
                                + "\n    193,001,204,254,C'P',531,254,173,003,183,002,821,001,"
                                + "\n    +100000000000,TO=PD,LENGTH=7,194,002,196,005,"
                                + "\n    ((458,009,PD,MUL,+100),DIV,+100),TO=PD,LENGTH=9,"
                                + "\n    ((467,009,PD,MUL,+100),DIV,+100),TO=PD,LENGTH=9,"
                                + "\n    ((476,009,PD,MUL,+100),DIV,+100),TO=PD,LENGTH=9,"
                                + "\n    ((485,009,PD,MUL,+100),DIV,+100),TO=PD,LENGTH=9,"
                                + "\n    494,001,811,010,496,008,DATE5,842,001,843,001,844,001,"
                                + "\n    845,001,846,005)"
                                + "\n/*"
                                + "\n//**********************************************************************";
                        } else if (this.kwargs['table'] == "TEYRGGGO") {
                            out += this.repeat_text("//*---------------------------------------------------------------------\n"
                                + "//*---------------------------------------------------------------------\n"
                                + "//**********************************************************************\n"
                                + "//* EXTRAEMOS LOS DEL CIERRE MES yymm CORRESPONDIENTE\n"
                                + "//**********************************************************************\n"
                                + "//SO0yymm  EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'\n"
                                + "//SORTIN   DD DSN=EBPEYRG.INPXD05X.{name}.T{tbl3}yymm,DISP=SHR\n"
                                + "//SORTO01  DD DSN=EBPEYRG.INPXD05X.{name}.S0yymm1S,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SORTO02  DD DSN=EBPEYRG.INPXD05X.{name}.S0yymm2S,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SORTOUT  DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=COPY\n"
                                + "  OUTFIL FNAMES=SORTO01,INCLUDE=(485,1,SS,EQ,C'A,M,B',\n"
                                + "      AND,516,1,SS,EQ,C'S,A,R,V',AND,1,10,CH,EQ,C'{yyyy-mm-dd}')\n"
                                + "  OUTFIL FNAMES=SORTO02,SAVE\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* GENERAMOS EL MODULO DD010, DD011, BD010 DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//SO1yymm  EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'\n"
                                + "//SORTIN   DD DSN=EBPEYRG.INPXD05X.{name}.S0yymm1S,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPEYRG.INPXD05X.{name}.S1yymm1S,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=3010)\n"
                                + "//SYSIN    DD *\n"
                                + " SORT FIELDS=(12,2,CH,A,16,4,CH,A,1142,60,CH,A)\n"
                                + "  SUM FIELDS=NONE\n"
                                + "  OMIT COND=(516,1,CH,EQ,C'E',AND,517,1,CH,NE,C' ')\n"
                                + " OUTFIL IFTHEN=(WHEN=(485,1,SS,EQ,C'A,M',AND,516,1,SS,EQ,C'S,R,A,V,E'),\n"
                                + "         BUILD=(1,515,C'S',254X,771,438,C'S',40X,1250,165,\n"
                                + "                1587X,16,4,C'DD011',/,\n"
                                + "                1,515,C'S',254X,771,438,C'S',40X,1250,165,\n"
                                + "                1587X,16,4,C'DD010')),\n"
                                + "       IFTHEN=(WHEN=(485,1,CH,EQ,C'B'),\n"
                                + "         BUILD=(1,515,C'S',254X,771,438,C'S',40X,1250,165,\n"
                                + "                1587X,16,4,C'BD010'))\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* CRUCE DE COD OPERACION DE RGOS CON EQUIVA DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//JOIyymm  EXEC PROC=EXPRP23P,EQUAL='EQUAL'\n"
                                + "//SORTJNF1 DD DSN=EBPEYRG.INPXD05X.{name}.S1yymm1S,DISP=SHR\n"
                                + "//SORTJNF2 DD DSN=EBPEYRG.APLBD00X.EYRGJF03.IUCBX(0),DISP=SHR\n"
                                + "//JNF2CNTL DD *\n"
                                + "  SUM FIELDS=NONE\n"
                                + "//FB0BBOTH DD DSN=EBPEYRG.INPXD05X.{name}.JOIyymmB,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=3010)\n"
                                + "//FB01ONLY DD DSN=EBPEYRG.INPXD05X.{name}.JOIyymm1,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=3010)\n"
                                + "//FB02ONLY DD DSN=EBPEYRG.INPXD05X.{name}.JOIyymm2,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=0128)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  JOINKEYS FILES=F1,FIELDS=(21,60,A)\n"
                                + "  JOINKEYS FILES=F2,FIELDS=(69,60,A)\n"
                                + "  JOIN UNPAIRED\n"
                                + "  REFORMAT FIELDS=(F1:1,3010,F2:1,128,?)\n"
                                + "  OPTION COPY\n"
                                + "  OUTFIL FNAMES=FB0BBOTH,INCLUDE=(3139,1,CH,EQ,C'B'),\n"
                                + "                                          BUILD=(1,20,3014,60,81,2930)\n"
                                + "  OUTFIL FNAMES=FB01ONLY,INCLUDE=(3139,1,CH,EQ,C'1'),BUILD=(0001,3010)\n"
                                + "  OUTFIL FNAMES=FB02ONLY,INCLUDE=(3139,1,CH,EQ,C'2'),BUILD=(3011,0128)\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* ORDENAMOS LA ENTRADA F039901E AL PROGRAMA DE MODULOS DE ENVIO DE\n"
                                + "//* DATOS BASICOS DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//SO2yymm  EXEC PROC=EXPRP23P,SYNCSORT=S,VAR='256'\n"
                                + "//SORTIN   DD DSN=EBPEYRG.INPXD05X.{name}.JOIyymmB,DISP=SHR\n"
                                + "//         DD DSN=EBPEYRG.INPXD05X.{name}.JOIyymm1,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPEYRG.INPXD05X.{name}.SO2yymmE,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=3010)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=(3002,4,CH,A,3006,5,CH,A)\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* GENERADOS EL CIERRE DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//SO3yymm  EXEC PROC=EXPRP23P,SYNCSORT=S,VAR='256'\n"
                                + "//SORTIN   DD *\n"
                                + "{yyyymmdd}\n"
                                + "//SORTOUT  DD DSN=EBPEYRG.INPXD05X.{name}.FP20yymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=8)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=COPY\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* PROGRAMA DE MODULOS DE ENVIO DE DATOS BASICOS\n"
                                + "//**********************************************************************\n"
                                + "//BA98yymm EXEC PROC=EXPRP02P,SSID='DS0E'\n"
                                + "//F039901E DD DSN=EBPEYRG.INPXD05X.{name}.SO2yymmE,DISP=SHR\n"
                                + "//F039902E DD DSN=EBPEYRG.INPXD05X.{name}.FP20yymm,DISP=SHR\n"
                                + "//F039901S DD DSN=EBPEYRG.INPXD05X.{name}.SALIyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=355)\n"
                                + "//F039902S DD DSN=EBPEYRG.INPXD05X.{name}.ERROyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=307)\n"
                                + "//F039903S DD DSN=EBPEYRG.INPXD05X.{name}.ESTAyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=134)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSABOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSDBOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//CEEDUMP  DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSTSPRT DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "MES\n"
                                + "//SYSTSIN  DD *\n"
                                + "  DSN SYSTEM(DS0E)\n"
                                + "    RUN PROGRAM(EYRGBA98) PLAN(EYRGB001)\n"
                                + "  END\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//*  GENERAMOS EL MODULO DD040 DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//SO4yymm  EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'\n"
                                + "//SORTIN   DD DSN=EBPEYRG.INPXD05X.{name}.JOIyymmB,DISP=SHR\n"
                                + "//         DD DSN=EBPEYRG.INPXD05X.{name}.JOIyymm1,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPEYRG.INPXD05X.{name}.S05yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=3010)\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=(12,2,CH,A,16,4,CH,A,1142,60,CH,A)\n"
                                + "  SUM FIELDS=NONE\n"
                                + "  INCLUDE COND=/(771,1,SS,EQ,C'S,R,A,V',OR,1351,1,SS,EQ,C'S,R,A,V'),\n"
                                + "             AND,485,CH,NE,C'B')\n"
                                + "  OUTREC IFTHEN=(WHEN=(0771,1,SS,EQ,C'S,R,A,V'),\n"
                                + "                        OVERLAY=(0771:C'S'),HIT=NEXT),\n"
                                + "         IFTHEN=(WHEN=(1351,1,SS,EQ,C'S,R,A,V'),\n"
                                + "                        OVERLAY=(1351:C'S'),HIT=NEXT),\n"
                                + "         IFTHEN=(WHEN=ANY,OVERLAY=(1415:1587X,16,4,C'DD040'),HIT=NEXT)\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* PROGRAMA DE MODULOS DE ENVIO DE DATOS DINÁMICOS DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//BA99yymm EXEC PROC=EXPRP02P,SSID='DS0E'\n"
                                + "//F040001E DD DSN=EBPUUAA.INPXD05X.{name}.S05yymmS,DISP=SHR\n"
                                + "//F040002E DD DSN=EBPEYRG.INPXD05X.{name}.FP20yymm,DISP=SHR\n"
                                + "//F040001S DD DSN=EBPUUAA.INPXD05X.{name}.F06Syymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F040002S DD DSN=EBPUUAA.INPXD05X.{name}.F07Syymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F040003S DD DSN=EBPUUAA.INPXD05X.{name}.F08Syymm,\n"
                                + "///            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSABOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSDBOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//CEEDUMP  DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSTSPRT DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "\n"
                                + "//SYSTSIN  DD *\n"
                                + "  DSN SYSTEM(DS0E)\n"
                                + "    RUN PROGRAM(EYRGBA99) PLAN(EYRGB001)\n"
                                + "  END\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* GENERAR LOS REGISTOS A CARGAR DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//SO6yymm EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'\n"
                                + "//SORTIN   DD DSN=EBPEYRG.INPXD05X.{name}.S1yymm1S,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPEYRG.INPXD05X.{name}.FPyymm1S,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=(1204,03,CH,A,1,10,CH,A,12,02,CH,A,16,04,CH,A,21,26,CH,A,\n"
                                + "                 47,34,CH,A,81,50,CH,A,160,26,CH,A,1142,60,CH,A)\n"
                                + "   SUM FIELDS=NONE\n"
                                + "  OUTREC IFTHEN=(WHEN=(0771,1,SS,EQ,C'S,R,A,V',AND,485,1,CH,NE,C'B'),\n"
                                + "                       OVERLAY=(0771:C'S'),HIT=NEXT),\n"
                                + "         IFTHEN=(WHEN=(1351,1,SS,EQ,C'S,R,A,V',AND,485,1,CH,NE,C'B'),\n"
                                + "                       OVERLAY=(1351:C'S'),HIT=NEXT)\n"
                                + "/*");
                        } else if (this.kwargs['table'] == "TEYRGOAN") {
                            out += this.repeat_text("//*---------------------------------------------------------------------\n"
                                + "//*---------------------------------------------------------------------\n"
/*
                                + "//*OPCIONAL-------------------------------------------------------------\n"
                                + "//*---------------------------------------------------------------------\n"
                                + "//**********************************************************************\n"
                                + "//* TOANyymm CONVERTIDA EN LA COPY EYRGCA80\n"
                                + "//* EL CAMPO COD-PGCCONTR, COD-TINSTRUM Y COD-ESTBDE-BAS SE CONSIGUE \n"
                                + "//* CRUZANDO CON LA TEYRGOSL CRUZANDO Y LUEGO TRANSOFMARNDO CON EL \n"
                                + "//* BUILD=BUILD=(1,107,1647,4,112,18,1670,3,133,472,2122,1,606,695) \n"
                                + "//**********************************************************************\n"
                                + "//SO0yymm EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'\n"
                                + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.{name}.TOANyymm,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.S00yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=1500)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=COPY\n"
                                + "   INCLUDE COND=(4,10,CH,EQ,C'{yyyy-mm-dd}',AND,133,01,CH,EQ,C'R')\n"
                                + "  OUTREC BUILD=(1,3,1X,4,10,20,26,96,34,14,2,16,4,20,26,19X,14,2,26X,\n"
                                + "        C'0001-01-01',2X,C'0001-01-01',70X,+0,TO=PD,LENGTH=3,16X,\n"
                                + "        +0,TO=PD,LENGTH=7,16X,C'0001-01-01',1X,C'0001-01-01',10X,\n"
                                + "        C'0001-01-01',1X,C'0001-01-01',1X,C'0001-01-01',1X,\n"
                                + "        C'0001-01-01',+0,TO=PD,LENGTH=6,30X,+0,TO=PD,LENGTH=9,\n"
                                + "        +0,TO=PD,LENGTH=9,1X,+0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=9,\n"
                                + "        +0,TO=PD,LENGTH=9,2X,+0,TO=PD,LENGTH=9,1X,1X,+0,TO=PD,LENGTH=9,\n"
                                + "        2X,+0,TO=PD,LENGTH=9,3X,+0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=9,\n"
                                + "        +0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=9,\n"
                                + "        +0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=9,1X,+0,TO=PD,LENGTH=9,\n"
                                + "        +0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=9,1X,\n"
                                + "        +0,TO=PD,LENGTH=9,1X,+0,TO=PD,LENGTH=9,132,1,6X,C'00',5X,\n"
                                + "        462,10,2X,+0,TO=PD,LENGTH=7,452,10,C'0001-01-01',19X,\n"
                                + "        +0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=9,1X,\n"
                                + "        +0,TO=ZD,LENGTH=2,91X,C'0001-01-01',C'0001-01-01',\n"
                                + "        +0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=5,\n"
                                + "        14X,+0,TO=PD,LENGTH=5,2X,C'0001-01-01',7X,+0,TO=PD,LENGTH=5,\n"
                                + "        2X,C'0001-01-01',27X,+0,TO=PD,LENGTH=4,413,1,414,1,415,7,422,1,\n"
                                + "        423,1,424,7,431,1,432,1,433,7,440,1,441,1,442,10,7X,\n"
                                + "        C'0001-01-01',17X,+0,TO=PD,LENGTH=9,84X,+0,TO=PD,LENGTH=9,\n"
                                + "        7X,C'0001-01-01',2X,+0,TO=PD,LENGTH=9,C'S',11X,394,1,395,3,\n"
                                + "        389,1,390,3,399,1,400,3,404,1,405,3,409,1,410,3,3X,1X,\n"
                                + "        C'0001-01-01',2X,C'0001-01-01',1X,+0,TO=PD,LENGTH=9,1X,\n"
                                + "        C'0001-01-01',C'0001-01-01',41X,+0,TO=PD,LENGTH=9,\n"
                                + "        +0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=9,+0,TO=PD,LENGTH=7,\n"
                                + "        +0,TO=PD,LENGTH=7,1X,C'0001-01-01',+0,TO=PD,LENGTH=9,\n"
                                + "        C'0001-01-01',6X,C'0001-01-01',C'0001-01-01',C'0001-01-01',\n"
                                + "        C'0001-01-01',1X,C'0001-01-01',6X,C'0001-01-01',102X)\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* CRUCE DE FICHEROS ENTRE LA TEYRGOSL Y LA TEYRGOAN DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//JOIyymm  EXEC PROC=EXPRP23P,EQUAL='EQUAL'\n"
                                + "//SORTJNF1 DD DSN=EBPUUAA.INPXD05X.{name}.S00yymmS,DISP=SHR\n"
                                + "//SORTJNF2 DD DSN=EBPUUAA.INPXD05X.{name}.TOSLyymm,DISP=SHR\n"
                                + "//JNF2CNTL DD *\n"
                                + "  INCLUDE COND=(121,10,CH,EQ,C'{yyyy-mm-dd}')\n"
                                + "//FB0BBOTH DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymmB,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FB01ONLY DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymm1,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FB02ONLY DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymm2,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  JOINKEYS FILES=F1,FIELDS=(75,2,A,77,4,A,81,26,A,738,50,A,41,34,A)\n"
                                + "  JOINKEYS FILES=F2,FIELDS=(05,2,A,07,4,A,11,26,A,037,50,A,87,34,A)\n"
                                + "  JOIN UNPAIRED,F1,F2\n"
                                + "  REFORMAT FIELDS=(F1:1,1500,F2:1,2196,?)\n"
                                + "  OPTION COPY\n"
                                + "  OUTFIL FNAMES=FB0BBOTH,INCLUDE=(3697,1,CH,EQ,C'B'),\n"
                                + "          BUILD=(1,107,1647,4,112,18,1670,3,133,472,2122,1,606,695)\n"
                                + "  OUTFIL FNAMES=FB01ONLY,INCLUDE=(3697,1,CH,EQ,C'1'),BUILD=(1,1500)\n"
                                + "  OUTFIL FNAMES=FB02ONLY,INCLUDE=(3697,1,CH,EQ,C'2'),BUILD=(1501,2196)\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* LLAMADA AL PROGRAMA EYRGBI51 DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//BI51yymm EXEC PROC=EXPRP01P,PRG=EYRGBI51\n"
                                + "//FBI5101E DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymmB,DISP=SHR\n"
                                + "//FBI5101S DD DSN=EBPUUAA.INPXD05X.{name}.FI51yymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSABOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSDBOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//CEEDUMP  DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSTSPRT DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "//SYSTSIN  DD *\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* LLAMADA AL PROGRAMA EYRGBI30 DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//BI30yymm EXEC PROC=EXPRP01P,PRG=EYRGBI30\n"
                                + "//FBI3001E DD DSN=EBPUUAA.INPXD05X.{name}.FI51yymm,DISP=SHR\n"
                                + "//FBI3001S DD DSN=EBPUUAA.INPXD05X.{name}.FI30yymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FBI3002S DD DSN=EBPUUAA.INPXD05X.{name}.ESTAyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSABOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSDBOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//CEEDUMP  DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSTSPRT DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "//SYSTSIN  DD *\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* FILTRAR PARA QUEDARNOS CON LOS DECLARABLES DEL yymm\n"
                                + "//**********************************************************************\n"
                                + "//S01yymm EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'\n"
                                + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.{name}.FI30yymm,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.S01yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=1300)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=COPY\n"
                                + "  INCLUDE COND=(1125,1,CH,EQ,C'S')\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* LLAMADA AL PROGRAMA EYRGBI50 DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//BI50yymm EXEC PROC=EXPRP01P,PRG=EYRGBI50\n"
                                + "//FBI5001E DD DSN=EBPUUAA.INPXD05X.{name}.S01yymmS,DISP=SHR\n"
                                + "//FBI5002E DD DUMMY\n"
                                + "//FBI5003E DD DSN=EBPUUAA.INPXD05X.{name}.FP20yymm,DISP=SHR\n"
                                + "//FBI5001S DD DSN=EBPUUAA.INPXD05X.{name}.INTByymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FBI5002S DD DSN=EBPUUAA.INPXD05X.{name}.FB2yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FBI5003S DD DSN=EBPUUAA.INPXD05X.{name}.FB3yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSABOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSDBOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//CEEDUMP  DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSTSPRT DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "//SYSTSIN  DD *\n"
                                + "/*\n"
                                + "//*---------------------------------------------------------------------\n"
                                + "//*OPCIONAL-------------------------------------------------------------\n"
                                + "//*---------------------------------------------------------------------\n"
*/
                                + "//**********************************************************************\n"
                                + "//* CRUCE DE FICHEROS ENTRE LA TEYRGOAN DEL MES yymm Y EL FICHERO USR\n"
                                + "//**********************************************************************\n"
                                + "//JOIyymm  EXEC PROC=EXPRP23P,EQUAL='EQUAL'\n"
//                                + "//SORTJNF1 DD DSN=EBPUUAA.INPXD05X.{name}.INTByymm,DISP=SHR\n"
                                + "//SORTJNF1 DD DSN=EBPUUAA.INPXD05X.{name}.TOANyymm,DISP=SHR\n"
                                + "//SORTJNF2 DD DSN=EBPUUAA.USRXD05X.UUAAP000.FP00001E,DISP=SHR\n"
                                + "//FB0BBOTH DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymmB,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FB01ONLY DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymm1,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FB02ONLY DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymm2,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  JOINKEYS FILES=F1,FIELDS=(20,26,A,96,34,A)\n"
                                + "  JOINKEYS FILES=F2,FIELDS=(01,26,A,27,34,A)\n"
                                + "  JOIN UNPAIRED,F1,F2\n"
                                + "  REFORMAT FIELDS=(F1:1,515,F2:1,60,?)\n"
                                + "  OPTION COPY\n"
                                + "  OUTFIL FNAMES=FB0BBOTH,INCLUDE=(576,1,CH,EQ,C'B'),\n"
                                + "          BUILD=(1,129,C'00AS',254X,388,27,+0,TO=PD,LENGTH=7,422,94,\n"
                                + "              162X)\n"
                                + "  OUTFIL FNAMES=FB01ONLY,INCLUDE=(576,1,CH,EQ,C'1'),BUILD=(1,515)\n"
                                + "  OUTFIL FNAMES=FB02ONLY,INCLUDE=(576,1,CH,EQ,C'2'),BUILD=(516,60)\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* ETIQUETAMOS LOS REGISTROS EN BASE A LA OPERACION A REALIZAR yymm\n"
                                + "//**********************************************************************\n"
                                + "//S02yymm EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'\n"
                                + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymmB,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.S02yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=3010)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=(14,02,CH,A,16,04,CH,A,20,26,CH,A,96,34,CH,A,46,50,CH,A)\n"
                                + "  OUTREC IFTHEN=(WHEN=(132,1,CH,EQ,C'A',OR,132,1,CH,EQ,C'M'),\n"
                                + "              BUILD=(1,677,2324X,16,4,C'DE010')),\n"
                                + "         IFTHEN=(WHEN=(132,1,CH,EQ,C'B'),\n"
                                + "              BUILD=(1,677,2324X,16,4,C'BE010'))\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* ORDENAR DATOS BÁSICOS SEGUN ENTIDAD Y MÓDULO DE ENVÍO yymm\n"
                                + "//**********************************************************************\n"
                                + "//S03yymm EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'\n"
                                + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.{name}.S02yymmS,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.S03yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=3010)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=(3001,4,CH,A,3006,5,CH,A)\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* GENERADOS EL CIERRE DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//SO3yymm  EXEC PROC=EXPRP23P,SYNCSORT=S,VAR='256'\n"
                                + "//SORTIN   DD *\n"
                                + "{yyyymmdd}\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.FP20yymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=8)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=COPY\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* PROGRAMA DE MODULOS DE ENVIO DE DATOS BÁSICOS DEL yymm\n"
                                + "//**********************************************************************\n"
                                + "//BA98yymm EXEC PROC=EXPRP02P,SSID='DS0E'\n"
                                + "//F039901E DD DSN=EBPUUAA.INPXD05X.{name}.S03yymmS,DISP=SHR\n"
                                + "//F039902E DD DSN=EBPUUAA.INPXD05X.{name}.FP20yymm,DISP=SHR\n"
                                + "//F039901S DD DSN=EBPUUAA.INPXD05X.{name}.BASIyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F039902S DD DSN=EBPUUAA.INPXD05X.{name}.ERROyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F039903S DD DSN=EBPUUAA.INPXD05X.{name}.EST0yymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSABOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSDBOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//CEEDUMP  DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSTSPRT DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "\n"
                                + "//SYSTSIN  DD *\n"
                                + "  DSN SYSTEM(DS0E)\n"
                                + "    RUN PROGRAM(EYRGBA98) PLAN(EYRGB001)\n"
                                + "  END\n"
                                + "/*");
                        } else if (this.kwargs['table'] == "TEYRGHOP") {
                            out += this.repeat_text("//*---------------------------------------------------------------------\n"
                                + "//*---------------------------------------------------------------------\n"
                                + "//**********************************************************************\n"
                                + "//* CRUCE DE FICHEROS\n"
                                + "//**********************************************************************\n"
                                + "//JOIyymm  EXEC PROC=EXPRP23P,EQUAL='EQUAL'\n"
                                + "//SORTJNF1 DD DSN=EBPUUAA.INPXD05X.{name}.THOPyymm,DISP=SHR\n"
                                + "//SORTJNF2 DD DSN=EBPUUAA.USRXD05X.UUAAP000.FP00001E,DISP=SHR\n"
                                + "//FB0BBOTH DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymmB,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FB01ONLY DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymm1,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FB02ONLY DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymm2,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  JOINKEYS FILES=F1,FIELDS=(4,4,A,9,2,A,20,26,A) -- CLAVE 1\n"
                                + "  JOINKEYS FILES=F2,FIELDS=(1,4,A,5,2,A,07,26,A) -- CLAVE 2\n"
                                + "  JOIN UNPAIRED,F1,F2\n"
                                + "  REFORMAT FIELDS=(F1:1,586,F2:1,80,?)\n"
                                + "  OPTION COPY\n"
                                + "  OUTFIL FNAMES=FB0BBOTH,INCLUDE=(667,1,CH,EQ,C'B'),\n"
                                + "        BUILD=(1,129,C'00AS',254X,388,28,\n"
                                + "                622,12,SFF,TO=PD,LENGTH=9,425,2,619,3,430,2,646,3,\n"
                                + "                435,35,634,12,SFF,TO=PD,LENGTH=9,479,106,400X)\n"
                                + "  OUTFIL FNAMES=FB01ONLY,INCLUDE=(667,1,CH,EQ,C'1'),BUILD=(1,586)\n"
                                + "  OUTFIL FNAMES=FB02ONLY,INCLUDE=(667,1,CH,EQ,C'2'),BUILD=(587,80)\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* SE GENERA LOS DECLARABLES CON DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//BH4Oyymm EXEC PROC=EXPRP01P,PRG=EYRGBH4O\n"
                                + "//FBH4O01E DD DSN=EBPUUAA.INPXD05X.{name}.JOIyymmB,DISP=SHR\n"
                                + "//FBH4O01S DD DSN=EBPUUAA.INPXD05X.{name}.F01Syymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FBH4O02S DD DSN=EBPUUAA.INPXD05X.{name}.F02Syymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSABOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSDBOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//CEEDUMP  DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSTSPRT DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "\n"
                                + "//SYSTSIN  DD *\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* FILTRA O DIVIDE UN FICHERO EN VARIOS FICHEROS DE yymm\n"
                                + "//**********************************************************************\n"
                                + "//S00yymm  EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'\n"
                                + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.{name}.F01Syymm,DISP=SHR\n"
                                + "//SORTO01  DD DSN=EBPUUAA.INPXD05X.{name}.S00yymm1,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=986)\n"
                                + "//SORTO02  DD DSN=EBPUUAA.INPXD05X.{name}.S00yymm2,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=986)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=COPY\n"
                                + "  OUTFIL FNAMES=SORTO01,INCLUDE=(130,2,CH,EQ,C'00')\n"
                                + "  OUTFIL FNAMES=SORTO02,SAVE\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* GENERADOS EL CIERRE DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//S01yymm  EXEC PROC=EXPRP23P,SYNCSORT=S,VAR='256'\n"
                                + "//SORTIN   DD *\n"
                                + "{yyyymmdd}\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.ANAGyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=8)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=COPY\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* SE CRUZA EL FICHERO GENERADO EN LA EJECUCIÓN ACTUAL CON EL\n"
                                + "//* HISTORICO DEL MES ANTERIOR\n"
                                + "//**********************************************************************\n"
                                + "//BH5Oyymm EXEC PROC=EXPRP01P,PRG=EYRGBH5O\n"
                                + "//F0H5O01E DD DSN=EBPUUAA.INPXD05X.{name}.S00yymm1,DISP=SHR\n"
                                + "//F0H5O03E DD DSN=EBPUUAA.INPXD05X.{name}.ANAGyymm,DISP=SHR\n"
                                + "//F0H5O01S DD DSN=EBPUUAA.INPXD05X.{name}.F03Syymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F0H5O02S DD DSN=EBPUUAA.INPXD05X.{name}.F04Syymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F0H5O03S DD DSN=EBPUUAA.INPXD05X.{name}.F05Syymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSABOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSDBOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//CEEDUMP  DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSTSPRT DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "\n"
                                + "//SYSTSIN  DD *\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* INFORMAR ETIQUETA\n"
                                + "//**********************************************************************\n"
                                + "//S02yymm  EXEC PROC=EXPRP23P,SYNCSORT=S,VAR='256'\n"
                                + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.{name}.F03Syymm,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.S02yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=3010)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=(3002,4,CH,A,3006,5,CH,A,137,4,CH,A)\n"
                                + "  INREC BUILD=(1,986,2015X,16,4,C'DH010')\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* PROGRAMA DE MODULOS DE ENVIO DE DATOS DINÁMICOS\n"
                                + "//**********************************************************************\n"
                                + "//BA99yymm EXEC PROC=EXPRP02P,SSID='DS0E'\n"
                                + "//F040001E DD DSN=EBPUUAA.INPXD05X.{name}.S02yymmS,DISP=SHR\n"
                                + "//F040002E DD DSN=EBPUUAA.INPXD05X.{name}.ANAGyymm,DISP=SHR\n"
                                + "//F040001S DD DSN=EBPUUAA.INPXD05X.{name}.F06Syymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F040002S DD DSN=EBPUUAA.INPXD05X.{name}.F07Syymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F040003S DD DSN=EBPUUAA.INPXD05X.{name}.F08Syymm,\n"
                                + "///            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSABOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSDBOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//CEEDUMP  DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSTSPRT DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "\n"
                                + "//SYSTSIN  DD *\n"
                                + "  DSN SYSTEM(DS0E)\n"
                                + "    RUN PROGRAM(EYRGBA99) PLAN(EYRGB001)\n"
                                + "  END\n"
                                + "/*");
                        } else if (this.kwargs['table'] == "TEYRGBIN") {
                            out += this.repeat_text("//*---------------------------------------------------------------------\n"
                                + "//*---------------------------------------------------------------------\n"
                                + "//**********************************************************************\n"
                                + "//* PARA LA PARTICION yymm\n"
                                + "//* NOS QUEDANOS CON AQUELLOS QUE XTI-GARAADJU IGUAL A 'A'\n"
                                + "//* Y COD-TRATINM  IGUAL A 'B',\n"
                                + "//* ADEMAS DE ORDENAR POR COD-ACTBDE Y FEC-CIERRE DESCENTE\n"
                                + "//**********************************************************************\n"
                                + "//SO1yymm EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'\n"
                                + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.{name}.TBINyymm,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.SO1yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=(2015,60,CH,A,2,10,CH,D)\n"
                                + "  INCLUDE COND=(2079,1,CH,EQ,C'A',AND,941,1,CH,EQ,C'B')\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* QUITAMOS DUPLICADOS POR COD-ACTBDE\n"
                                + "//**********************************************************************\n"
                                + "//SO2yymm EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'\n"
                                + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.{name}.SO1yymmS,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.SO2yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=(2015,60,CH,A)\n"
                                + "   SUM FIELDS=NONE\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* CRUCE DE LA DESCARGA yymm DE TEYRGBIN CON EL FICHERO ADJUNTO ADEMAS\n"
                                + "//* DE ACTULIZAR EL COD-ESTDD050 A S Y LOS CAMPOS FEC-BAJAADJU Y\n"
                                + "//* IMP-VENTAACU SEGUN MARQUE LA USR\n"
                                + "//**********************************************************************\n"
                                + "//JO1yymm  EXEC PROC=EXPRP23P,EQUAL='EQUAL'\n"
                                + "//SORTJNF1 DD DSN=EBPUUAA.INPXD05X.{name}.SO2yymmS,DISP=SHR\n"
                                + "//SORTJNF2 DD DSN=EBPUUAA.USRXD05X.EYRGP000.FP00001E,DISP=SHR\n"
                                + "//JNF2CNTL DD *\n"
                                + "  INCLUDE COND=(1,6,CH,EQ,C'20yymm')\n"
                                + "//FB0BBOTH DD DSN=EBPUUAA.INPXD05X.{name}.JO1yymmB,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FB1BBOTH DD DSN=EBPUUAA.INPXD05X.{name}.JO2yymmB,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FB01ONLY DD DSN=EBPUUAA.INPXD05X.{name}.JO1yymm1,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//FB02ONLY DD DSN=EBPUUAA.INPXD05X.{name}.JO1yymm2,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  JOINKEYS FILES=F1,FIELDS=(2,4,A,7,2,A,2015,60,A) -- CLAVE 1\n"
                                + "  JOINKEYS FILES=F2,FIELDS=(1,4,A,5,2,A,0007,60,A) -- CLAVE 2\n"
                                + "  JOIN UNPAIRED,F1,F2\n"
                                + "  REFORMAT FIELDS=(F1:1,2593,F2:1,91,?)\n"
                                + "  OPTION COPY\n"
                                + "  OUTFIL FNAMES=FB0BBOTH,INCLUDE=(2685,1,CH,EQ,C'B'),\n"
                                + "     IFTHEN=(WHEN=(2675,10,CH,EQ,C' '),\n"
                                + "        BUILD=(1,1817,C'S',1819,414,2660,15,SFF,TO=PD,LENGTH=9,\n"
                                + "               2242,352,407X,17,4,C'F1421X')),\n"
                                + "     IFTHEN=(WHEN=(2675,10,CH,NE,C' '),\n"
                                + "        BUILD=(1,1817,C'S',1819,402,2675,10,2231,2,\n"
                                + "               2660,15,SFF,MUL,+100,TO=PD,LENGTH=9,\n"
                                + "               2242,352,407X,17,4,C'F1421X'))\n"
                                + "  OUTFIL FNAMES=FB1BBOTH,INCLUDE=(2685,1,CH,EQ,C'B'),\n"
                                + "     IFTHEN=(WHEN=(2675,10,CH,EQ,C' '),\n"
                                + "        BUILD=(1,971,C'S',973,845,C'S',1819,414,\n"
                                + "               2660,15,SFF,MUL,+100,TO=PD,LENGTH=9,\n"
                                + "               2242,352,407X,17,4,C'F1062X')),\n"
                                + "     IFTHEN=(WHEN=(2675,10,CH,NE,C' '),\n"
                                + "        BUILD=(1,971,C'S',973,845,C'S',\n"
                                + "               1819,402,2675,10,2231,2,\n"
                                + "               2660,15,SFF,MUL,+100,TO=PD,LENGTH=9,\n"
                                + "               2242,352,407X,17,4,C'F1062X'))\n"
                                + "  OUTFIL FNAMES=FB01ONLY,INCLUDE=(2685,1,CH,EQ,C'1'),BUILD=(1,2593)\n"
                                + "  OUTFIL FNAMES=FB02ONLY,INCLUDE=(2685,1,CH,EQ,C'2'),BUILD=(2594,91)\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* GENERADOS EL CIERRE DEL MES yymm\n"
                                + "//**********************************************************************\n"
                                + "//SO3yymm  EXEC PROC=EXPRP23P,SYNCSORT=S,VAR='256'\n"
                                + "//SORTIN   DD *\n"
                                + "{yyyymmdd}\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.FP20yymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=8)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=COPY\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* GENERACION MODULO DE ENVIO DE DATOS DINAMICOS DEL yymm\n"
                                + "//**********************************************************************\n"
                                + "//BJ00yymm EXEC PROC=EXPRP02P,SSID='DS0E'\n"
                                + "//F0J0001E DD DSN=EBPUUAA.INPXD05X.{name}.JO1yymmB,DISP=SHR\n"
                                + "//F0J0002E DD DSN=EBPUUAA.INPXD05X.{name}.FP20yymm,DISP=SHR\n"
                                + "//F0J0001S DD DSN=EBPUUAA.INPXD05X.{name}.SALIyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F0J0002S DD DSN=EBPUUAA.INPXD05X.{name}.ERROyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F0J0003S DD DSN=EBPUUAA.INPXD05X.{name}.ESTAyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSABOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSDBOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//CEEDUMP  DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSTSPRT DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "\n"
                                + "//SYSTSIN  DD *\n"
                                + "  DSN SYSTEM(DS0E)\n"
                                + "    RUN PROGRAM(EYRGBJ00) PLAN(EYRGB001)\n"
                                + "  END\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* ACTUALIZAR DATOS DINAMICOS DEL yymm\n"
                                + "//**********************************************************************\n"
                                + "//SO4yymm  EXEC PROC=EXPRP23P,SYNCSORT=S,VAR='256'\n"
                                + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.{name}.SALIyymm,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.SO4yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=350)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=COPY\n"
                                + "  INCLUDE COND=(23,4,CH,EQ,C'0182',OR,1,6,CH,EQ,C'F14212')\n"
                                + "  OUTREC IFTHEN=(WHEN=(1,6,CH,EQ,C'F14212'),\n"
                                + "             OVERLAY=(7:C'20yymm0182V')),\n"
                                + "         IFTHEN=(WHEN=(1,6,CH,EQ,C'F14200'),\n"
                                + "             BUILD=(C'TS000 20yymm0101',23,325))\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* PROGRAMA DE MODULOS DE ENVIO DE DATOS BÁSICOS DEL yymm\n"
                                + "//**********************************************************************\n"
                                + "//BJ99yymm EXEC PROC=EXPRP02P,SSID='DS0E'\n"
                                + "//F0J9901E DD DSN=EBPUUAA.INPXD05X.{name}.JO2yymmB,DISP=SHR\n"
                                + "//F0J9902E DD DSN=EBPUUAA.INPXD05X.{name}.FP20yymm,DISP=SHR\n"
                                + "//F0J9901S DD DSN=EBPUUAA.INPXD05X.{name}.SALDyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F0J9902S DD DSN=EBPUUAA.INPXD05X.{name}.ERRDyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//F0J9903S DD DSN=EBPUUAA.INPXD05X.{name}.ESTDyymm,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)\n"
                                + "//SYSPRINT DD SYSOUT=*\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSABOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSDBOUT DD SYSOUT=4,DEST=JESTC3\n"
                                + "//CEEDUMP  DD SYSOUT=4,DEST=JESTC3\n"
                                + "//SYSTSPRT DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "\n"
                                + "//SYSTSIN  DD *\n"
                                + "  DSN SYSTEM(DS0E)\n"
                                + "    RUN PROGRAM(EYRGBJ99) PLAN(EYRGB001)\n"
                                + "  END\n"
                                + "/*\n"
                                + "//**********************************************************************\n"
                                + "//* ACTUALIZAR DATOS BÁSICOS DEL yymm\n"
                                + "//**********************************************************************\n"
                                + "//SO5yymm  EXEC PROC=EXPRP23P,SYNCSORT=S,VAR='256'\n"
                                + "//SORTIN   DD DSN=EBPUUAA.INPXD05X.{name}.SALIyymm,DISP=SHR\n"
                                + "//SORTOUT  DD DSN=EBPUUAA.INPXD05X.{name}.SO5yymmS,\n"
                                + "//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),\n"
                                + "//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,\n"
                                + "//            LRECL=350)\n"
                                + "//SYSOUT   DD SYSOUT=*\n"
                                + "//SYSIN    DD *\n"
                                + "  SORT FIELDS=COPY\n"
                                + "  INCLUDE COND=(17,4,CH,EQ,C'0182',OR,1,6,CH,EQ,C'F10620')\n"
                                + "  OUTREC IFTHEN=(WHEN=(1,6,CH,EQ,C'F10620'),              \n"
                                + "             OVERLAY=(7:C'20yymm0182B',161:C'T85')),      \n"
                                + "         IFTHEN=(WHEN=(1,6,CH,EQ,C'FI0000'),              \n"
                                + "             BUILD=(C'TS000 20yymm0103',17,325))\n"
                                + "/*");
                        }
                    }
                }
            }
        }

        if (this.kwargs['add_join'] == "0") {
            out += "\n//**********************************************************************"
                + "\n//* CRUCE DE FICHEROS"
                + "\n//**********************************************************************"
                + "\n//JOIN000  EXEC PROC=EXPRP23P,EQUAL='EQUAL'"
                + "\n//SORTJNF1 DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".########,DISP=SHR"
                + "\n//SORTJNF2 DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".########,DISP=SHR"
                + "\n//*JNF1CNTL DD *"
                + "\n//*JNF2CNTL DD *"
                + "\n//FB0BBOTH DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".JOIN000B,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL=0)"
                + "\n//FB01ONLY DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".JOIN0001,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL=0)"
                + "\n//FB02ONLY DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".JOIN0002,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL=0)"
                + "\n//SYSPRINT DD SYSOUT=*"
                + "\n//SYSOUT   DD SYSOUT=*"
                + "\n//SYSIN    DD *"
                + "\n  JOINKEYS FILES=F1,FIELDS=(01,02,A) -- CLAVE 1"
                + "\n  JOINKEYS FILES=F2,FIELDS=(01,02,A) -- CLAVE 2"
                + "\n  JOIN UNPAIRED,F1,F2"
                + "\n  REFORMAT FIELDS=(F1:POS-INI,LENGHT,F2:POS-INI,LENGHT,?)"
                + "\n  OPTION COPY"
                + "\n  OUTFIL FNAMES=FB0BBOTH,INCLUDE=(L1+L2+1,1,CH,EQ,C'B'),BUILD=(1,L1+L2)"
                + "\n  OUTFIL FNAMES=FB01ONLY,INCLUDE=(L1+L2+1,1,CH,EQ,C'1'),BUILD=(1,L1)"
                + "\n  OUTFIL FNAMES=FB02ONLY,INCLUDE=(L1+L2+1,1,CH,EQ,C'2'),BUILD=(L1+1,L2)"
                + "\n/*";
        }

        if (this.kwargs['file_filter'] == "0") {
            out += "\n//**********************************************************************"
                + "\n//* FILTRA O DIVIDE UN FICHERO EN VARIOS FICHEROS"
                + "\n//**********************************************************************"
                + "\n//SORT000  EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                + "\n//SORTIN   DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".########,DISP=SHR"
                + "\n//SORTO01  DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".SOR0001E,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL=0)"
                + "\n//SORTO02  DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".SOR0002E,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL=0)"
                + "\n//**"
                + "\n//SYSOUT   DD SYSOUT=*"
                + "\n//SYSIN    DD *"
                + "\n  SORT FIELDS=COPY"
                + "\n  OUTFIL FNAMES=SORTO01,..."
                + "\n  OUTFIL FNAMES=SORTO02,..."
                + "\n/*";
        }

        if (this.kwargs['file_empty'] == "0") {
            out += "\n//**********************************************************************"
                + "\n//* COMPRUEBA SI EL FICHERO INDICADO ESTA VACIO"
                + "\n//**********************************************************************"
                + "\n//IFEMPTY EXEC PROC=EXPRP20P"
                + "\n//IN       DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".########,DISP=SHR"
                + "\n//P20.SYSIN DD *"
                + "\n PRINT INFILE(IN) CHARACTER COUNT(1)"
                + "\n IF LASTCC = 0  THEN SET MAXCC = 0"
                + "\n/*"
                + "\n//**********************************************************************"
                + "\n//VALEMPTY IF (IFEMPTY.P20.RC = 0) THEN"
                + "\n//**********************************************************************"
                + "\n//*---------------------------------------------------------------------"
                + "\n//*---------------------------------------------------------------------"
                + "\n//**********************************************************************"
                + "\n//VALEMPTY ELSE"
                + "\n//**********************************************************************"
                + "\n//*---------------------------------------------------------------------"
                + "\n//*---------------------------------------------------------------------"
                + "\n//**********************************************************************"
                + "\n//VALEMPTY ENDIF"
                + "\n//**********************************************************************"
                + "\n/*";
        }

        if (this.kwargs['file_exist'] == "0") {
            out += "\n//**********************************************************************"
                + "\n//* COMPRUEBA SI EL FICHERO EXISTE"
                + "\n//**********************************************************************"
                + "\n//IFEXISTS EXEC PGM=IDCAMS"
                + "\n//SYSPRINT DD SYSOUT=*"
                + "\n//SYSIN    DD *"
                + "\n     LISTCAT ENTRIES (" + this.control_UUAA(2) + this.kwargs['name'] + ".########) ALL"
                + "\n/*"
                + "\n//**********************************************************************"
                + "\n//* SI 4 NO EXISTE EL FICHERO"
                + "\n//**********************************************************************"
                + "\n//VALEXIST IF (IFEXISTS.RC > 0) THEN"
                + "\n//**********************************************************************"
                + "\n//*---------------------------------------------------------------------"
                + "\n//*---------------------------------------------------------------------"
                + "\n//**********************************************************************"
                + "\n//VALEXIST ELSE"
                + "\n//**********************************************************************"
                + "\n//*---------------------------------------------------------------------"
                + "\n//*---------------------------------------------------------------------"
                + "\n//**********************************************************************"
                + "\n//VALEXIST ENDIF"
                + "\n//**********************************************************************"
                + "\n/*";
        }

        if (this.kwargs['sort'] == "0") {
            out += "\n//**********************************************************************"
                + "\n//* ORDENACION O COPIA DEL FICHERO"
                + "\n//**********************************************************************"
                + "\n//SORT000 EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                + "\n//SORTIN   DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".########,DISP=SHR"
                + "\n//SORTOUT  DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".SORT000S,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL=0)"
                + "\n//SYSOUT   DD SYSOUT=*"
                + "\n//SYSIN    DD *"
                + "\n  SORT FIELDS=COPY"
                + "\n/*";
        }

        if (this.kwargs['file_new'] == "0") {
            out += "\n//**********************************************************************"
                + "\n//* CREAR FICHERO VACIO"
                + "\n//**********************************************************************"
                + "\n//SORT000 EXEC PROC=EXPRP27P"
                + "\n//SORTOUT  DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".SORT000S,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL=0)"
                + "\n//SYSOUT   DD SYSOUT=*"
                + "\n//SYSIN    DD *"
                + "\n/*";
        }

        if (this.kwargs['file_statistics'] == "0") {
            out += "\n//**********************************************************************"
                + "\n//* ESTADISTICA DEL CAMPO QUE LE INDIQUEMOS"
                + "\n//**********************************************************************"
                + "\n//SORT001  EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                + "\n//SORTIN   DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".########,DISP=SHR"
                + "\n//SORTOF01 DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".ESTADIST,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS)"
                + "\n//SYSOUT   DD SYSOUT=*"
                + "\n//SYSIN    DD *"
                + "\n  SORT FIELDS=(0001,001,CH,A)"
                + "\n  OUTREC BUILD=(C'00000000001 ',0001,001)"
                + "\n  OUTFIL FILES=01,REMOVECC,NODETAIL,BUILD=(1,11,13,001),"
                + "\n  SECTIONS=(13,001,TRAILER3=(TOT=(1,11,SFF,EDIT=(TTTTTTTTTTT)),13,001))"
                + "\n/*";
        }

        if (this.kwargs['run_jcls'] == "0") {
            out += "\n//**********************************************************************"
                + "\n//* ARRANCADOR DEL " + this.kwargs['name'].substring(0,4) + "K000"
                + "\n//**********************************************************************"
                + "\n//ARRAN000 EXEC PROC=EXPRP01P,PRG=STARTJOB,PARM='" + this.kwargs['name'].substring(0,4) + "X000'"
                + "\n//PDS      DD DSN=" + this.control_UUAA(4) + ",DISP=SHR"
                + "\n//INTRDR   DD SYSOUT=(A,INTRDR),DCB=BLKSIZE=80"
                + "\n//INTER    DD DUMMY"
                + "\n//DATOSGDG DD DUMMY"
                + "\n//SYSPRINT DD SYSOUT=*"
                + "\n//SYSUDUMP DD SYSOUT=4,DEST=JESTC3"
                + "\n/*"
        }

        if (this.kwargs['header1'] == "0") {
            out += "\n//**********************************************************************"
                + "\n//* EJEMPLO DE HEADER, TRAILER EN UN PASO"
                + "\n//**********************************************************************"
                + "\n//SORT000 EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                + "\n//SORTIN   DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".########,DISP=SHR"
                + "\n//SORTOUT  DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".SORT000S,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL=0)"
                + "\n//SYSOUT   DD SYSOUT=*"
                + "\n//SYSIN    DD *"
                + "\n  SORT FIELDS=COPY"
                + "\n  OUTFIL FNAMES=SORTOUT,REMOVECC,"
                + "\n           HEADER1=(C'CABECERA DE FICHERO'),"
                + "\n           TRAILER1=(C'PIE DE FICHERO'),"
                + "\n           SECTIONS=(01,01, -- CLAVE"
                + "\n               HEADER3=(C'CABECERA DE SECCION'),"
                + "\n               TRAILER3=(C'PIE DE SECCION'))"
                + "\n/*";
        }

        if (this.kwargs['ifthen'] == "0") {
            out += "\n//**********************************************************************"
                + "\n//* EJEMPLO DE IFTHEN"
                + "\n//**********************************************************************"
                + "\n//SORT000 EXEC PROC=EXPRP23P,VAR='256',EQUAL='EQUALS'"
                + "\n//SORTIN   DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".########,DISP=SHR"
                + "\n//SORTOUT  DD DSN=" + this.control_UUAA(2) + this.kwargs['name'] + ".SORT000S,"
                + "\n//            DISP=(,CATLG,DELETE),SPACE=(CYL,(1500,500),RLSE),"
                + "\n//            DATACLAS=EXTCOMPS,DCB=(RECFM=FB,BLKSIZE=0,DSORG=PS,"
                + "\n//            LRECL=0)"
                + "\n//SYSOUT   DD SYSOUT=*"
                + "\n//SYSIN    DD *"
                + "\n  SORT FIELDS=COPY"
                + "\n  OUTREC IFTHEN=(WHEN=([CONDICION]),BUILD=(),HIT=NEXT),"
                + "\n         IFTHEN=(WHEN=([CONDICION]),OVERLAY=(),HIT=NEXT)"
                + "\n/*";
        }

        return out.replace(/UUAA+/g, this.kwargs['name'].substring(0, 4));
    }
/* Genera la rutina con los datos pasados */
    rutina() {
        var out = "";

        out += "******************************************************************"
            + "\n*                   DESCRIPCION DEL PROGRAMA"
            + "\n*                   ------------------------"
            + "\n*     PROGRAMA    : " + this.kwargs['name']
            + "\n*     FECHA       : " + this.kwargs['date'][0]
            + "\n*     AUTOR       : ACCENTURE"
            + "\n*     ENTORNO     : RUTINA"
            + "\n*     LENGUAJE    : ENTERPRISE COBOL"
            + "\n*     DESCRIPCION : " + this.kwargs['desc']
            + "\n******************************************************************"
            + "\n* ESTE PROCESO SE PERMITIR EL MANTENIMIENTO DE LA " + this.kwargs['table_rut']
            + "\n* LAS FUNCIONES QUE LLEVARA A CAVO SON:"
            + this.kwargs['insert'][0]
            + this.kwargs['delete'][0]
            + this.kwargs['update'][0]
            + this.kwargs['select'][0]
            + this.kwargs['cursor'][0]
            + "\n******************************************************************"
            + "\n* LOG DE MODIFICACIONES DE SOFTWARE"
            + "\n******************************************************************"
            + "\n* L-0001 USUARIO:AXXXXXX FECHA: dd-mm-aaaa"
            + "\n* (Descripcion de la modificacion. En el programa se debe marcar"
            + "\n* aquello que se ha modificado entre L-0001-INI y L-0001-FIN)"
            + "\n*"
            + "\n* (0001 es el numero de incidencia asociado a la modificacion)"
            + "\n*"
            + "\n* (Para programas nuevos se marcar  como L-0000 y su descripcion"
            + "\n* ser  NUEVO PROGRAMA)"
            + "\n* L-0000 USUARIO:XE00000 FECHA: " + this.kwargs['date'][0]
            + "\n* PROGRAMA NUEVO "
            + "\n*----"
            + "\n******************************************************************"
            + "\n* IDENTIFICATION DIVISION"
            + "\n******************************************************************"
            + "\n IDENTIFICATION DIVISION."
            + "\n PROGRAM-ID. " + this.kwargs['name']
            + "\n AUTHOR.     ACCENTURE."
            + "\n DATE-WRITTEN.  " + this.kwargs['date'][0]
            + "\n******************************************************************"
            + "\n* ENVIRONMENT DIVISION"
            + "\n******************************************************************"
            + "\n ENVIRONMENT DIVISION."
            + "\n CONFIGURATION  SECTION."
            + "\n******************************************************************"
            + "\n*-----------------------------------------------------------------"
            + "\n SOURCE-COMPUTER.     IBM-3090."
            + "\n OBJECT-COMPUTER.     IBM-3090."
            + "\n SPECIAL-NAMES.       DECIMAL-POINT   IS COMMA."
            + "\n*"
            + "\n******************************************************************"
            + "\n* DATA DIVISION"
            + "\n******************************************************************"
            + "\n DATA DIVISION."
            + "\n*"
            + "\n******************************************************************"
            + "\n* WORKING-STORAGE SECTION"
            + "\n******************************************************************"
            + "\n  WORKING-STORAGE SECTION."
            + "\n*INC AUDIT. NO BORRAR DESDE AQUI HASTA FIN INCLUDE"
            + "\n 77 AUDIT-TRAIL PIC X(60) VALUE"
            + "\n     '[** AUDIT ** " + this.kwargs['name'] + "-XE00000-" + this.kwargs['date'][1] + "-             ]'."
            + "\n*FIN INC AUDIT."
            + "\n******************************************************************"
            + "\n******************************************************************"
            + "\n* SWITCHES"
            + "\n******************************************************************"
            + "\n 01 SWITCHES."
            + "\n    05 SW-TIPO-ERROR                 PIC X(01)."
            + "\n        88 OK                                   VALUE ' '."
            + "\n*"
            + "\n    05 SW-FIN-CURSOR        PIC X(01)."
            + "\n        88 SI-FIN-CURSOR        VALUE 'S'."
            + "\n        88 NO-FIN-CURSOR        VALUE 'N'."
            + "\n*"
            + "\n    05 SW-FECHA-VALIDADA             PIC X(01)."
            + "\n        88 OK                                   VALUE 'S'."
            + "\n        88 KO                                   VALUE 'N'."
            + "\n*"
            + "\n******************************************************************"
            + "\n* CONTADORES"
            + "\n******************************************************************"
            + "\n*01 CONTADORES."
            + "\n"
            + "\n*"
            + "\n******************************************************************"
            + "\n* CONSTANTES"
            + "\n******************************************************************"
            + "\n 01 CTA-CONSTANTES."
            + "\n*ALFANUMERICAS."
            + "\n*"
            + "\n    05 CTA-S                         PIC X(01) VALUE 'S'."
            + "\n*"
            + "\n    05 CTA-" + this.kwargs['name'].substring(0, 4) + "                      PIC X(04) VALUE '" + this.kwargs['name'].substring(0, 4) + "'."
            + "\n    05 CTA-VALIDA                    PIC X(06) VALUE 'VALIDA'."
            + "\n    05 CTA-INSERT                    PIC X(06) VALUE 'INSERT'."
            + "\n    05 CTA-UPDATE                    PIC X(06) VALUE 'UPDATE'."
            + "\n    05 CTA-SELECT                    PIC X(06) VALUE 'SELECT'."
            + "\n    05 CTA-DELETE                    PIC X(06) VALUE 'DELETE'."
            + "\n    05 CTA-OPEN                      PIC X(05) VALUE 'OPEN'."
            + "\n    05 CTA-FETCH                     PIC X(05) VALUE 'FETCH'."
            + "\n    05 CTA-CLOSE                     PIC X(05) VALUE 'CLOSE'."
            + "\n*"
            + "\n    05 CTA-QPIPRX30                  PIC X(08) VALUE 'QPIPRX30'."
            + this.kwargs['qpiprx36'][0]
            + this.kwargs['qpiprx37'][0]
            + "\n    05 CTA-QPIPRX38                  PIC X(08) VALUE 'QPIPRX38'."
            + this.kwargs['qpiprx35'][0]
            + "\n    05 CTA-" + this.kwargs['name'] + "                  PIC X(08) VALUE '" + this.kwargs['name'] + "'."
            + (((this.kwargs['table_rut']).indexOf("%") >= 0) ? "":"\n    05 CTA-" + this.kwargs['table_rut'] + "                  PIC X(08) VALUE '" + this.kwargs['table_rut'] + "'.")
            + "\n*"
            + "\n    05 CTA-200001-V                  PIC X(08) VALUE '200001-V'."
            + this.kwargs['insert'][1]
            + this.kwargs['delete'][1]
            + this.kwargs['update'][1]
            + this.kwargs['select'][1]
            + this.kwargs['cursor'][1]
            + "\n*----- [CONSTANTES ALFANUMERICAS NUEVAS]"
            + "\n*-"
            + "\n    05 CTA-COD-FUNCION               PIC X(30) VALUE"
            + "\n       'COD-FUNCION'"
            + "\n    05 CTA-DES-FUNCION               PIC X(50) VALUE"
            + "\n       'ACCESO A LA OPERACION INDICADA POR LA FUNCION'"
            + "\n*-"
            + "\n* NUMERICAS."
            + "\n    05 CTN-4                         PIC 9(01) VALUE 4."
            + "\n    05 CTN-N1                        PIC S9(1) VALUE -1."
            + "\n*----- [CONSTANTES NUMERICAS DE ERROR]"
            + "\n* -> ERROR VALIDAR COD-FUNCION"
            + "\n    05 CTN-01309051                  PIC 9(08) VALUE 01309051."
            + "\n* -> ERROR VALIDAR FECHA"
            + "\n    05 CTN-01309049                  PIC 9(08) VALUE 01309049."
            + "\n* -> ERROR DB2"
            + "\n    05 CTN-01309201                  PIC 9(08) VALUE 01309201."
            + "\n    05 CTN-01309200                  PIC 9(08) VALUE 01309200."
            + "\n    05 CTN-00022002                  PIC 9(08) VALUE 00022002."
            + "\n*----- [CONSTANTES NUMERICAS NUEVAS]"
            + "\n*-"
            + this.kwargs['cadena_valida'][0]
            + this.kwargs['qpiprx36'][1]
            + this.kwargs['qpiprx35'][1]
            + this.kwargs['qpiprx37'][1]
            + this.kwargs['insert'][2]
            + this.kwargs['delete'][2]
            + this.kwargs['update'][2]
            + this.kwargs['select'][2]
            + this.kwargs['cursor'][2]
            + "\n*-"
            + "\n******************************************************************"
            + "\n* VARIABLES"
            + "\n******************************************************************"
            + "\n 01 WS-VARIABLES."
            + "\n*"
            + "\n    05 WS-DES-SQLCA."
            + "\n        10 WS-CAMP             PIC X(30) VALUE SPACES."
            + "\n        10 FILLER              PIC X(01) VALUE '#'."
            + "\n        10 WS-DES-CAMP         PIC X(50) VALUE SPACES."
            + "\n        10 FILLER              PIC X(01) VALUE '#'."
            + "\n*"
            + "\n    05 WS-IND                  PIC 9(09)."
            + "\n    05 WS-SYSIN                PIC X(80)."
            + "\n*"
            + "\n    05 WS-X08-FECHA."
            + "\n        10 WS-AAAA              PIC 9(04)."
            + "\n        10 WS-MM                PIC 9(02)."
            + "\n        10 WS-DD                PIC 9(02)."
            + "\n"
            + "\n    05 WS-X10-HORA."
            + "\n        10 WS-HH                PIC 9(02)."
            + "\n        10 WS-MIN               PIC 9(02)."
            + "\n        10 WS-SS                PIC 9(02)."
            + "\n        10 WS-MMMM              PIC 9(06)."
            + "\n"
            + "\n    05 WS-X26-FECHAHORA."
            + "\n        10 WS-X10-FECHA."
            + "\n            15 WS-AAAA          PIC 9(04)."
            + "\n            15 FILLER           PIC X(01) VALUE '-'."
            + "\n            15 WS-MM            PIC 9(02)."
            + "\n            15 FILLER           PIC X(01) VALUE '-'."
            + "\n            15 WS-DD            PIC 9(02)."
            + "\n        10 FILLER               PIC X(01) VALUE '-'."
            + "\n        10 WS-X13-HORA."
            + "\n            15 WS-HH            PIC 9(02)."
            + "\n            15 FILLER           PIC X(01) VALUE '.'."
            + "\n            15 WS-MIN           PIC 9(02)."
            + "\n            15 FILLER           PIC X(01) VALUE '.'."
            + "\n            15 WS-SS            PIC 9(02)."
            + "\n            15 FILLER           PIC X(01) VALUE '.'."
            + "\n            15 WS-MMMM          PIC 9(06)."
            + "\n"
            + "\n    05 WS-ACTUAL-FECHAHORA      PIC X(26)."
            + "\n*----- [VARIABLES NUEVAS]"
            + this.kwargs['cadena_valida'][1]
            + this.kwargs['qpiprx35'][2]
            + this.kwargs['qpiprx37'][2]
            + this.kwargs['to_number'][0]
            + this.kwargs['chopped'][0]
            + "\n*-"
            + "\n******************************************************************"
            + "\n* TABLAS AUXILIAR"
            + "\n******************************************************************"
            + "\n*"
            + this.kwargs['chopped'][1]
            + this.kwargs['lookfor'][3]
            + "\n******************************************************************"
            + "\n* COPYS"
            + "\n******************************************************************"
            + "\n*"
            + "\n*-- COPY DE ENTRADA/SALIDA"
            + "\n COPY QPIPCCAB."
            + "\n*"
            + "\n*-- COPY QUE UTILIZA EL MODULO DE ERRORES"
            + "\n COPY QPBTCXRR."
            + "\n*"
            + "\n*-- COPY QUE UTILIZA EL MODULO DE ESTADISTICAS"
            + "\n COPY QPBTCXTA."
            + "\n*"
            + "\n*-- COPY QUE UTILIZA EL MODULO DE FECHAS ESTANDAR"
            + "\n COPY QPIPCX30."
            + "\n*"
            + "\n*-- COPY DEL MODULO QUE OBTIENE EL CONTEXTO BATCH."
            + "\n COPY QPIPCX28."
            + this.kwargs['qpiprx36'][2]
            + this.kwargs['qpiprx35'][3]
            + this.kwargs['qpiprx37'][3]
            + "\n*"
            + "\n*-- COPY PARA LA VALIDACION DE LA FECHA"
            + "\n COPY QPIPCX38.\n*"
            + "\n*"
            + "\n*-- COPY DE CONSTANTES"
            + "\n COPY QPIPCCTE."
            + "\n******************************************************************"
            + "\n* INCLUDES DE TABLAS"
            + "\n******************************************************************"
            + "\n*"
            + "\n   EXEC SQL INCLUDE SQLCA END-EXEC."
            + "\n*"
            + (((this.kwargs['table_rut']).indexOf("%") >= 0) ? "":"\n   EXEC SQL INCLUDE " + this.kwargs['table_rut'] + " END-EXEC.")
            + "\n*"
            + "\n******************************************************************"
            + "\n* DECLARACION DE CURSORES"
            + "\n******************************************************************"
            + this.kwargs['cursor'][3]
            + "\n*"
            + "\n******************************************************************"
            + "\n* LINKAGE SECTION"
            + "\n******************************************************************"
            + "\n LINKAGE SECTION."
            + "\n*"
            + "\n*-- COPY DE ENTRADA/SALIDA"
            + "\n COPY QPIPCCAB."
            + "\n*"
            + "\n*-- COPY DE ENTRADA/SALIDA DE DATOS"
            + "\n COPY " + this.kwargs['name'].substring(0, 4) + "C000."
            + "\n*"
            + "\n******************************************************************"
            + "\n* PROCEDURE DIVISION"
            + "\n******************************************************************"
            + "\n PROCEDURE DIVISION USING R-QPIPCCAB C000-" + this.kwargs['name'].substring(0, 4) + "C000."
            + "\n*"
            + "\n     PERFORM 100000-INICIO"
            + "\n*"
            + "\n     PERFORM 200000-PROCESO"
            + "\n*"
            + "\n     PERFORM 300000-FIN"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 100000-INICIO"
            + "\n******************************************************************"
            + "\n 100000-INICIO."
            + "\n*"
            + "\n     INITIALIZE RETORNO-QPIPCCAB"
            + "\n                WS-VARIABLES"
            + "\n*"
            + "\n     MOVE ZEROES       TO WS-IND"
            + "\n*"
            + "\n     PERFORM 110000-DATOS-CONTEXTO"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 110000-DATOS-CONTEXTO"
            + "\n******************************************************************"
            + "\n 110000-DATOS-CONTEXTO."
            + "\n*"
            + "\n     PERFORM 800000-FECHA-SISTEMA"
            + "\n     MOVE WS-X26-FECHAHORA          TO WS-ACTUAL-FECHAHORA"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 200000-PROCESO"
            + "\n******************************************************************"
            + "\n 200000-PROCESO."
            + "\n*"
            + "\n      PERFORM 200001-VALIDAR"
            + "\n*"
            + "\n      EVALUATE C000-COD-FUNCION"
            + this.kwargs['insert'][3]
            + this.kwargs['delete'][3]
            + this.kwargs['update'][3]
            + this.kwargs['select'][3]
            + this.kwargs['cursor'][4]
            + "\n"
            + "\n        WHEN OTHER"
            + "\n            MOVE C000-COD-FUNCION   TO COD-ACCESO-ERR-QPIPCCAB"
            + "\n            MOVE CTA-COD-FUNCION    TO WS-CAMP"
            + "\n            MOVE CTA-DES-FUNCION    TO WS-DES-CAMP"
            + "\n            MOVE CTN-01309051       TO COD-AVIERROR-QPIPCCAB"
            + "\n"
            + "\n            MOVE CTA-RUTINA-ERROR-VALIDA TO XTI-AVIERROR-QPIPCCAB"
            + "\n            MOVE CTA-" + this.kwargs['name'] + "       TO COD-MODULO-ERR-QPIPCCAB"
            + "\n            MOVE CTA-200001-V       TO COD-PARRAFO-ERR-QPIPCCAB"
            + "\n            MOVE CTA-" + this.kwargs['table_rut'] + "       TO COD-TABLA-ERR-QPIPCCAB"
            + "\n            MOVE ZEROS              TO QNU-SQLCODE-ERR-QPIPCCAB"
            + "\n            STRING WS-DES-SQLCA C000-COD-FUNCION"
            + "\n                DELIMITED BY SIZE INTO DES-SQLCA-ERR-QPIPCCAB"
            + "\n"
            + "\n            PERFORM 999999-FIN-ERROR"
            + "\n      END-EVALUATE"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 200001-VALIDAR"
            + "\n******************************************************************"
            + "\n 200001-VALIDAR."
            + "\n*"
            + "\n*"
            + "\n     ."
            + this.kwargs['insert'][4]
            + this.kwargs['delete'][4]
            + this.kwargs['update'][4]
            + this.kwargs['select'][4]
            + this.kwargs['cursor'][5]
            + "\n*"
            + "\n******************************************************************"
            + "\n* 300000-FIN"
            + "\n******************************************************************"
            + "\n 300000-FIN."
            + "\n*"
            + "\n     GOBACK"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 400000-INFORMAR-DCLGEN"
            + "\n******************************************************************"
            + "\n 400000-INFORMAR-DCLGEN."
            + "\n*"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 500000-RETORNAR-CONSULTA"
            + "\n******************************************************************"
            + "\n 500000-RETORNAR-CONSULTA."
            + "\n*"
            + "\n     ADD  CTN-1                        TO WS-IND"
            + "\n*"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n* 800000-FECHA-SISTEMA"
            + "\n******************************************************************"
            + "\n 800000-FECHA-SISTEMA."
            + "\n*"
            + "\n     INITIALIZE RETORNO-QPIPCCAB"
            + "\n                R-QPIPCX30"
            + "\n*"
            + "\n     MOVE CTN-4                        TO COD-SERVICIO-QPIPCCAB"
            + "\n*"
            + "\n     CALL CTA-QPIPRX30 USING R-QPIPCCAB R-QPIPCX30"
            + "\n*"
            + "\n     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES"
            + "\n        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR"
            + "\n*"
            + "\n        PERFORM 999999-FIN-ERROR"
            + "\n     END-IF"
            + "\n"
            + "\n     MOVE FEC-SIS4-QPIPCX30         TO WS-X26-FECHAHORA"
            + "\n     MOVE CORR WS-X10-FECHA         TO WS-X08-FECHA"
            + "\n     MOVE CORR WS-X13-HORA          TO WS-X10-HORA"
            + "\n     ."
            + "\n*"
            + this.kwargs['qpiprx36'][3]
            + this.kwargs['qpiprx37'][4]
            + "\n******************************************************************"
            + "\n* 800000-VALIDA-FECHA"
            + "\n******************************************************************"
            + "\n 800000-VALIDA-FECHA."
            + "\n*"
            + "\n     INITIALIZE RETORNO-QPIPCCAB"
            + "\n                R-QPIPCX38"
            + "\n*"
            + "\n*    MOVE [...]                        TO WS-X08-FECHA"
            + "\n     MOVE CTN-1                        TO COD-SERVICIO-QPIPCCAB"
            + "\n     MOVE WS-X08-FECHA                 TO FEC-ENTGREG-QPIPCX38"
            + "\n     SET  OK OF SW-FECHA-VALIDADA      TO TRUE"
            + "\n*"
            + "\n     CALL CTA-QPIPRX38 USING R-QPIPCCAB R-QPIPCX38"
            + "\n*"
            + "\n     IF XTI-AVIERROR-QPIPCCAB NOT EQUAL SPACES"
            + "\n        MOVE XTI-AVIERROR-QPIPCCAB TO SW-TIPO-ERROR"
            + "\n        SET  KO OF SW-FECHA-VALIDADA       TO TRUE"
            + "\n*"
            + "\n*       PERFORM 999999-FIN-ERROR"
            + "\n     END-IF"
            + "\n     ."
            + "\n*"
            + this.kwargs['qpiprx35'][4]
            + this.kwargs['to_number'][1]
            + this.kwargs['chopped'][2]
            + this.kwargs['lookfor'][6]
            + this.kwargs['cadena_valida'][2]
            + "\n*"
            + "\n******************************************************************"
            + "\n* 999999-FIN-ERROR"
            + "\n******************************************************************"
            + "\n 999999-FIN-ERROR."
            + "\n*"
            + "\n     IF SQLCODE NOT EQUAL ZEROS"
            + "\n        MOVE CTA-" + this.kwargs['name'] + " TO COD-MODULO-ERR-QPIPCCAB"
            + "\n        MOVE CTA-" + this.kwargs['table_rut'] + " TO COD-TABLA-ERR-QPIPCCAB"
            + "\n        MOVE SQLCODE      TO QNU-SQLCODE-ERR-QPIPCCAB"
            + "\n        MOVE SQLCA        TO DES-SQLCA-ERR-QPIPCCAB"
            + "\n     END-IF"
            + "\n*"
            + "\n     PERFORM 300000-FIN"
            + "\n     ."
            + "\n*"
            + "\n******************************************************************"
            + "\n*                       FIN DEL PROGRAMA"
            + "\n******************************************************************";


        return out;
    }
/* Metodo para retornar la clase en cadena de caracteres */
    get str() {
        if (this.getitem('type') == "programa") {
            return this.program();
        } else if (this.getitem('type') == "jcl") {
            return this.jcl();
        } else if (this.getitem('type') == "boleta") {
            return this.boleta();
        } else if (this.getitem('type') == "rutina") {
            return this.rutina();
        }
    }
/* Metodo para retornar el campo que le pidamos */
    getitem(ix) {

        if (Array.isArray(this.kwargs[ix])
            && ((ix.substring(2) != "_desc")
             && (ix.substring(2) != "_copy")
             && (ix.substring(2) != "_length")
             && (ix.substring(2) != "_vf"))) {
            return (this.kwargs[ix][0] == ""?"1":"0");
        } else {
            return this.kwargs[ix];
        }
    }
}